## 5.8　数组初始化

数组只是相同类型的、用一个标识符名称封装到一起的一个对象序列或基本类型数据序列。数组是通过方括号下标操作符[ ]来定义和使用的。要定义一个数组，只需在类型名后加上一对空方括号即可：

![132-1](../Images/image02760.jpeg)

方括号也可以置于标识符后面：

![132-2](../Images/image02761.jpeg)

两种格式的含义是一样的，后一种格式符合C和C++程序员的习惯。不过，前一种格式或许更合理，毕竟它表明类型是“一个int型数组”。本书将采用这种格式。

编译器不允许指定数组的大小。这就又把我们带回到有关“引用”的问题上。现在拥有的只是对数组的一个引用（你已经为该引用分配了足够的存储空间），而且也没给数组对象本身分配任何空间。为了给数组创建相应的存储空间，必须写初始化表达式。对于数组，初始化动作可以出现在代码的任何地方，但也可以使用一种特殊的初始化表达式，它必须在创建数组的地方出现。这种特殊的初始化是由一对花括号括起来的值组成的。在这种情况下，存储空间的分配（等价于使用new）将由编译器负责。例如：

![132-3](../Images/image02762.jpeg)

那么，为什么还要在没有数组的时候定义一个数组引用呢？

![132-4](../Images/image02763.jpeg)

在Java中可以将一个数组赋值给另一个数组，所以可以这样：

![132-5](../Images/image02764.jpeg)

其实真正做的只是复制了一个引用，就像下面演示的那样：

![132-6](../Images/image02765.jpeg)

可以看到代码中给出了a1的初始值，但a2却没有；在本例中，a2是在后面被赋给另一个数组的。由于a2和a1是相同数组的别名，因此通过a2所做的修改在a1中可以看到。

所有数组（无论它们的元素是对象还是基本类型）都有一个固有成员，可以通过它获知数组内包含了多少个元素，但不能对其修改。这个成员就是length。与C和C++类似，Java数组计数也是从第0个元素开始，所以能使用的最大下标数是length-1。要是超出这个边界，C和C++会194“默默”地接受，并允许你访问所有内存，许多声名狼藉的程序错误由此而生。Java则能保护你免受这一问题的困扰，一旦访问下标过界，就会出现运行时错误（即异常）[^5]。

如果在编写程序时，并不能确定在数组里需要多少个元素，那么该怎么办呢？可以直接用new在数组里创建元素。尽管创建的是基本类型数组，new仍然可以工作（不能用new创建单个的基本类型数据）。

![133-1](../Images/image02766.jpeg)

数组的大小是通过Random.nextInt()方法随机决定的，这个方法会返回0到输入参数之间的一个值。这表明数组的创建确实是在运行时刻进行的。此外，程序输出表明：数组元素中的基本数据类型值会自动初始化成空值（对于数字和字符，就是0；对于布尔型，是false）。

Arrays.toString()方法属于java.util标准类库，它将产生一维数组的可打印版本。

当然，在本例中，数组也可以在定义的同时进行初始化：

![133-2](../Images/image02767.jpeg)

如果可能的话，应该尽量这么做。

如果你创建了一个非基本类型的数组，那么你就创建了一个引用数组。以整型的包装器类Integer为例，它是一个类而不是基本类型：

![133-3](../Images/image02768.jpeg)

这里，即便使用new创建数组之后：

![133-4](../Images/image02769.jpeg)

它还只是一个引用数组，并且直到通过创建新的Integer对象（在本例中是通过自动包装机制创建的），并把对象赋值给引用，初始化进程才算结束：

![133-5](../Images/image02770.jpeg)

如果忘记了创建对象，并且试图使用数组中的空引用，就会在运行时产生异常。

也可以用花括号括起来的列表来初始化对象数组。有两种形式：

![134-1](../Images/image02771.jpeg)

在这两种形式中，初始化列表的最后一个逗号都是可选的（这一特性使维护长列表变得更容易）。

尽管第一种形式很有用，但是它也更加受限，因为它只能用于数组被定义之处。你可以在任何地方使用第二种和第三种形式，甚至是在方法调用的内部。例如，你可以创建一个String对象数组，将其传递给另一个main()方法，以提供参数，用来替换传递给该main()方法的命令行参数。

![134-2](../Images/image02772.jpeg)

为Other.main()的参数而创建的数组是在方法调用处创建的，因此你甚至可以在调用时提供可替换的参数。

练习16：（1）创建一个String对象数据，并为每一个元素都赋值一个String。用for循环来打印该数组。

练习17：（2）创建一个类，它有一个接受一个String参数的构造器。在构造阶段，打印该参数。创建一个该类的对象引用数组，但是不实际去创建对象赋值给该数组。当运行程序时，请注意来自对该构造器的调用中的初始化消息是否打印了出来。

练习18：（1）通过创建对象赋值给引用数组，从而完成前一个练习。