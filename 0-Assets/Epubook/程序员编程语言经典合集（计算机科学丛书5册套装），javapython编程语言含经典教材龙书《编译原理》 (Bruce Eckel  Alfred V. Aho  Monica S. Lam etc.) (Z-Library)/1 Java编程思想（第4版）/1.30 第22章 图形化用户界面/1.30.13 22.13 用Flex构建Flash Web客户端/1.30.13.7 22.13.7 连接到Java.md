### 22.13.7　连接到Java

在MXML文件末尾的RemoteObject标签设置了到外部Java类gui.flex.SongService的连接。Flex客户端将使用这个Java类中的getSongs()方法来为DataGrid获取数据。为了实现这一点，它必须看起来像是一个服务——一个用户可以用来交换消息的端点。在RemoteObject标签中定义的服务有一个source属性，它指示的是RemoteObject的Java类，并且还指定了一个在Java方法返回时被调用的ActionScript回调函数onSongs()。嵌套的method标签声明了getSongs()方法，它可以使Java方法对Flex应用程序中的其他部分都是可访问的。

在Flex中所有的服务调用，都是通过事件调用这些回调函数而异步返回的。RemoteObject在错误事件中还会产生一个警告对话框构件。

现在可以使用ActionScript从Flash中调用getSongs()方法了：

![874-2](../Images/image03902.jpeg)

根据MXML的配置，这将调用SongService类中的getSongs()方法：

![874-3](../Images/image03903.jpeg)

每个Song对象都只是一个数据容器：

![875-2](../Images/image03904.jpeg)

当应用程序被初始化，或者按下refreshSongsButton时，getSongs()都将被调用，并且在返回后，ActionScript函数onSongs（event，result）将被调用以组装songGrid。

下面是ActionScript的列表，在MXML文件中用Script控件将其导入：

![875-3](../Images/image03905.jpeg)

为了处理对DataGrid单元格的选中操作，我们在MXML文件的DataGrid声明中添加了cellPress事件属性：

![876-2](../Images/image03906.jpeg)

当用户在DataGrid中点击一首歌时，将会调用上面的ActionScript中的selectSong()。