## 22.11　可视化编程与JavaBean

到目前为止，读者已经看到了Java在编写可重用代码方面所具有的价值。类是“最可重用”的代码单元，因为它把性质（字段）和行为（方法）聚合成一个单元，所以它既可以被直接重用，也可以通过组合或继承得到重用。

继承和多态是面向对象编程的关键部分，不过在大多数情况下，当把程序放在一起时，人们真正希望的是能够精确地满足需求的组件。人们希望把这些部件像电子工程师把芯片放在电路板上一样地集成到自己的设计中。看来，应该有某种方法能加速这种“模块化装配”形式的编程。

“可视化编程”是首先成功的方式，而且非常成功。首先是微软公司的Visual BASIC（VB），接着是Borland公司的Delphi（JavaBeans的设计主要就是受到了它的启发），它属于第二代产品。伴随着这些编程工具，组件也以可视的形式表现，因为它们通常表现为一些诸如按钮或文本域的可视组件，所以这种可视化很有意义。实际上可视化表示通常就是组件在运行的程序中可被观察到的方式。所以可视化编程的部分过程就包括了从选用区选择组件，然后把它拖放到窗体上。在拖放的时候，应用程序构建集成开发环境（Integrated Development Environment，IDE）会帮着生成相应的代码，这些代码将在程序实际运行的时候创建相应的组件。

简单地把组件拖放到窗体上一般还不足以完成程序。通常，还必须改变组件的特征，比如颜色、文本、所连接的数据库等等。可以在设计时被修改的特征被称为属性。可以使用IDE构建器工具对组件的属性进行设置，在创建程序的时候，这些配置信息将被保存，这样就可以在程序运行的时候恢复这些信息。

现在读者可能已经习惯了这样的思想，即对象不仅仅包含了特征；它还包括一组行为。在设计时，可视化组件的行为可部分地由事件表示，意思是“这是可以在组件上发生的动作”。通常，通过为事件编写代码来决定当事件发生时该如何处理。

关键在于：IDE构建工具能够使用反射机制来动态地向组件查询，以找出组件具有的属性和支持的事件。一旦查询完毕，它将显示属性并且允许你进行修改（在你构建程序的时候会把状态保存起来），此外它还能显示事件。通常，需要在事件上做出类似于双击的操作，IDE构建工具会为你生成一个与此事件关联的代码体。这时你要做的就是编写事件发生时将要执行的代码。

所有这些加起来就是IDE构建工具能够帮你完成的大量工作。这样，你就能将精力集中于程序的外观和功能上，然后依赖IDE构建工具为你管理相关的细节。可视化编程工具如此成功的原因就在于，它们极大地加速了程序的构建过程（当然包括了用户界面部分，而且常常对程序其他部分的编写也有帮助）。