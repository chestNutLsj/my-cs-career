## 22.4　捕获事件

如果编译并运行前面的程序，那么当按下按钮的时候，什么也不会发生。现在是必须深入进去编写一些代码以决定会发生什么事情的时候了。事件驱动编程（包含了许多关于GUI的内容）的基础，就是把事件同处理事件的代码连接起来。

在Swing中，这种关联的方式就是通过清楚地分离接口（图形组件）和实现（当和组件相关的事件发生时，你要执行的代码）而做到的。每个Swing组件都能够报告其上所有可能发生的事件，并且它能单独报告每种事件。所以，你要是对诸如“鼠标移动到按钮上”这样的事件不感兴趣的话，那么你不注册这样的事件就可以了。这种处理事件驱动编程的方式非常直接和优雅，一旦你理解了其基本概念，就能够很容易将其应用到甚至从未见过的Swing组件之上。实际上，只要是JavaBean（本章后面讨论），这个模式都适用。

首先，对所使用的组件，我们只把重点放在它感兴趣的主要事件上。对于JButton，“感兴趣的事件”就是按钮被按下。为了表明（注册）你对按钮按下事件感兴趣，可以调用JButton的addActionListener()方法。这个方法接受一个实现ActionListener接口的对象作为参数，ActionListener接口只包含一个actionPerformed()方法。所以要想把事件处理代码和JButton关联，需要在一个类中实现ActionListener接口，然后把这个类的对象通过addActionListener()方法注册给JButton。这样按钮按下的时候就会调用actionPerformed()方法（通常这也称为回调）。

但是按钮按下的时候应该有什么结果呢？我们希望看到屏幕有所改变，所以在这里介绍一个新的Swing组件——JTextField。这个组件支持用户输入文本，在本例中，或者像本例一样由程序插入文本。尽管有很多方法可以创建JTextField，但是最简单的方式就是告诉构造器你所希望的文本域宽度。一旦JTextField被放置到窗体上，就可以使用setText()方法来修改它的内容（JTextField还有很多方法，不过你应该先到java.sun.com看一下HTML格式的JDK文档）。下面就是其具体程序：

![806-1](../Images/image03810.jpeg)

创建JTextField并把它放置在画布上的步骤，同JButton或者其他Swing组件所采用的步骤相同。这里与前面例子的不同之处在于创建一个ButtonListener对象，它实现了前面提到过的ActionListener接口。actionPerformed()方法的参数是ActionEvent类型，它包含事件和事件源的所有信息。本例中，我希望表明是哪个按钮被按下；getSource()方法产生的对象表明了事件的来源，我假设（使用类型转换）这个对象是JButton。getText()方法返回按钮上的文本，这个文本被放进JTextField，以证明当按钮按下的时候代码确实被调用了。

在构造器中，使用addActionListener()方法来将ButtonListener对象注册给两个按钮。

通常，把ActionListener实现成匿名内部类会更方便，尤其是对每个监听器类只使用一个实例的时候更是如此。可以像下面这样修改Button2.java，这里使用一个匿名内部类：

![807-2](../Images/image03811.jpeg)

本书中的例子倾向于（只要可能）使用匿名内部类的方式。

练习5：（4）使用SwingConsole类编写一个应用程序，它包括一个文本域和三个按钮，单击每个按钮的时候，在文本域中显示不同的文字。