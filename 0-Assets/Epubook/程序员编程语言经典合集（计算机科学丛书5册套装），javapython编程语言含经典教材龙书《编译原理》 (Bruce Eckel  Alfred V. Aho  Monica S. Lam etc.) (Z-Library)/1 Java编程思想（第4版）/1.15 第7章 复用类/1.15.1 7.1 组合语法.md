## 7.1　组合语法

本书到目前为止，已多次使用组合技术。只需将对象引用置于新类中即可。例如，假设你需要某个对象，它要具有多个String对象、几个基本类型数据，以及另一个类的对象。对于非基本类型的对象，必须将其引用置于新的类中，但可以直接定义基本类型数据：

![158-1](../Images/image02823.jpeg)

![159-1](../Images/image02824.jpeg)

在上面两个类所定义的方法中，有一个很特殊：toString()。每一个非基本类型的对象都有一个toString()方法，而且当编译器需要一个String而你却只有一个对象时，该方法便会被调用。所以在SprinklerSystem.toString()的表达式中：

![159-2](../Images/image02825.jpeg)

编译器将会得知你想要将一个String对象（“source=”）同WaterSource相加。由于只能将一个String对象和另一个String对象相加，因此编译器会告诉你：“我将调用toString()，把source转换成为一个String！”这样做之后，它就能够将两个String连接到一起并将结果传递给System.out.println()（或者使用与此等价的本书中静态的print()和printnb()方法）。每当想要使所创建的类具备这样的行为时，仅需要编写一个toString()方法即可。

正如我们在第2章中所提到的，类中域为基本类型时能够自动被初始化为零。但是对象引用会被初始化为null，而且如果你试图为它们调用任何方法，都会得到一个异常——运行时错误。很方便的是，在不抛出异常的情况下仍旧可以打印一个null引用。

编译器并不是简单地为每一个引用都创建默认对象，这一点是很有意义的，因为若真要那样做的话，就会在许多情况下增加不必要的负担。如果想初始化这些引用，可以在代码中的下列位置进行：

1. 在定义对象的地方。这意味着它们总是能够在构造器被调用之前被初始化。

2. 在类的构造器中。

3. 就在正要使用这些对象之前，这种方式称为惰性初始化。在生成对象不值得及不必每次都生成对象的情况下，这种方式可以减少额外的负担。

4. 使用实例初始化。

以下是这四种方式的示例：

![159-3](../Images/image02826.jpeg)

![160-1](../Images/image02827.jpeg)

请注意，在Bath的构造器中，有一行语句在所有初始化产生之前就已经执行了。如果没有在定义处初始化，那么除非发生了不可避免的运行期异常，否则将不能保证信息在发送给对象引用之前已经被初始化。

当toString()被调用时，它将填充s4的值，以确保所有的域在使用之时已被妥善初始化。

练习1：（2）创建一个简单的类。在第二个类中，将一个引用定义为第一个类的对象。运用惰性初始化来实例化这个对象。