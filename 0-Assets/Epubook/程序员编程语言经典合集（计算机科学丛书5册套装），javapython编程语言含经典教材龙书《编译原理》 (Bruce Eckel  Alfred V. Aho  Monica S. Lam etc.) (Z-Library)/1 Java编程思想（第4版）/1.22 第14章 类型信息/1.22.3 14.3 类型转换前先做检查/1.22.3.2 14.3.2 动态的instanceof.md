### 14.3.2　动态的instanceof

Class.isInstance方法提供了一种动态地测试对象的途径。于是所有那些单调的instanceof语句都可以从PetCount.java的例子中移除了。如下所示：

![362-1](../Images/image03142.jpeg)

为了对所有不同类型的Pet进行计数，PetCounter Map预加载了LiteralPetCreator.allTypes中的类型。这使用了net.mindview.util.MapData类，这个类接受一个Iteralbe（allTypes List）和一个常数值（在本例中是0），然后用allTypes中元素作为键，用0作为值，来填充Map。如果不预加载这个Map，那么你最终将只能对随机生成的类型进行计数，而不包括诸如Pet和Cat这样的基类型。

可以看到，isInstance()方法使我们不再需要instanceof表达式。此外，这意味着如果要求添加新类型的Pet，只需简单地改变LiteralPetCreator.java数组即可；而毋需改动程序其他部分（但是在使用instanceof时这是不可能的）。

toString()方法已经被重载，使得输出更容易被读取，而该输出与打印Map时所看到的典型输出仍然是匹配的。