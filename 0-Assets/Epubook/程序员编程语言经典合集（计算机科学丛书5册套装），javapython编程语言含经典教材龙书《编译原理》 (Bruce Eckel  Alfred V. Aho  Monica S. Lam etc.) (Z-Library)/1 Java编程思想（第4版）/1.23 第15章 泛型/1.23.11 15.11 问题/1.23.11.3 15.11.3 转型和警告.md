### 15.11.3　转型和警告

使用带有泛型类型参数的转型或instanceof不会有任何效果。下面的容器在内部将各个值存储为Object，并在获取这些值时，再将它们转型回T：

![435-1](../Images/image03272.jpeg)

如果没有@SuppressWarnings注解，编译器将对pop()产生“unchecked cast”警告。由于擦除的原因，编译器无法知道这个转型是否是安全的，并且pop()方法实际上并没有执行任何转型。这是因为，T被擦除到它的第一个边界，默认情况下是Object，因此pop()实际上只是将Object转型为Object。

有时，泛型没有消除对转型的需要，这就会由编译器产生警告，而这个警告是不恰当的。例如：

![435-2](../Images/image03273.jpeg)

正如你将在下一章学到的那样，readObject()无法知道它正在读取的是什么，因此它返回的是必须转型的对象。但是当注释掉@SuppressWarnings注解，并编译这个程序时，就会得到下面的警告：

![436-1](../Images/image03274.jpeg)

如果遵循这条指示，使用-Xlint：unchecked来重新编译：

![436-2](../Images/image03275.jpeg)

你会被强制要求转型，但是又被告知不应该转型。为了解决这个问题，必须使用在Java SE5中引入的新的转型形式，既通过泛型类来转型：

![436-3](../Images/image03276.jpeg)

但是，不能转型到实际类型（List<Widget>）。也就是说，不能声明：

![436-4](../Images/image03277.jpeg)

甚至当你添加一个像下面这样的另一个转型时：

![436-5](../Images/image03278.jpeg)

仍旧会得到一个警告。

练习32：（1）验证在GenericCast.java中的FixedSizeStack将产生异常，如果试图超出其边界的话。这是否意味着边界检查代码是不需要的？

练习33：（3）使用ArrayList修复GenericCast.java。