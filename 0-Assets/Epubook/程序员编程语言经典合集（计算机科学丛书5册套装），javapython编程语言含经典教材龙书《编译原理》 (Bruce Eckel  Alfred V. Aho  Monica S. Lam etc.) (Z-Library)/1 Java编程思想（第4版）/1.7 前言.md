   

# 前言

一开始，我只是将Java看作“又一种程序设计语言”。从许多方面看，它也的确如此。

但随着时间流逝，以及对Java的深入研究，我渐渐发现，与我所见过的其他编程语言相比，Java有着完全不同的核心目的。

程序设计其实是对复杂性的管理：待解决问题的复杂性，以及用来解决该问题的工具的复杂性。正是这种复杂性，导致多数程序设计项目失败。在我所知的所有程序设计语言中，几乎没有哪个将自己的设计目标专注于克服开发与维护程序的复杂性[^1]。当然，有些编程语言在设计决策时也曾考虑到复杂性的问题，然而，总是会有其他议题被认为更有必要加入到该语言中。于是不可避免地，正是这些所谓更必要的议题导致程序员最终“头撞南墙”。例如，C++选择向后兼容C（以便更容易吸引C程序员），以及具备C一样的高效率。这两点都是非常有益的设计目标，也确实促成了C++的成功，然而它们却暴露出更多的复杂性问题，而这也使得很多项目不得善终（你自然可以责怪程序员或者项目管理，但是，如果一种语言能够帮助你解决错误，那何乐而不为呢？）。再看一个例子，Visual Basic（VB）选择与Basic绑在一起，而Basic并未被设计为具备可扩展性的程序设计语言，结果呢，建立在VB之上的所有扩展都导致了无法维护的语法。还有Perl，它向后兼容awk、sed、grep，以及所有它打算替代的Unix工具，结果呢，人们开始指责Perl程序成了“不可阅读（write-only）的代码”（即，只要稍过一会儿，你就读不懂刚完成的程序了）。从另一个角度看，在设计C++、VB、Perl以及Smalltalk之类的程序设计语言时，设计师也都为解决复杂性问题做了某种程度的工作。并且，正是解决某类特定问题的能力，成就了它们的成功。

随着对Java的了解越来越深，Sun对Java的设计目标给我留下了最深刻印象，那就是：为程序员减少复杂性。用他们的话说就是：“我们关心的是，减少开发健壮代码所需的时间以及困难。”在早期，这个目标使得代码的运行并不快（Java程序的运行效率已经改善了），但它确实显著地缩短了代码的开发时间。与用C++开发相同的程序相比，采用Java只需一半甚至更少的开发时间。仅此一项，就已经能节约无法估量的时间与金钱了。然而Java并未止步于此。它开始着手解决日渐变得重要的各种复杂任务，例如多线程与网络编程，并将其作为语言特性或以工具库的形式纳入Java，这使得开发此类应用变得倍加简单。最终，Java解决了一些相当大的复杂性问题：跨平台编程、动态代码修改，甚至是安全的议题。它让你在面对其中任何一个问题时，都能从“举步维艰”到“起立鼓掌”。抛去我们都能看到的性能问题，Java确实非常精彩地履行了它的诺言：极大地提升程序员的生产率。

同时，Java正从各个方面提升人们相互通讯的带宽。它使得一切都变得更容易：编写程序，团队合作，创建与用户交户的用户界面，在不同类型的机器上运行程序，以及编写通过因特网通信的程序。

我认为，通讯变革的成果并不见得就是传输巨量的比特。我们所看到的真正变革是人与人之间的通讯变得更容易了：无论是一对一的通信，还是群体与群体之间，甚至整个星球之间的通信。我曾听闻，在足够多的人之间的相互联系之上，下一次变革将是一种全球意识的形成。Java说不定就是促进该变革的工具，至少，它所具备的可能性使我觉得，教授这门语言是非常有意义的一件事情。

### Java SE5与SE6

本书的第4版得益于Java语言的升级。Sun起初称其为JDK1.5，稍后改作JDK5或J2SE5，最终Sun弃用了过时的“2”，将其改为Java SE5。Java SE5的许多变化都是为了改善程序员的体验。你将会看到，Java语言的设计者们并未完全成功地完成该任务，不过，总的来说，他们已经向正确的方向迈出了一大步。

新版的一个重要目标就是完整地吸收Java SE5/6的改进，并通过本书介绍以及应用这些变化。这意味着本书基本可以称之为“只限Java SE5/6”。并且，书中的多数代码并没有经过老版本的Java编译测试，所以如果你使用的是老版本的Java，编译可能会报错并中止。不过，我觉得这样利大于弊。

如果你不得不采用老版本的Java，我仍然为你在https://www.mindviewllc.com提供了本书早期版本的免费下载。基于某些原因，我决定不提供本书当前版本的免费电子版。

#### Java SE6

本书是一个非常耗时的，且具有里程碑意义的一个项目。就在本书出版之前，Java SE6（代号野马mustang）已经发布了beta版。虽然Java SE6中的一些小变化，对书中的代码示例有一点影响，但其主要的改进对本书的绝大部分内容并没有影响。因为Java SE6主要关注于提升速度，以及改进一些（不在本书讨论范围之内）类库的特性。

本书中代码全部用Java SE6的一个发布候选版（RC）进行过测试，因此我不认为Java SE6正式发布时会有什么变化能够影响本书的内容。如果到时真的有什么重要的改变，我将更新本书中的代码，你可以通过https://www.mindviewllc.com下载。

本书的封面已经指出，本书面向“Java SE5/6”。也就是说本书的撰写“面向Java SE5及其为Java语言引入的重大变化，同时也适用于Java SE6”。

### 第4版

为一本书写作新版时，作者最满意的是：把事情做得“恰如其分”。这是我从本书上一个版本发布以来所学到的东西。通常而言，这种见识正如谚语所云，“学习就是从失败中汲取教训。”并且，我也借机进行了一些修订。与往常一样，一个新的版本必将带来引人入胜的新思想。此时，新发现带来的喜悦，采用比以往更好的形式表达思想的能力，已经远远超过了可能引入的小错误。

这也是对不断在我脑中盘旋低语着的一种挑战，那就是让持有本书老版本的读者也愿意购买新的版本。这些促使着我尽可能改进，重写，以及重新组织内容，为热忱的读者们献上一本全新的，值得拥有的书。

### 改变

此版本中将不再包含以往本书中所携带的CD光盘。该CD中的重要部分《Thinking in C》的多媒体教程（由Chuck Allison为MindView创建），现在提供了可下载的Flash版本。该教程是为不熟悉C语法的读者所准备的。虽然，本书用了两章对语法做了较为完整的介绍，然而对于没有相应背景知识的读者而言，这也许仍然不够。而《Thinking in C》正是为了帮助这些读者提升到必要的程度。

完全重写了“并发”这一章（以前称为“多线程”），以符合Java SE5并发类库的重大改变。它将为读者了解并发的核心思想打下基础。如果没有这些核心的基础知识，读者很难理解关于线程的更复杂的议题。我花了很多个月撰写这一章，深陷“并发”的地狱之中，最终，这一章不仅涵盖了基础知识，而且大胆地引入了一些高级议题。

而对于Java SE5所具有的每一个重大的新特性，本书都有一个新的章节与之对应。其他的新特性则加入到了原有的章节中。我还一直在研究设计模式，因此在本书中，也介绍了设计模式的相关内容。

本书经历了重大的重组。这大多源自教授Java的过程，以及我对于“章节”的意义的重新思考。以前，我会不假思索地认为，每个“章节”应该包含一个“足够大的”主题。但是，在我教授设计模式的时候，我发现，如果每次只介绍一个模式（即使讲课的时间很短），然后立刻组织大家做练习，此时那些学员们的表现是最好的（我发现，这种节奏对于我这个老师而言也更有乐趣）。因此，在这一版中，我试着打破按主题划分章节的做法，也不理会章节的长度。我想，这也是一个改进。

我同样也认识到代码测试的重要性。必须要有一个内建的测试框架，并且每次你开发系统时都必须进行测试。否则，根本没有办法知道代码可靠与否。为了做到这一点，我开发了一个测试框架以显示和验证本书中每一个程序的输出结果。（该框架是用Python编写的，你可以在https://www.mindviewllc.com找到可下载的代码。）关于测试的话题在附录中有讨论。其中还包含了其他一些基本技术，我认为所有程序员都应该将它们加入到自己的工具箱中。

此外，我还仔细检查了书中的每一个示例，并且问我自己，“我为什么采用这种方式实现？”对大多数的示例，我都做了一定程度的修订与改进，使得这些示例更加贴切。同时，也传达出我所认为的Java编程中的最佳实践（至少起到抛砖引玉的作用）。许多以前的示例都经过了重新设计与重新编写，同时，删除了不再有意义的示例，也添加了新的示例。

读者们为此书的前三个版本提出了许多许多精彩的意见。这自然使我觉得非常高兴。不过，偶尔读者也会有抱怨，例如有读者埋怨“本书太长了”。对我而言，如果“页数太多”是你唯一的苦恼，那这真令人哭笑不得。（据说奥地利皇帝曾抱怨莫扎特的音乐“音符太多”！我可不是想把自己比作莫扎特。）此外，我只能猜测，发出这种抱怨的读者还不了解Java语言的博大精深，而且也没有看过这一领域的其他书籍。无论如何，在这一版中，我已经删减了过时无用，或不再重要的内容。总的来说，我已经尽我所能仔细复查了全书，进行了必要的增删与改进。对于删除旧的章节，我还是挺放心的。因为原始的材料在网站上都有（http s：//www.mindviewllc.com）。

对于仍然不能接受本书篇幅的读者，我向你们道歉。请相信，我已经尽我所能精简本书的长度了。

### 封面图片的故事

《Thinking in Java》的封面创作灵感来自于美国的Arts & Crafts运动。该运动始于世纪之交，并在1900到1920年间达到顶峰。它起源于英格兰，是对工业革命带来的机器产品和维多利亚时代高度装饰化风格的回应。Arts & Crafts强调简洁设计，而回归自然是其整个运动的核心，注重手工制造及推崇个性化设计，可是它并不回避使用现代工具。这和我们现今的情形有很多相似之处：世纪之交，从计算机革命的最初起源到对个人来说更精简、更意味深长的事物的演变，以及对软件开发技能而不仅是生产程序代码的强调。

我以同样的眼光看待Java：尝试将程序员从操作系统机制中解放出来，朝着“软件艺师”的方向发展。

我和封面设计者自孩提时代就是朋友，我们从这次运动中获得灵感，并且都拥有源自那个时期的（或受那个时期启发而创作的）家具、台灯和其他作品。

这个封面暗示的另一主题是一个收集盒，博物学家可以用它来展示他们保存的昆虫标本。这些昆虫可以看作是对象，并放置到“盒”这个对象当中，而盒对象又放置到“封面对象”当中，这形象地说明了面向对象程序设计中最为基本的“集合”概念。当然，程序员可能会不禁联想到“程序缺陷（bug）”；这些虫子被捕获，并假设在标本罐中被杀死，最后禁闭于一个展示盒中，似乎暗示Java有能力发现、显示和制服程序缺陷（事实上，这也是它最为强大的属性之一）。

在本版中，我创造了一幅水彩画，你可以在封面的背景中看到它。

### 致谢

首先感谢和我一起开研讨课、提供咨询和开发教学计划的这些合作者：Dave Bartlett、Bill Venners、Chuck Allison、Jeremy Meyer和Jamie King。在我转而不停地竭力为那些像我们一样的独立人群开发在一起协同工作的最佳模式的时候，你们的耐心让我感激不已。

最近，无疑是因为有了Internet，我可以和极其众多的人一起合作，他们协助我一起努力，他们通常是在家办公。过去，我可能必须为这些人提供相当大的办公空间，不过由于现在有了网络、传真以及电话，我不需要额外的开销就可以从他们的帮助中受益。在我尽力学习更好地与其他人相处的过程中，你们都对我很有帮助，并且我希望继续学习怎样使我的工作能够通过借鉴他人的成果而变得更出色。Paula Steuer在接管我偶尔的商务活动时发挥了不可估量的价值，他使它们变得井井有条（Paula，感谢你在我懈怠时对我的鞭笞）。Jonathan Wilcox，Esq. 详细审视了我公司的组织结构，推翻了每一块可能隐藏祸害的石头，并且使所有事情都条理化和合法化了，这让我们心服口服。感谢你的细心和耐心。Sharlynn Cobaugh使自己成为声音处理的专家，她是创建多媒体培训CD ROM和解决其他问题的精英成员之一。感谢你在面临难于处理的计算机问题时的坚定不移。在布拉格Amaio的人们也提出了一些方案来帮助我。Daniel Will-Harris最先受到在网上工作的启发，因此他当然是我所有设计方案的主要人物。

多年以来，Gernal Weinberg通过他的学术会议和研讨会，已经成为了我非正式的教练和导师，我十分感谢他。

Ervin Varga在第4版的技术纠正方面提供了巨大的帮助——尽管其他人在各个章节和示例方面也帮助良多，但是Ervin是本书最主要的技术复审者，他还承担了第4版的解决方案指南的重写任务。Ervin发现的错误和对本书所作的完善对本书来说价值连城。他对细节的投入和关注程度令人惊异，他是我所见过的远远超过其他人的最好的技术读者。感谢你，Ervin。

我在Bill Venners的www.Artima.com上的weblog，已经成为了当我需要交流思想时的一种解决之道。感谢那些通过提交评论帮助我澄清概念的人们，包括James Watson、Howard Lovatt、Michael Barker以及其他一些人，特别是那些在泛型方面提供帮助的人。

感谢Mark Welsh不懈的帮助。

Evan Cofsky一如既往地提供了有力的支持，他埋头处理了大量晦涩的细节，从而建立和维护了基于Linux的Web服务器，并保持MindView服务器始终处于协调和安全的状态。

一份特别的感谢要送给我的新朋友，咖啡，它为本项目产生了几乎无穷无尽的热情。当人们来到MindView研讨课时，科罗拉多州Crested Butte的Camp4 Coffee已经成为了标准住所，并且在研讨课中间休息期间，它是我所遇到的最好的饮食场所。感谢我的密友Al Smith，是他使这里成为如此好的一个地方，成为Crested Butte培训期间一个如此有趣和愉快的场所。还要感谢Camp4的所有泡吧常客们，很高兴他们总是为我们提供一些饮料。

感谢Prentice Hall的人们不断地为我提供我所需要的一切，并容忍我所有的特殊需求，而且不厌其烦地帮我把所有事情都搞定。

在我的开发过程中，有些工具已经被证明是无价的；但每次使用它们时都会非常感激它们的创建者。Cygwin（http://www.cygwin.com）为我解决了无数Windows不能解决的问题，并且每天我都会变得更加依赖它（如果在15年前当我的头脑因使用Gnu Emacs而搞得发懵的时候，能有这些该多好啊）。IBM的Eclipse（http://www.eclipse.org）对开发社区做出了真正杰出的贡献，并且随着它的不断升级，我期望能看到它的更伟大之处（IBM是怎样成为潮流所向的？我肯定错过了一份备忘录）。而JetBrains IntelliJ Idea则继续开阔着开发工具的创新之路。

我一开始就将Sparxsystems的Enterprise Architecture用于本书，并且它很快就成为了我选择的UML工具。Marco Hunsicker的Jalopy代码格式化器（www.triemax.com）在大量的场合都派上了用场，而且Marco在将其配置成满足我的特殊需求方面也提供了大量的帮助。我还发现Slava Pestov的JEdit及其插件经常会显得很有用（www.jedit.org），并且对于研讨课来说，它是非常适合初学者的编辑器。

当然，如果我在其他地方强调得还不够的话，我得再次重申，我经常使用Python（www.Python.org）解决问题，在我的密友Guido Van Rossum和PythonLabs那些身材臃肿愚笨的天才人物的智慧结晶的基础上，我花费了好几天的时间进行冲刺（Tim Peters，我现在已经把你借的鼠标加了个框，正式命名为TimBotMouse）。你们这伙人必须到更健康的地方去吃午餐。（还要感谢整个Python社区，他们是一帮令人吃惊的群体。）

很多人向我发送修正意见，我感激所有这些人，第1版特别要感谢：Kevin Raulerson（发现无数的程序缺陷），Bob Resendes（简直难以置信），John Pinto、Joe Dante、Joe Sharp（三位都难以置信），David Combs（校正了许多语法和声明），Dr. Robert Stephenson、John Cook、Franklin Chen、Zev Griner、David Karr、Leander A. Stroschein、Steve Clark、Charles A、Lee、Austin Maher、Dennis P. Roth、Roque Oliveira、Douglas Dunn、Dejan Ristic、Neil Galarneau、David B.Malkovsky、Steve Wilkinson以及许许多多的人。本书第1版在欧洲发行时，Marc Meurrens在电子版宣传和制作方面做出了巨大的努力。

感谢在本书第2版中使用Swing类库帮助我重新编写示例的人们，以及其他助手——Jon Shvarts、Thomas Kirsch、Rahim Adatia、Rajesh Jain、Ravi Manthena、Banu Rajamani、Jens Brandt、Nitin Shivaram、Malcolm Davis，还有所有表示支持的人。

在第4版中，Chris Grindstaff对SWT一节的撰写提供很多帮助，而Sean Neville为我撰写了Flex一节的第一稿。

每当我认为我已经理解了并发编程时，又会有新的奇山险峰等待我去征服。感谢Brian Goetz帮助我克服了在撰写新版本的“并发”一章时遇到的种种艰难险阻，并发现了其中所有的缺陷（我希望如此！）

对Delphi的理解使我更容易理解Java，这一点儿都不奇怪，因为它们有许多概念和语言设计决策是相通的。我的懂Delphi的朋友们给我提供了许多帮助，使我能够洞察一些非凡的编程环境。他们是Marco Cantu（另一个意大利人-难道会说拉丁语的人在学习Java时有得天独厚的优势？）、Neil Rubenking（直到发现喜欢计算机之前，他一直都在做瑜珈／素食／禅道），当然还有Zack Urlocker（最初的Delphi产品经理），他是我游历世界时的好伙伴。我们都很感激Anders Hejlsberg的卓越才华，他在C#领域不懈地奋斗着（正如你将在本书中看到的，C#是Java SE5主要的灵感之一）。

我的朋友Richard Hale Shaw（以及Kim）的洞察力和支持都很有帮助。Richard和我花了数月时间将教学内容合并到一起，并为参加学习的学生设计出一套完美的学习体验。

书籍设计、封面设计以及封面照片是由我的朋友Daniel Will-Harris制作的。他是一位著名的作家和设计家（http://www.WillHarris.com），在计算机和桌面排版发明之前，他在初中的时候就常常摆弄刮擦信（rub-on letter），他总是抱怨我的代数含糊不清。然而，要声明的是，是我自己制作的照排好的（camera-ready）页面，所以所有排字错误都应该算到我这里。我是用Microsoft Word XP for Windows来编写这本书的，并使用Adobe Acrobat制作照排页面的。本书是直接从Acrobat PDF文件创建而来的。电子时代给我们带来了厚礼，我恰巧是在海外创作了本书第1版和第2版的最终稿——第1版是在南非的开普敦送出的，而第2版却是在布拉格寄出的。第3版和第4版则来自科罗拉多州的Crested Butte。正文字体是Georgia，而标题是Verdana。封面字体是ITC Rennie Machintosh。

特别感谢我的所有老师和我的所有学生（他们也是我的老师）。

Molly，在我从事这一版的写作时总是坐在我腿上，为我提供了她特有的温软而毛茸茸的支持。

曾向我提供过支持的朋友包括（当然还不止他们）：Patty Gast（Masseuse extraordinary），Andrew Binstock，SteveSinofsky，JD Hildebrandt，Tom Keffer，Brian McElhinney，Brinkley Barr，《Midnight Engineering》杂志社的Bill Gates，Larry Constantine和Lucy Lockwood，Gene Wang，Dave Mayer，David Intersimone，Chris和Laura Strand，Almquists，Brad Jerbic，Marilyn Cvitanic，Mark Mabry，Dave Stoner，Cranstons，Larry Fogg，Mike Sequeira，Gary Entsminger，Kevin和Sonda Donovan，Joe Lordi，Dave和Brenda Bartlett，Patti Gast，Blake，Annette&Jade，Rentschlers，Sudeks，Dick，Patty和Lee Eckel，Lynn和Todd以及他们的家人。当然还有我的父亲和母亲。

---

[^1]: 不过，我相信Python语言非常接近该目标了。参见www.python.org。