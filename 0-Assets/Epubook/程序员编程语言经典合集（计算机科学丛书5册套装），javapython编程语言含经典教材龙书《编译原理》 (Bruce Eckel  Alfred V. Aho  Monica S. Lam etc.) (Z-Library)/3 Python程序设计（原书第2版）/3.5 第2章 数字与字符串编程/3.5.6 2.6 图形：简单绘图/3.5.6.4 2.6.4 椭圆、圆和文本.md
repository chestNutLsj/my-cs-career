   

### 2.6.4　椭圆、圆和文本

现在你已经学会如何绘制直线和矩形，接下来我们开始学习更多图形元素。

为了绘制椭圆，需要指定一个限定盒子（见图2-9），就像指定矩形那样，也就是左上角的x坐标和y坐标及盒子的宽度与高度。绘制椭圆需要使用方法

![](../Images/image05474.gif)

如同绘制矩形一样，椭圆将根据当前的绘图上下文进行填充绘制、轮廓线绘制或两者都有。如果要绘制圆，把宽度和高度设置成相同的值：

![](../Images/image05475.gif)

注意（x，y）是限定盒子左上角，而不是圆的中心。

你经常需要在图的内部输出文本，例如，标记某些部分。使用画布方法drawText可以在画布的任意位置绘制一个字符串，但必须指定字符串以及限定盒子左上角的x坐标和y坐标（定位点——见图2-10）。例如

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05476.jpeg)

图2-9　椭圆及其限定盒子

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05477.jpeg)

图2-10　限定盒子和定位点

![](../Images/image05478.gif)

表2-13列出了画布对象用来绘图的方法。

表2-13　GraphicsCanvas类的绘图方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05479.jpeg)

自测题

27.如何修改2.6.2节的程序来绘制两个矩形？

28.如果在2.6.2节的程序中调用drawOval而不是drawRect，会发生什么？

29.给出绘制以（100，100）为中心且半径为25的圆的指令。

30.给出通过绘制两条线段来绘制字母“V”的指令。

31.给出绘制一个包含字母“V”的字符串的指令。

32.如何在一个红色背景上绘制一个黄色正方形？

练习它　现在你可以尝试本章最后的练习：P2.23，P2.24，P2.25。

如何做2.2　图形：绘制图形形状

假设你想编写一个程序显示图形形状，例如汽车、外星人、图表，或任何其他可以通过矩形、直线和椭圆构成的图像。这些指令将手把手教你如何把一个图形分解为多个部分并实现一个绘制图形的程序。

问题描述　编写绘制国旗的程序。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　确定你需要绘制的形状。

你可以使用下面的形状：

·正方形和矩形

·圆和椭圆

·直线

形状的轮廓可以使用任何颜色绘制，也可以使用任何颜色进行内部填充。你可以使用文本对图画的组成部分设置标签。

一些国旗的设计使用了不同颜色的3个等宽条，一个挨一个，例如下面的意大利国旗。

你可以使用3个矩形来绘制这样一个旗帜，但是如果中间的矩形是白色的，例如意大利国旗（绿、白、红），就更容易绘制了，可以在中间部分的上下各绘制一条直线：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05480.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　寻找形状的坐标。

现在你需要寻找这些几何形状的准确位置。

·对于矩形，你需要左上角的x坐标和y坐标、宽度和高度。

·对于椭圆，你需要外接矩形的左上角坐标以及宽度和高度。

·对于直线，你需要起点和终点的x坐标和y坐标。

·对于文本，你需要定位点的x坐标和y坐标。

窗口的常用尺寸是300×300像素。你可能不想旗帜总是死板地位于顶部，所以旗帜的左上角可能应该位于（100，100）。

很多旗帜，例如意大利国旗，宽∶高比例是3∶2。（如果在互联网上搜索的话你会发现特定国旗的精准比例。）例如，如果旗帜为90像素宽，那么应该是60像素高。（为什么不使用100像素宽呢？如果100像素宽，那么高度就是100×2÷3≈67，看上去会非常尴尬。）

现在你可以计算形状的所有重要顶点坐标了：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05481.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　编写绘制形状的Python语句。

在我们的例子中，有2个矩形和2条直线：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05482.jpeg)

如果你想得足够长远，可以使用几个变量来表示坐标。以旗帜为例，我们随机选择左上角坐标和宽度。所有其他坐标都可以使用这些选择进行计算。如果你决定遵从这些长远的设想，那么矩形和直线可以这样确定：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05483.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　编写程序创建图形窗口并且将在指定热区绘制图形的指令包含在模板中。

![](../Images/image05484.gif)

下面是绘制旗帜的完整程序。

ch02/how_to_2/italianflag.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05485.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05486.jpeg)

工具箱2.1　使用SymPy进行符号处理

这是本书众多“工具箱”模块的第一个。Python不仅是一个非常好的编程语言，还拥有大量有用的包组成的生态系统。如果你需要执行特定问题领域的复杂计算，已经有人把你需要的代码封装为一个库了。已有的包覆盖了统计、绘制图表、发送邮件、分析网页以及更多的任务。这些包中的大部分是由志愿者开发的，并且可以在互联网上免费获得。

在本节中，你会了解到用于符号计算的SymPy包。在2.2节中，你会发现如何计算给定x的值时数学表达式的值，例如x**2*sin(x)。SymPy包可以做更多的事情，它提供了大量的函数可以计算更多公式的值。如果学过微积分课程，你会知道有一个公式可以计算乘积的导数，SymPy知道那些规则，可以执行所有枯燥的常规操作，而你就不需要做了。它看上去像是装在盒子里的微积分课程。

当然，能够处理数学公式的程序至少已经出现50多年了，但是SymPy具有两大优点。它不是一个独立的程序，而是你可以在Python中使用的众多包之一。另外，其他的数学程序往往是配套于自己的编程语言，而这些语言与Python区别较大。使用SymPy时，你会发现在学习Python时的投资完全没有白费。

开始

在能够使用SymPy这样的包之前，必须先把它安装到你的系统中。你的老师可能已经给了你一定的安装指令，如果没有的话，我们建议你按照[http://horstmann.com/python4everyone/install.html](http://horstmann.com/python4everyone/install.html)中的指令进行安装。

本节的代码在交互模式（见编程小提示1.1）下运行得非常好。如果你使用IPython控制台的话，会得到非常有意思的结果显示，如果遵循我们的安装指令，你可以在Spyder IDE中使用IPython控制台。

像SymPy这样的第三方代码包的功能以一个或多个模块的形式进行组织。你需要导入要使用的模块，如专题2.1中所描述。这里，我们从sympy模块中导入全部内容：

![](../Images/image05487.gif)

现在我们就可以访问那个模块中的函数了。

操作表达式

一个有用的函数是sympify，可以把字符串中的表达式转换成SymPy形式。例如，

![](../Images/image05488.gif)

当输入f时，会得到

![](../Images/image05489.gif)

你得到的是一个符号表达式，而不是Python代码。你看到的字母x不是Python变量而是符号，是SymPy处理的一个特殊数据类型。显示sympify(x*x**2)时，你会发现结果是

![](../Images/image05490.gif)

SymPy知道x2·x=x3。

另外，你也可以先定义一个符号表达式x并保存到一个变量中，可以把那个变量也命名为x，然后使用运算符和函数来构造SymPy表达式：

![](../Images/image05491.gif)

模块sympy中包含用户符号表达式的数学运算符和函数的定义，所以你可以像组织Python表达式那样组合符号。

如果使用IPython notebook，你可以使用下面的命令说明以数学标记的形式显示结果：

![](../Images/image05492.gif)

见图2-11。我们在本节接下来的篇幅中会使用数学标记。如果你没有IPython notebook环境，一切仍能正常工作，只不过你会看到简单计算机表示形式的公式。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05493.jpeg)

图2-11　进行SymPy计算的IPython notebook环境

正如你已经看到的，处理符号对于简化代数表达式是非常有用的。下面给出了更多的例子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05494.jpeg)

求解方程

SymPy可以求解二次方程和更高阶方程的解。给solve方法传递一个表达式，你会得到一个列表，列表中的值带入表达式以后表达式的值为0。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05495.jpeg)

你仍然需要一些数学知识才能解释得到的结果。第二个方程有无穷多个解，因为任何一个解加上π都可以得到一个新的解。SymPy提供了两种方法用来得到其他的表达式。

SymPy可以计算导数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05496.jpeg)

计算积分也是一样的容易：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05497.jpeg)

在一个典型的计算问题中，你经常会得到一个函数的导数或积分，然后计算该表达式在特定的x值时的值。可以使用subs方法把变量替换为特定的值，然后使用evalf方法把表达式转换为一个浮点数的值：

![](../Images/image05498.gif)

最后，你可能想绘制一个函数的图像。调用plot方法可以得到一个x介于-10到10之间的函数图像。例如，

![](../Images/image05499.gif)

得到

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05500.jpeg)

你也可以提供x的不同范围，从-20到20，像这样：

![](../Images/image05501.gif)

结果如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05502.jpeg)

如果使用IPython notebook，你可以把绘图结果集成到notebook，如果图像是在单独的窗口显示的，使用指令

![](../Images/image05503.gif)

如你所见，SymPy可以快速完成你的计算任务。这也是学习Python库的一个重要原因。SymPy的创建者把大量的技能——也就是如何处理数学符号——封装成我们可以很容易使用的形式。本书后面介绍的其他Python包提供了其他领域的技能，你可以在程序中进行调用。