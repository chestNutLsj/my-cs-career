   

## 编程练习

■P8.1　改写第5章的intname.py程序，使用字典而不要使用if语句。

■P8.2　编写程序统计一个文本文件中每个单词出现的频率。

■■P8.3　改进编程练习P8.2的程序，输出前100个出现次数最多的单词。

■■P8.4　实现埃拉托色尼筛选法：古希腊时发明的一个用来计算素数的函数。选择一个整数n，该函数计算小于n的所有素数。首先把所有从1到n的数字插入一个集合，然后删除2的所有倍数（除2之外），也就是4、6、8、10、12……。再删除3的所有倍数，也就是6、9、12、15……直到![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07188.jpeg)。剩余的数字都是素数。

■■P8.5　编写程序使用字典存储学生姓名和课程成绩——都是字符串。提示程序用户增加或删除学生、修改成绩或输出所有成绩。输出应该按名字排序，格式如下：

![](../Images/image07189.gif)

■■■P8.6　编写程序读取一个Python源文件并生成该文件中所有标识符的索引。对于每个标识符，输出它出现的所有行。为了简单，把只包含字母、数字或下划线的任何字符串看做标识符。

■■■P8.7　编写程序把

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07190.jpeg)

这样的多项式保存为一些条目的清单，每个条目包含系数和x的指数。例如，你会把p（x）保存为

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07191.jpeg)

提供多项式相加、相乘以及输出多项式的函数。提供一个根据单个条目创建多项式的函数。例如，多项式p可以这样构造

![](../Images/image07192.gif)

然后计算p（x）×p（x）。

![](../Images/image07193.gif)

为多项式函数提供一个模块并导入到驱动模块中。

■■■P8.8　重做编程练习P8.7，使用字典存储系数。

■■P8.9　编写程序要求用户输入两个字符串，然后输出：

·同时在两个字符串中出现的字符。

·在一个字符串中出现而在另一个字符串中没出现的字符。

·两个字符串中都没有出现的字符。

使用set函数把字符串转换成字符的集合。

■■P8.10　编写程序读取两个文件并按序输出同时在两个文件中出现的所有单词。

■■■P8.11　编写程序读取一个文本文件，把所有单词转换为小写，输出文件中包含字母a、b等的所有单词。构造一个字典，使用小写字母作为键，值是包含该字母的单词集合。

■■■P8.12　编写程序读取一个文本文件并构建像编程练习P8.11那样的字典。然后提示用户输入一个单词，输出文件中包含该单词中所有字符的所有单词。例如，如果程序读取英文字典（例如UNIX类似系统中的/usr/share/dict/words，或者源码中的ch08/sec01/words）并且用户输入的单词为hat，你的程序应该输出包含这三个字母的所有单词：hat，that，heat，theater，等等。

■■■P8.13　多重集是个特殊的集合，其中每个条目都带着频率。例如，你可能会有一个多重集，其中有2个香蕉和3个苹果。多重集可以使用字典来实现，其中键是条目而值是频率。编写Python函数union、intersection和difference分别接收两个这样的字典并返回多重集的并集、交集和差集。在并集中，一个条目的频率是两个集合中频率的和。在交集中，一个条目的频率是两个集合中频率最小的那个。在差集中，一个条目的频率是两个集合中频率的差，但不能小于0。

■■P8.14　编写一个检查程序，首先读取一个带有一些“坏单词”（例如“sex”“drugs”“C++”等）的文件，把这些单词放入一个集合，然后再读取任意一个文本文件。程序应该把文本写入一个新的文本文件，并把文本中任何坏单词的每个字母都替换为星号。

■■P8.15　修改编程实战8.2中的程序，使其不读取带有指定缩写的文件，而是读取包含下面模式的文件：

![](../Images/image07194.gif)

把这些模式放入字典。读取一个文本，把右侧单词的任何出现都替换为左侧的内容。例如，"fortunate"变成"4tun8"，"tattoo"变成"t@2"。

■■P8.16　修改8.3.2节的程序，使得输入文件的第一行包含一系列使用冒号分隔的列头部，例如

![](../Images/image07195.gif)

■■P8.17　编写程序从[https://www.cia.gov/library/publications/the-world-factbook/rankorder/rawdata_2004.txt](https://www.cia.gov/library/publications/the-world-factbook/rankorder/rawdata_2004.txt)读取数据并放进一个字典，其中国家名字作为键，值为人均收入。然后程序应该提示用户输入国家名字并输出对应的值。用户输入quit时结束程序。

■■P8.18　编程练习P8.17的程序对用户不是很友好，因为需要用户知道国家名字的精确拼写。作为改进，用户输入单个字母时，输出以该字母开头的所有国家。使用字典并以字母作为键，国家名字的集合作为值。

■P8.19　字典的一个有用的应用是记住或者缓存之前获得的结果，这样的话当再次请求时可以从缓存中取回。修改编程练习P8.2中的单词统计程序，使得用户可以重复地输入文件名。如果同一个文件名用户输入了多次，从字典中查询答案，而不是再次统计该文件中的单词。

■■■P8.20　编写程序读取一个包含迷宫图案的文本文件，例如：

![](../Images/image07196.gif)

这里*表示墙而空格表示走廊。生成一个字典，其中键为表示走廊位置的元组(row，column)，值为相邻的走廊位置。在上面的例子中，(1，1)的邻居为{(1，2)，(0，1)，(2，1)}。输出这个字典。

■■■P8.21　继续P8.20的程序，找出从迷宫中任何点的逃跑路径。创建一个新字典，其中的键为走廊位置，值为字符串"?"。然后遍历所有键，对于位于迷宫边界上的任何键，把"?"替换为值"N"、"E"、"S"或"W"，表示逃跑路径的指针方向。现在重复遍历这些值为"?"的键并检查它们的邻居是否不是"?"，在这个过程中使用第一个字典来定位邻居。发现这样的邻居时，把"?"替换为邻居的指针方向。如果在给定的遍历中无法再进行这样的替换就结束程序。最终，输出迷宫，显示每个走廊位置到下一个逃跑位置的指针方向。例如，

![](../Images/image07197.gif)

■■P8.22　稀疏矩阵是一系列数字，其中大部分项是0。存储稀疏矩阵的一个高效方式是字典，其中键是非0值的位置，值是序列中该位置对应的值。例如，序列0 0 0 0 0 4 0 0 0 2 9可以表示为字典{5：4，9：2，10：9}。编写函数sparseArraySum，参数是两个这样的字典a和b，得到一个表示向量和的稀疏矩阵。也就是说，结果中位置i的值是a和b中位置i上值的和。

■工具箱P8.23　openweathermap.org网站也允许你获得使用纬度和经度（URL参数lat=# & lon=#）

指定的地理位置的当前天气信息。修改weather.py程序允许用户提供一个位置的纬度和经度而不是名字。

■工具箱P8.24　使用下面的调用（在工具箱7.3中描述过）连接Web服务器时：

![](../Images/image07198.gif)

你可以通过下面的调用访问“响应头部”：

![](../Images/image07199.gif)

结果是一个字典，除了其他一些属性之外，还标识了Web服务器、文档最后修改日期、该URL存储的资源的内容类型。

编写一个程序输出给定URL对应的字典，使用一些不同的URL测试你的程序。

■工具箱P8.25　很多CSV文件（见工具箱7.1）第一行中包含所有列的名字，就像

![](../Images/image07200.gif)

如果你有一个这样的文件，可以使用csv模块中的DictReader把每一行读入为把列名映射到值的字典。那样比使用它们的整数索引访问列更好一些。下面是框架代码：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07201.jpeg)

编写程序使用这个技术读取一个像上面给出的一样的CSV文件。显示成绩最高和最低的学生的学号与名字。

自测题答案

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07202.jpeg)

8.把第44行改为：

![](../Images/image07203.gif)

9.列表存储独立的元素，字典存储键/值对。

10.把每个单词作为字典的一个键，对应的值为该单词在文档中出现的次数。如果某个单词是第一次遇到，在字典中增加一个键/值对并把单词作为键，把值设置为1。每次遇到一个单词时，把对应的值加1。

11.销售数据必须在容器中按添加时一样的顺序进行保存，使得每个商店的数据出现在每个列表的相同位置上。集合中的元素不是以添加的顺序保存的。

12.会抛出异常，因为集合只能包含可哈希元素，而列表是不可哈希的（见专题8.1）。

13.每个项的值是到集合的引用。我们在字典中访问一个值时，会返回集合的引用或别名。因为集合是可变的，我们可以通过这个引用来修改集合本身。对于不可变类型不能这样做。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07204.jpeg)

15.包含集合的列表，每个商店一个集合，其中包含销量至少为8 000美元的冰淇淋口味。