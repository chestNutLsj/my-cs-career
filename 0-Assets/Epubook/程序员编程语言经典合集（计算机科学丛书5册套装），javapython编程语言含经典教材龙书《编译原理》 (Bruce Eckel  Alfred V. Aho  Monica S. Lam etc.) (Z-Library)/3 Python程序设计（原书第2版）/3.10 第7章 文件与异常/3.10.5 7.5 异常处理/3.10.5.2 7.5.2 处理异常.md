   

### 7.5.2　处理异常

每个异常都应该在程序的某个地方得到处理。如果有异常没有处理，你的程序会输出一个错误信息然后结束执行。当然，这样未被处理的异常会给程序用户造成困惑。

使用try/except语句来处理异常。把这个语句放进你的程序中某个位置，前提是知道如何处理一个特定的异常。其中try块包含一条或多条可能会引发你将要处理的类型的异常的语句。每个except子句包含一个类型的异常处理代码。

例如：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06947.jpeg)

上面的try块可能会抛出两个异常：

·如果给定名字的文件无法打开，open函数会抛出一个IOError异常。

·如果字符串包含任意不是数字常量的字符，int函数会抛出一个ValueError异常。

如果这些异常中任何一个被抛出，try块中剩余的指令都会被跳过。下面是各种异常类型会发生的事情：

·如果抛出了IOError异常，那么负责IOError异常的except子句被执行。

·如果出现了ValueError异常，那么第二个except子句被执行。

·如果抛出了任何其他异常，不会被这个try块的任何except子句处理。它会一直往外抛出，直到被另一个try块处理。

每个except子句包含一个处理程序。当except IOError子句的代码得到执行时，那么try块中的某个函数因为IOError异常而失败。在这个处理程序中，我们简单地输出一个信息表示找不到该文件。

现在我们再来看一下第二个异常处理程序：

![](../Images/image06948.gif)

这个处理程序的代码得到执行时，输出一个包含异常的信息。如果int函数无法把一个字符串转换为整数值，就会抛出一个ValueError异常。这个函数包含一个信息作为异常的一部分，包含了无法转换成为整数的字符串。例如，如果传递给int函数的字符串是"35x2"，那么异常包含的信息是：

![](../Images/image06949.gif)

为了获得这个信息，我们必须访问异常对象本身。你可以使用as语法把异常对象保存到一个变量中：

![](../Images/image06950.gif)

当ValueError的处理程序得到执行时，exception被设置为那个异常对象。在我们的代码中，会通过调用str(exception)来获得那个信息。你可以认为这个操作是把异常对象转换为字符串。

语法7.3　处理异常

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06951.jpeg)

抛出异常时，你可以提供自己的信息字符串。例如，调用

![](../Images/image06952.gif)

时，异常信息就是作为参数提供给构造器的字符串。

在这些示例的except子句中，我们只是把问题的源通知给用户。通常，给用户一个提供正确输入的机会更好一些，见7.6节。