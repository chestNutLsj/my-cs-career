   

## 编程练习

■P9.1　我们想为9.2节的计数器增加一个按钮，允许操作员撤销意外的按钮单击操作。提供一个方法：

![](../Images/image07403.gif)

模拟这样一个按钮。作为附加的预防措施，确保操作员单击撤销按钮的次数不能多于计数按钮。

■P9.2　模拟一个可以用来设置受限人数的计数器。首先，限度是通过下面的调用设置的

![](../Images/image07404.gif)

如果计数按钮单击的次数超过这个限度，通过输出一个信息“Limit exceeded”来模拟报警。

■■■P9.3　重新实现Menu类，使用一个长字符串保存所有菜单项。提示：为选项数量记录一个单独的计数器。当新增一个选项时，追加这个选项计数、选项和一个换行符。

■■P9.4　实现一个类Address。一个地址有门牌号、街道、一个可选的公寓号码、城市、州和邮政编码。定义构造函数使得可以使用两种方式创建对象：带公寓号码或不带公寓号码。提供一个print方法输出地址，街道在一行，城市、州和邮政编码在下一行。提供一个方法def comesBefore(self，other)测试这个地址是否比other来得早，如果比较邮政编码的话。

■P9.5　实现一个具有方法getSurfaceArea()和getVolume()的类SodaCan，在构造函数中，提供易拉罐的高度和半径。

■■P9.6　实现具有下面属性的类Car。一个汽车具有特定的燃油效能（以英里/加仑为单位）并且油箱中有一定数量的燃油。燃油效能在构造函数中指定，初始燃油量为0。提供一个方法drive模拟驾驶汽车行驶一定的距离，减少油箱中的燃油量。提供一个方法getGasLevel返回当前燃油量，以及一个用来加油的方法addGas。该类用法如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07405.jpeg)

■■P9.7　实现一个类Student。一个学生具有名字和测验总分。提供一个合适的构造函数和方法getName()、addQuiz(score)、getTotalScore()和getAverageScore()。为了计算最后一个，你还需要保存该学生参加的测验的数量。

■■P9.8　修改练习P9.7中的Student类，计算等级制平均分。需要一个增加等级的方法和一个获取当前GPA的方法。使用一个类Grade的元素指定等级。提供一个构造函数用来获取字符串形式的等级，例如"B+"。你还需要一个把等级转换为它们的数字值的方法（例如，"B+"变成3.3）。

■■■P9.9　实现一个类ComboLock，模拟寄物柜上的号码锁，如图所示。使用密码组合——3个介于0和39之间的数字来创建锁。方法reset用来重置表盘使其指向0。方法turnLeft和turnRight分别用来向左或向右转动表盘给定数字的刻度。方法open试图打开锁。如果用户先往右转到密码组合中第一个数字，再向左转到第二个数字，再往右转到第三个数字，锁就可以打开。

![](../Images/image07406.gif)

■■P9.10　实现一个类VotingMachine用于简单的选举。为其实现方法用来清除机器状态、投票给民主党、投票给共和党以及获取两个党的票数。

■■P9.11　提供一个Letter类用于编写一封简单的信。在构造函数中，提供发信人和收信人的名字：

![](../Images/image07407.gif)

提供一个方法：给信的主体部分增加一行文本

![](../Images/image07408.gif)

提供一个方法：用来返回这封信的全部文本

![](../Images/image07409.gif)

文本的形式如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07410.jpeg)

再提供一个驱动程序输出下面的信件。

![](../Images/image07411.gif)

创建这个Letter类的一个对象，调用两次addLine。

■■P9.12　编写一个类Bug模拟一只在一条水平线上移动的虫子。虫子只能向左或向右移动。刚开始时，虫子向右移动，但是可以转身改变方向。在每次移动中，它的位置沿当前方向改变一个单位。提供一个构造函数：

![](../Images/image07412.gif)

和方法

·def turn(self)

·def move(self)

·def getPosition(self)

该类用法如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07413.jpeg)

你的驱动程序应该创建一只虫子，让它移动和转身几次，输出实际位置和预期位置。

■■P9.13　实现一个类Moth模拟一只直线飞行的蛾子。蛾子有个位置、到固定原点的距离。当蛾子向灯的位置移动时，它的新位置是旧位置和灯源位置的中间位置。提供构造函数：

![](../Images/image07414.gif)

和方法

·def moveToLight(self，lightPosition)

·def getPosition(self)

你的驱动程序应该创建一只蛾子，让它向几个灯源位置移动，检查它的位置是否和预期的一样。

■■■P9.14　编写函数

·def sphereVolume(r)

·def sphereSurface(r)

·def cylinderVolume(r，h)

·def cylinderSurface(r，h)

·def coneVolume(r，h)

·def coneSurface(r，h)

计算给定半径为r的球体、底面半径为r且高度为h的圆柱、以及底面半径为r和高度为h的圆锥的体积和表面积。把他们放进geometry模块中，然后编写程序提示用户输入r和h的值，调用这6个函数并输出结果。

■■P9.15　通过实现类Sphere、Cylinder和Cone解决练习P9.14。哪种方法更加面向对象？

■P9.16　为9.11节中的Fraction类实现乘法和除法。

■P9.17　为9.11节中的Fraction类增加单目减运算符。重新实现二元减法运算符，调用self+(-rhsValue)。

■P9.18　在9.11节的Fraction类中，重新实现__eq__方法，使用这样一个事实：如果任何一个都不小于另外一个，这两个数字相等。

■■商业P9.19　重新实现CashRegister类，使用一个列表来跟踪每个增加的物品的价格。删除实例变量_itemCount和_totalPrice。重新实现clear、addItem、getTotal和getCount方法。增加一个方法displayAll用来显示当前交易中所有物品的价格。

■■商业P9.20　重新实现CashRegister类，使其使用一个整数跟踪总价格：价格的总美分数。例如，不保存17.29而保存整数1729。这是一种很常用的实现，因为可以避免舍入错误的累积。不要改变该类的公开接口。

■■商业P9.21　打烊之后，店主想知道这一天有多少笔交易。修改CashRegister类使其支持这个功能。提供方法getSalesTotal和getSalesCount分别获取所有交易的总金额和交易次数。提供一个方法resetSales重置所有计数器和总金额使得第二天的交易从0开始。

■■商业P9.22　实现一个Portfolio类。这个类有两个编程实战9.1中开发的BankAccount（见源码文件ch09/worked_example_1/bankaccount.py）类的对象，checking和savings。

实现4个方法：

·def deposit(self，amount，account)

·def withdraw(self，amount，account)

·def transfer(self，amount，account)

·def getBalance(self，account)

现在有account字符串"S"和"C"。对于存款和取款，它表示哪个账号受影响。对于转账，它表示钱从哪个账号中转出，并自动转账给另一个账号。

■■商业P9.23　定义并实现一个类Country保存国家名字、人口和面积。然后编写一个程序读入一些国家并输出：

·面积最大的国家。

·人口最多的国家。

·人口密度最大的国家（每平方公里的人数）。

■■商业P9.24　设计一个类Message模拟一封电子邮件。一个信息有收信人、发送人和信息文本。要求该类支持下面的方法：

·接收发送人和收信人的构造函数。

·往信息主体追加一行文本的append方法。

·把信息转换为一个长字符串的方法toString，例如："From：Harry Morgan\nTo：Rudolf Reindeer\n..."

编写程序使用这个类编写一个信息并输出它。

■■商业P9.25　设计一个类Mailbox用来保存使用练习P9.24中的Message类创建的电子邮件信息。实现下面的方法：

·def addMessage(self，message)

·def getMessage(self，index)

·def removeMessage(self，index)

■■商业P9.26　设计一个类Customer用来处理顾客会员营销活动。累积购买达到100美元之后顾客可以在下一次购买时得到10美元的折扣。提供方法

·def makePurchase(self，amount)

·def discountReached(self)

提供一个测试程序，并测试这样一个场景，顾客已经赚到了一个折扣然后又购买了超过90美元而少于100美元的商品。这应该不会导致第二个折扣。然后再增加另外一个能够导致第二个折扣的交易。

■■■商业P9.27　商业营销协会想使用类似于练习P9.26中的会员程序来促进市中心购物。商店使用1和20之间的数字来标识。为makePurchase方法增加一个新的形参变量来表示商店。如果顾客至少在3个不同的商店购物并且总金额为100美元或更多，就可以得到一个折扣。

■■■科学P9.28　设计一个类Cannonball模拟射向空中的炮弹。炮弹有

·一个x坐标和一个y坐标。

·一个x速度和一个y速度。

提供下面的方法：

·接收x位置的构造函数（y位置初始化为0）

·移动炮弹到下一个位置的方法move(sec)（首先使用当前速度计算sec秒内移动的距离，然后更新x位置和y位置；然后考虑重力加速度-9.81m/sec2并更新y速度；x速度保持不变。）

·获取炮弹当前位置的方法getX和getY

·方法shoot，其参数包括角度α和初始速度v（使用v cosα计算x速度而使用v sinα计算y速度；然后一直调用move方法，0.1秒调用一次，直到y位置近似为0；每次移动之后都调用getX和getY显示当前位置。）

在程序中使用这个类，提示用户输入发射角度和初始速度，然后调用shoot方法。

■■■科学P9.29　照片中最上面的电阻器上的色带表示6.2kΩ±5%的电阻值。电阻容差为±5%，表示可接受的电阻值变化范围。一个6.2kΩ±5%

的电阻器可能的电阻值最小是5.89kΩ而最大可能是6.51kΩ。我们说6.2kΩ是电阻器的标称值，实际电阻值则可能是5.89kΩ和6.51kΩ之间的任何值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07415.jpeg)

编写一个程序，把电阻器表示为一个类。提供单个构造函数接收标称值和容差，然后随机决定实际值。该类应该提供公开接口用来获取标称电阻值、容差和实际电阻值。

为程序编写一个main函数，通过显示10个330Ω±10%电阻器的实际值来说明这个类工作正常。

■■科学P9.30　在练习P9.29的Resistor类中，提供一个方法返回表示电阻值和容差的“色带”的描述。一个电阻器有4个色带：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07416.jpeg)

·第一条色带是电阻值的第一个有效数字。

·第二条色带是电阻值的第二个有效数字。

·第三条色带是十进制乘法器。

·第四条色带表示容差。

例如（使用表格中的值作为键），具有红、紫罗兰、绿和金色的色带（从左向右）的电阻器第一位有效数字为2，第二位有效数字为7，乘法器是105，容差为±5%，电阻值为2 700kΩ，加减5%。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07417.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07418.jpeg)

■■■科学P9.31　下图显示了一个叫作“分压器”的频繁使用到的电路。电路的输入是电压vi，输出是vo。分压器的输出与输入成正比，这个比例常数被称作电路的“增益”。分压器使用下面的公式表示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07419.jpeg)

其中G是增益，而R1和R2是构成分压器的两个电阻器的电阻值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07420.jpeg)

制造工艺的变化会根据标称值得到实际的电阻值，就像练习P9.29描述的那样。反过来，电阻值的变化又导致分压器增益值的变化。我们使用标称电阻值计算增益的标称值，而使用实际的电阻值来计算实际的增益值。

编写包含两个类VoltageDivider和Resistor的程序。Resistor类已经在练习P9.29中描述了。VoltageDivider类应该有两个属于Resistor类对象的实例变量。提供一个构造函数接收两个Resistor对象，它们电阻的标称值和电阻器容差。这个类应该提供公开接口来获得分压器增益的标称值和实际值。

编写驱动程序，通过显示十个分压器的标称增益和实际增益来演示该类工作正常，其中每个分压器含有标称电阻值为R1=250Ω和R2=750Ω且容差为5%的电阻器。

自测题答案

1.不合法——对象"Hello，World"属于str类，而str类没有print方法。

2.通过[]运算符。

3.使用包含char值的列表。

4.没有。这些方法会有同样的效果，你的代码不能以任何方式操作str对象。

5.实例变量_value不会被定义，click方法在试图取回它的值时会抛出异常。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07421.jpeg)

7.没有——公开接口没有发生改变。

8.不能直接访问实例变量，必须使用Clock类提供的方法。

9.2　1.90

10.没有名字为getAmountDue的方法。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07422.jpeg)

![](../Images/image07423.gif)

12.upper，isdigit。实际上，str类的所有方法都是访问器。

13.修改器。从文件中获取下一行会从输入中删除它，从而修改了它。不相信？考虑一下你调用两次readline会发生什么。你会得到两个不同的数字。但是如果你调用两次一个对象的访问器（两次调用之间没有修改），你一定会得到相同的结果。

14.访问器。

15.代码试图直接访问实例变量。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07424.jpeg)

17.他们不需要对程序做任何修改，因为公开接口没有发生改变。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07425.jpeg)

22.该类创建的对象不包含实例变量。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07426.jpeg)

28.增加下面的行：

![](../Images/image07427.gif)

29.一个。

30.当修改CashRegister类时，再次运行测试程序比在解释器中输入测试命令要快得多。

31.

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07428.jpeg)

32.

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07429.jpeg)

33.

![](../Images/image07430.gif)

34.

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07431.jpeg)

35.需要在deposit和withdraw方法中进行修改。还需要有方法能在结算周期结束后重置它。

36.实例变量被认为是私有的，不允许类用户直接访问。

37.增加一个列表prices。在addItem方法中，把当前价格加入到列表中。在clear方法中，把该列表替换为空列表。再提供一个方法printReceipt用来输出这些价格。

38.员工的税号没有发生改变，不应该提供设置方法。员工的工资可能会改变，应该同时提供获取方法和设置方法。

39.这是9.9.5节描述的“状态模式”的一个例子。方向是虫子转身时会改变的状态，并且它影响虫子如何移动。

40.greeting和greeting2引用同一个字符串"Hello"。

41.它们都仍引用字符串"Hello"。upper方法计算字符串"HELLO"，但它不是修改器——原始字符串没有发生改变。

42.（a）0

（b）抛出AttributeError异常。

43.调用makeCounter(3)和makeCounter(10)

创建两个对象。第一个对象从调用构造函数开始就一直存活，直到main函数的第三行，此时该对象不再使用。第二个对象一直存活到程序结束。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07432.jpeg)

46.改变过Fraction类的构造函数的默认值参数：

![](../Images/image07433.gif)

47.是的。它们会成为可变的，因为这些方法会改变保存在实例变量numerator和denomi-nator中的值。

48.对于如何存储正数和负数是有限制的。另外，有理数必须使用最小化简形式进行存储。如果增加这些方法，这些需求必须进行加强。