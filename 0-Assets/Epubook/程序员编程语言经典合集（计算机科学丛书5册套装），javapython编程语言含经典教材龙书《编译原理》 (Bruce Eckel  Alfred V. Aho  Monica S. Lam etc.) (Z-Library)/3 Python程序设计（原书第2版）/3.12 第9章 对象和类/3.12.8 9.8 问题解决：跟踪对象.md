   

## 9.8　问题解决：跟踪对象

你已经知道手工跟踪的技术对于理解一个程序如何工作是多么有用了。你的程序中包含对象时，采用这个技术对于更好地理解对象数据和封装也是很有帮助的。

为每个对象使用一个索引卡或者便利贴。在前面，写下该对象可以执行的方法。在后面，做一个实例变量值的表格。

下面是用于CashRegister对象的卡片：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07307.jpeg)

这在很小程度上能给你一种封装的感觉。一个对象使用它的公开接口（在卡片前面）来操作，实例变量是隐藏在后面的。（这里，我们没有给变量名增加下划线，那是Python中的实现细节。）

构造对象时，写上实例变量的初始值：

![](../Images/image07308.gif)

执行修改器方法时，划掉旧的值并在下面写上新的值。下面是调用addItem方法之后发生的事：

![](../Images/image07309.gif)

如果在你的程序中有多个对象，你会使用多个卡片，每个对象一个卡片：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07310.jpeg)

这些图在设计类时也是有用的。假设你被要求增强CashRegister类来计算营业税。在卡片前面增加一个方法getSalesTax，把卡片翻过来，看一下实例变量，自问对象是否拥有足够的信息来计算这个答案。记住每个对象都是一个自治的单元。计算中用到的任何数据值必须是

·实例变量。

·方法参数。

为了计算营业税，我们需要知道税率和应纳税总金额。（在很多州，食品是不用缴纳营业税的。）我们现在没有这些信息，需要引入额外的实例变量来表示税率和应纳税总金额。税率可以在构造函数中设置（假设在对象的生命周期中它是固定的）。增加物品时，我们需要被告知该物品是否需要纳税。如果是的话，就把它的价格增加到应纳税总金额上去。

例如，考虑下面的语句。

![](../Images/image07311.gif)

在卡片上记录效果时，看起来像：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07312.jpeg)

有了这些信息，就很容易计算税额了，也就是taxableTotal x taxRate/100。跟踪对象帮助我们理解对额外实例变量的需求。下面给出了可以计算营业税的增强版Cash-Register类。

ch09/sec08/cashregister2.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07313.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07314.jpeg)

ch09/sec08/registertester2.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07315.jpeg)

自测题

31.考虑一个模拟汽车燃油消耗的Car类。我们会假设一个固定的效能（英里[^1]），这在构造函数中提供。该类的方法分别用于：增加燃油、行驶给定距离、检查油箱中剩余燃油。为Car类的对象制作一个卡片，选择合适的实例变量并在对象被创建之后显示它们的值。

32.跟踪下面的方法调用：

![](../Images/image07316.gif)

33.假设要求通过增加一个方法getMilesDriven来模拟汽车的里程表。为对象的卡片增加一个适合于该方法的实例变量。

34.跟踪自测题32中的方法，更新你在自测题33中增加的实例变量的值。

练习它　在你可以尝试本章最后的练习：R9.10，R9.11，R9.12。

[^1]:  1英里=1 609.344米。

[^2]:  1加仑=3.785 41立方分米。