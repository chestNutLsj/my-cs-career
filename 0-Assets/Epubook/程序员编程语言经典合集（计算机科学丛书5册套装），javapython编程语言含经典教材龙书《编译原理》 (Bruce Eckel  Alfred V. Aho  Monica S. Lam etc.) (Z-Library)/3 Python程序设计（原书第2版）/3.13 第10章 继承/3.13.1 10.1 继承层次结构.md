   

## 10.1　继承层次结构

在面向对象程序设计中，继承是指通用类（称作超类）和专用类（称作子类）之间的关系。子类从超类中继承数据和行为。例如，考虑图10-1中不同类型交通工具之间的关系。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07434.jpeg)

图10-1　Vehicle类的继承层次结构

每个小轿车都是交通工具。小轿车具有所有交通工具的共同特征，例如能够把人从一个地方载到另一个地方。我们说Car类继承了Vehicle类。在这个关系中，Vehicle类是超类而Car类是子类。在图10-2中，超类和子类使用指向超类的箭头连接到一起。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07435.jpeg)

图10-2　继承图

假设我们有个操作Vehicle对象的算法。因为小轿车是一种特殊的交通工具，我们可以在这样的算法中使用一个Car类的对象，并且能够正确工作。根据替换原理，在需要一个超类对象的时候总是能够使用子类对象。例如，考虑一个接收Vehicle类型参数的函数：

![](../Images/image07436.gif)

因为Car是Vehicle的子类，你可以使用一个Car对象调用那个函数：

![](../Images/image07437.gif)

为什么给处理Vehicle对象的函数提供Car对象？那个函数会更加有用，因为它可以处理任意类型的交通工具（包括Truck和Motorcycle对象）。一般地，当我们把类分组到继承结构层次中时，就可以在类之间共享通用代码了。

在本章中，我们会考虑一个简单的表示问题的类的层次结构。很可能你已经参加过计算机等级测验。一个测验包含很多问题，并且有不同类型的问题：

·填空题

·选择题（单选或多选）

·数值型（近似值就可以，例如，如果实际答案是4/3，那么1.33就可以）

·自由发挥题

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07438.jpeg)

图10-3　显示这些题目类型的继承层次结构。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07438.jpeg)

图10-3　Question类型的继承层次结构

Question类型是这个层次结构的根。一个问题可以显示文本，可以检查给定的响应是否为正确答案。

ch10/sec01/questions.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07439.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07440.jpeg)

这个问题类是非常基本的。它不处理多选题、计算题，等等。在接下来几节中，你会看到如何使用Question类构建子类。

下面是Question类的一个简单测试程序：

ch10/sec01/questiondemo1.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07441.jpeg)

程序运行结果

![](../Images/image07442.gif)

自测题

1.考虑Manager和Emplyee类，哪个应该是超类，哪个应该是子类？

2.类BankAccount、CheckingAccount和SavingsAccount之间的继承关系是什么？

3.图7-4显示了Python中的异常类继承层次结构，列出类RuntimeError的所有超类。

4.考虑接收Car类型参数的方法doSomething(car)，列出图10-1中不能使用其对象作为该方法参数的所有交通工具类。

5.Quiz类应该从类Question继承吗？如果应该，为什么？如果不应该，又为什么？

练习它　现在你可以尝试本章最后的练习：R10.1，R10.6，R10.8。

编程小提示10.1　值变化的话使用单个类，行为变化的话使用继承

继承的目的是对具有不同行为的类进行建模。学生第一次学继承时，他们往往会过度使用，即使其中的变化可以使用简单的实例变量来表示，他们也会创建很多类。

考虑通过记录行驶距离和燃油数量来记录一些汽车燃油效能的程序。车队中有的小轿车是混合动力车。应该创建一个子类HybridCar吗？在这里不用。混合动力车在行驶和耗油方面和其他小轿车没有任何不同的行为，只是具有更好的燃油效能。拥有一个实数型实例变量milesPerGallon的单个Car类就足够了。

然而，如果你编写程序来显示如何维修不同类型的交通工具，那么创建一个单独的HybridCar类就有意义了。需要维修时，混合动力车和其他小轿车的行为是不同的。

专题10.1　超级超类：object

在Python中，每个没有明确声明超类的类都会自动从object类扩展。也就是说，object类是Python每个类的直接或间接超类（见图10-4）。类object定义了一些非常通用的方法，包括__repr__方法。

方法__repr__返回每个对象的字符串形式。默认地，这包含创建该对象的类名和该类所在的模块名。例如，我们创建两个Question对象并输出每个的字符串表示形式：

![](../Images/image07443.gif)

得到下面的输出：

![](../Images/image07444.gif)

就像在9.11节学到的，__repr__方法可以在用户自定义类中进行覆盖，用来提供该对象更有意义的表示形式。例如，在Fraction类中，我们定义了__repr__方法返回#/#形式的有理数字符串表示形式。

__repr__方法通常在子类中会被覆盖以方便调试。例如，我们可以在Question类中覆盖__repr__方法来返回问题和对应的答案：

![](../Images/image07445.gif)

![](../Images/image07446.gif)

测试Question类的实现时，我们创建测试对象并输出它们来验证是否包含正确的答案：

![](../Images/image07447.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07448.jpeg)

图10-4　object类是每个Python类的超类

![](../Images/image07449.gif)

得到下面的输出：

![](../Images/image07450.gif)

调试代码时，执行完一个操作之后能够知道一个对象的状态或内容比简单地知道对象的模块或类名更有意义。