   

## 10.4　覆盖方法

子类继承了超类的方法。如果你对继承来的方法的行为不满意，可以通过在子类中指定一个新的实现来覆盖它。

考虑ChoiceQuestion类的display方法，它覆盖了超类中的display方法用来显示答案选项。这个方法扩展了其超类版本的功能。这意味着子类方法除了执行超类方法的功能（在我们的例子中，显示问题文本）之外，还会做一些额外的工作（在我们的例子中，显示选项）。在其他情况中，子类方法替换超类方法的功能，实现完全不同的行为。

让我们来看一下ChoiceQuestion类的display方法的实现。该方法需要

·显示问题文本。

·显示答案选项。

第二部分很容易，因为答案选项是子类的一个实例变量。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07478.jpeg)

但是，如何得到问题文本呢？你不能直接访问超类的文本变量，因为它是私有的。

相反，你可以使用super函数调用超类的display方法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07479.jpeg)

如果你使用self引用而不使用super函数，那么这个方法不会像预期的那样工作。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07480.jpeg)

因为self参数引用的是ChoiceQuestion类的对象，而在ChoiceQuestion类中也有个叫display的方法，那个方法会被调用——但是那正是你正在编写的方法。如果写成那样，这个方法就会不停地调用自己。

下面是让你参加包含两个ChoiceQuestion对象的一个测验。我们创建了两个对象并依次传递给一个presentQuestion函数。那个函数向用户显示问题并检查用户的响应是否正确。（questions.py依然是10.1节中的代码，没有做改动。）

ch10/sec04/questiondemo2.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07481.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07482.jpeg)

ch10/sec04/choicequestions.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07483.jpeg)

程序运行结果

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07484.jpeg)

自测题

16.下面的display方法的实现有什么错误？

![](../Images/image07485.gif)

17.下面的display方法的实现有什么错误？

![](../Images/image07486.gif)

18.再看一下调用超类方法setAnswer的addChoice方法的实现。为什么不需要调用super().setAnswer？

19.在自测题7的Manager类中，覆盖getName方法使得经理们的名字前面有一个*（例如*Lin，Sally）。

20.在自测题7的Manager类中，覆盖getSalary方法使得返回工资和奖金的总和。

练习它　现在你可以尝试本章最后的练习：P10.1，P10.2。

常见错误10.2　调用超类方法时忘记使用super函数

扩展超类方法的功能时一个常见的错误是忘记使用super函数。例如，为了计算一个经理的工资，获取一个Employee对象的工资，然后加上奖金：

![](../Images/image07487.gif)

这里的self引用的是Manager类型的对象，而在Manager类中也有一个getSalary方法。调用那个方法是个递归调用，永远不会停止。相反，你必须显式调用超类方法：

![](../Images/image07488.gif)

无论何时，在子类同名方法中调用超类方法时，一定要在self引用的位置使用super函数。