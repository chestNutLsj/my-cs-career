   

## 10.2　实现子类

在这一节中，你会学习到如何构造子类和子类如何自动继承超类的功能。

假设你想编写程序处理下面这样的问题：

![](../Images/image07451.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07452.jpeg)

图10-5　 ChoiceQuestion类是Question类的一个子类

你可以从零开始编写一个ChoiceQuestion类，实现方法以支持创建问题、显示问题和检查答案。但是你不需要那么做。相反，使用继承机制，把ChoiceQuestion实现为Question类的子类（见图10-5）。这会允许Choice Question子类继承Question类的特征和行为。

在Python中，通过指定子类和超类的不同之处来构建子类。

子类对象自动具有在超类中声明的实例变量，你只需要声明那些在超类对象中没有的实例变量。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07453.jpeg)

就像加长豪华轿车的生产商从一个标准轿车开始并且进行修改一样，程序员通过修改另一个类得到子类  

子类继承超类的所有方法。你需要定义子类的新方法，并且如果继承来的行为不合适的话就修改继承来的方法的实现。为继承来的方法提供新的实现时，你就覆盖了那个方法。

ChoiceQuestion对象和Question对象有三处不同：

·该类对象为答案保存多个选项。

·有个用于增加答案选项的方法。

·ChoiceQuestion类的display方法显示这些选项使得答题人能够从中选择一个。

在ChoiceQuestion类从Question类继承时，需要明确说明这三处不同：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07454.jpeg)

定义类时，头部圆括号里的类名表示继承。

语法10.1　子类定义

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07455.jpeg)

图10-6显示了ChoiceQuestion对象的布局。它拥有在超类Question中声明的实例变量_text和_answer，又增加了额外的实例变量_choices。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07456.jpeg)

图10-6　子类对象的数据布局

addChoice方法是ChoiceQuestion类所特有的，你只能把它应用到ChoiceQuestion对象，而不能应用到Question对象。

相反，display方法是在超类中就已经存在的方法。子类覆盖了这个方法，使得选项可以正确显示。

Question类的所有其他方法都自动被ChoiceQuestion类继承。

你可以在子类对象上调用继承来的方法：

![](../Images/image07457.gif)

然而，超类的实例变量对那个类是私有的。只有超类的方法才能访问它的实例变量。注意，尽管Python没有提供方法保护超类的实例变量，但作为好的编程习惯，我们应该自己时刻注意这一点。

实际上，ChoiceQuestion类的方法不应该直接访问实例变量_answer。这些方法必须使用Question类的公开接口来访问它的私有数据，就像每个其他函数或方法一样。

为了说明这一点，让我们实现addChoice方法。这个方法有两个参数：要增加的选项（追加到选项列表中），和一个布尔值用来表示这个选项是否是正确的。例如，

![](../Images/image07458.gif)

第一个参数被增加到实例变量_choices中。如果第二个参数是True，那么实例变量_answer就变成了当前选项的编号。例如，如果len(self._choice)是2的话，那么_answer被设置为字符串"2"。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07459.jpeg)

你不应该访问超类的_answer变量。幸运的是，Question类有一个setAnswer方法可以供你调用。作用在哪个对象上呢？是你当前正在修改的那个问题——也就是调用addChoice方法的那个对象。就像在第9章学的一样，调用方法的那个对象的引用被自动传递给该方法的self变量。这样，为了调用那个对象的setAnswer方法，使用self引用：

![](../Images/image07460.gif)

自测题

6.假设q是类Question的一个对象，而cq是类ChoiceQuestion的一个对象。下面哪个调用是合法的？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07461.jpeg)

7.假设Emplyee类和Manager类的定义如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07462.jpeg)

Manager类继承了哪些方法？

8.假设e是Emplyee类的一个实例，而m是Manager类的一个实例。下面哪个调用是合法的？

![](../Images/image07463.gif)

9.定义一个表示不同飞机类型的类继承层次结构，至少包含4个类。

10.定义Employee类的子类SalariedEmployee，带有一个能够接收工资作为参数的构造函数，忽略构造函数的实现。

练习它　现在你可以尝试本章最后的练习：R10.3，P10.6，P10.7。

常见错误10.1　混淆超类和子类

比较ChoiceQuestion类型的对象和Question类型的对象，你会发现

·ChoiceQuestion对象更大一些，它有个增加的实例变量_choices。

·ChoiceQuestion对象功能更强大，它有个addChoice方法。

不管怎么看，这好像都是一个更高级的对象。那么为什么ChoiceQuestion叫作子类而Question叫作超类呢？

超/子这个术语来自集合论。看一下所有问题的集合。不是所有问题都是Choice Question对象，有一些是其他类型的问题。因此，ChoiceQuestion对象的集合是所有Question对象集合的子集，而Question对象集合是ChoiceQuestion对象集合的超集。子集中更加专用的对象具有更丰富的状态和更多的功能。