   

## 10.5　多态

在本节中，你会学习到如何使用继承处理同一个程序中不同类型的对象。

考虑我们的第一个示例程序，它给用户提供了两个Question对象。第二个示例程序提供了两个ChoiceQuestion对象。我们可以编写一个显示两种题型混合的程序吗？

使用继承，这个目标是很容易实现的。为了向用户提供一个题目，我们不需要知道那个题目的准确类型。我们只是显示题目然后检查用户是否提供了正确答案。超类Question有完成该任务的方法，因此，我们可以定义presentQuestion函数并期望得到一个Question类型的对象：

![](../Images/image07489.gif)

也就是说，我们可以调用Question类定义的形参变量q的任何方法。

就像10.1节讨论的那样，在任何期望得到超类对象的时候我们都可以替换为子类对象。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07490.jpeg)

但是，在期望得到一个子类对象时，你不能替换为超类对象。例如，假设我们定义了函数addAllChoices用来把列表中的字符串作为题目选项增加到一个ChoiceQuestion对象上：

![](../Images/image07491.gif)

如果我们给第一个参数传递一个ChoiceQuestion对象时，这个函数正常工作：

![](../Images/image07492.gif)

执行addAllChoices函数时，形参变量q引用的是一个ChoiceQuestion对象。但是如果我们创建一个Question对象并传递给addAllChoices函数时：

![](../Images/image07493.gif)

会抛出一个AttributeError异常。那正是应该有的表现。形参变量q引用了一个Question对象，但是Question类并没有定义addChoice方法。你不能在对象上调用该对象所属的类没有定义的方法。

现在让我们近距离观察一下presentQuestion函数的内部，它从下面的调用开始：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07494.jpeg)

会调用哪个display方法呢？如果看一下程序的输出结果，你会发现这个方法的调用依赖于形参变量q的内容。在第一种情况中，q引用的是一个Question对象，所以调用了Question.display。但是在第二种情况中，q引用了一个ChoiceQuestion对象，所以调用的是ChoiceQuestion.display，显示选项列表。

方法调用总是在运行时由实际对象的类型决定，这叫作动态方法查询。动态方法查询允许我们使用一致的方式处理不同类型的对象。这个特点叫作多态。我们要求多个对象执行一个任务，然后每个对象按照自己的方式去完成。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07495.jpeg)

不同交通工具的运动方式不一样，类似地，多态的对象使用不同的方式执行任务  

多态使得程序非常容易扩展。假设我们想设计一个新的计算题型，并希望能够接收一个近似答案。我们要做的全部内容就是定义一个类NumericQuestion来扩展Question，并且实现自己的checkAnswer方法。然后我们可以调用presentQuestion函数并传递简答题、选择题和计算题等题型的混合。不需要对presentQuestion函数进行任何修改！这要感谢动态方法查询机制，对display和checkAnswer方法的调用会自动选择正确的类的方法。

ch10/sec05/questiondemo3.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07496.jpeg)

程序运行结果

![](../Images/image07497.gif)

![](../Images/image07498.gif)

自测题

21.考虑下面的类定义：

![](../Images/image07499.gif)

下面代码片段的结果是什么？

![](../Images/image07500.gif)

22.对于自测题21中的类定义，下面代码片段的结果是什么？

![](../Images/image07501.gif)

23.对于自测题21中的类定义，下面代码片段的结果是什么？

![](../Images/image07502.gif)

24.下面代码片段的结果是什么？

![](../Images/image07503.gif)

如果自测题21中SubB类的op2方法定义为：

![](../Images/image07504.gif)

25.如果SubB类的op2方法的定义如下，自测题24中的代码片段的结果是什么？

![](../Images/image07505.gif)

练习它　现在你可以尝试本章最后的练习：P10.4，P10.21。

专题10.2　子类和实例

在专题9.3中，你学习到了isinstance函数可以用来决定一个对象是否为特定类的实例。但是isinstance函数也可以用来决定一个对象是否是一个子类的实例。例如，函数调用：

![](../Images/image07506.gif)

如果q是Question类的实例或者扩展Question类的任何子类的实例，都会返回True。否则，返回False。

isinstance函数常见的用途是验证传递给函数或方法的参数类型是否正确。考虑presentQuestion函数，它需要一个属于Question类或该类的任意子类的实例。为了验证提供的对象的类型是否正确，我们可以使用isinstance函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07507.jpeg)

调用函数时，我们检查参数的类型。如果传递给函数的是非法类型的对象，抛出一个TypeError异常。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07508.jpeg)

专题10.3　动态方法查询

假设我们为Question类自身增加一个方法presentQuestion：

![](../Images/image07509.gif)

现在考虑下面的调用

![](../Images/image07510.gif)

那么presentQuestion方法会调用哪个display和checkAnswer方法呢？如果你看一下presentQuestion方法的代码会发现，这些方法是在self引用参数上执行的。

记住，self引用参数是调用该方法的对象的引用。在这里，self引用的是ChoiceQuestion类型的对象。由于动态方法查询，会自动调用ChoiceQuestion版本的display和checkAnswer。即使presentQuestion方法是在Question类中声明的，该Question类甚至可能都不知道ChoiceQuestion类的存在，也会发生这样的情况。

如你所见，多态是一种非常强大的机制。Question类提供了一个presentQuestion方法用来指定提供一个问题的通用特征和操作，也就是显示问题并检查响应。至于如何执行显示和检查则交给子类来决定。

专题10.4　抽象类

在对已有类进行扩展时，你可以选择是否覆盖超类中的方法。而有时可能需要强制程序员覆盖一个方法。如果难以为超类定义一个合适的默认实现，而只有子类程序员才知道如何正确实现该方法时，会发生这种情况。这里有个例子：假设Python第一国际银行决定每个账号类型必须有一些月费。这样的话，应该给Account类增加一个deductFees方法：

![](../Images/image07511.gif)

但是，这个方法应该做什么呢？当然，我们可以先让这个方法什么也不做。但是这样的话实现新类的程序可能会忘记实现deductFees方法，这样的话新的账号会继承超类这个什么也不做的方法。更好的方法是这样的——指定deductFees方法为一个抽象方法。抽象方法没有任何实现。这强制子类的实现者说明该方法的具体实现。（当然，有些子类可能决定实现一个什么也不做的方法，但那是它们的选择——而不是悄无声息地继承默认的方法。）

包含至少一个抽象方法的类叫作抽象类，不包含抽象方法的类有时叫作具体类。

在Python中，没有显式的方法用来说明一个方法是抽象方法。相反，Python程序员最常采用的方式是让该方法只有一条抛出NotImplementedError异常的语句：

![](../Images/image07512.gif)

那样的话，如果该类的用户试图调用超类的方法，就会抛出这个异常来表示有缺失的实现。

尽管这允许你创建超类或子类的对象，完整测试实现应该能够发现没有正确实现的任何抽象方法。在其他面向对象编程语言中，缺失的实现会在编译时被发现，因为不允许创建包含抽象方法的类的实例。

使用抽象类的原因是强制程序员创建子类。通过指定特定方法是抽象的，你可以避免设计可能会被其他人无意中继承的无用默认方法。

常见错误10.3　不用使用类型测试

一些程序员使用特定的类型测试以便实现针对每个类的行为：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07513.jpeg)

这是一个很差的策略。如果增加像NumericQuestion这样的新类，那么你需要修改程序中进行类型检查的所有部分，并增加另外一个情况：

![](../Images/image07514.gif)

相反，考虑为我们的测验程序增加一个NumericQuestion类的情况。不需要对那个程序做任何修改，因为它使用的是多态，而不是类型测试。

不论何时，如果你发现自己试图在类的层次结构中使用类型测试，重新考虑一下，改用多态机制。在超类中声明一个方法doTheTask，并在子类中覆盖并调用

![](../Images/image07515.gif)

如何做10.1　开发一个继承层次结构

在处理一组类时，其中有一些更加通用而另外一些则更加专用，这时候你会把他们组织为一个继承层次结构。这样可以使你使用统一的方式处理不同类的对象。

问题描述　模拟一个能为客户提供下面账号类型的银行：

·一个赚取利息的储蓄账号。利息按月计算复利，并且根据每个月的最小余额进行计算。

·一个没有利息的活期存款账号，每个月可以免费取款3次，并且每超出一笔取款收取1美元交易费。

程序需要管理一组属于这两种类型的账号，并且应该允许在不影响主循环的情况增加其他类型的账号。提供一个菜单：

![](../Images/image07516.gif)

对于存款和取款，查询账号和金额。每笔交易后输出该账号的余额。

在“Month end”命令中，累积利息或者清零交易计数器，这取决于银行账号的类型。然后输出所有账号的余额。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　列出属于该层次结构的类。

在我们的情况中，问题描述中给出了两个类：SavingsAccount和CheckingAccount。当然，你可以单独实现每个类。但那不是一个好主意，因为这些类会有些重复的功能，例如更新账号余额。我们需要另一个可以实现通用功能的类。问题描述中并没有显式地提到这样一个类。因此，我们需要自己发现它。当然，在这个情况中，解决方案是很简单的。储蓄账号和活期存款账号都是银行账号的特例。因此，我们会引入一个通用的超类BankAccount。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　把类组织进一个继承层次结构。

绘制一个显示超类和子类的继承图，如下所示：

![](../Images/image07517.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　决定通用职责。

在第2步中，你会确定层次结构根部的一个类。那个类需要有足够的职责来执行已知的任务。为了确定那些任务是什么，编写处理对象的伪代码。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07518.jpeg)

根据伪代码，我们获得每个银行账号都必须执行的通用职责列表如下：

![](../Images/image07519.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　决定在子类中覆盖哪些方法。

对于每个子类和每个通用职责，决定哪个行为可以被继承或者是否需要覆盖它。确保在继承层次的根部声明被继承或被覆盖的任何方法。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07520.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07521.jpeg)

SavingsAccount和CheckingAccount类都覆盖了monthEnd方法。SavingsAccount类必须同时覆盖withdraw方法来跟踪最小余额，而CheckingAccount类则必须在withdraw方法中更新交易次数。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　定义每个子类的公开接口。

一般地，子类具有和超类不同的职责。把它们列出来，以及需要被覆盖的方法。你还需要指定子类的对象应该如何创建。

在这个例子中，我们需要一个设置储蓄账号利率的方式。另外，我们需要指定构造函数和覆盖的方法。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07522.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第6步　确定实例变量。

列出每个类的实例变量。如果你发现一个所有类共有的实例变量，一定要在层次结构的根部定义它。

所有账号都有一个余额。我们在超类BankAccount中定义用来保存浮点数的实例变量_balance。

SavingsAccount类需要保存利率，还需要保存每个月的最小余额，并且这个值必须在所有取款中进行更新。这些会分别保存在浮点类型的实例变量_interestRate和_minBalance中。

CheckingAccount类需要统计取款次数，以便达到免费取款次数限制时进行收费。我们在CheckingAccount子类中定义实例变量_withdrawals保存那个值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第7步　实现构造函数和方法。

BankAccount类的方法更新或返回余额。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07523.jpeg)

在BankAccount超类的层面上，我们不能确定月末处理，因为它依赖于账号的类型。因此，这个方法必须在每个子类中实现并为那个类型的账号执行合适的处理。我们选择让那个方法什么也不做：

![](../Images/image07524.gif)

让这个方法抛出NotImplementedError异常也是一样合适的。那样的话就表示这个方法是抽象的（见专题10.4）并且应该在子类中覆盖：

![](../Images/image07525.gif)

在SavingsAccount类的withdraw方法中，最小余额被更新。注意对超类方法的调用：

![](../Images/image07526.gif)

在SavingsAccount类的monthEnd方法中，利息被存入该账号。我们必须调用deposit方法，因为我们不能直接访问_balance实例变量。另外，最小余额被重置以便进行下个月的计算。

![](../Images/image07527.gif)

CheckingAccount类的withdraw方法需要检查取款次数。如果有太多次取款，就进行收费。同样，这里也要注意该方法是如何调用超类方法的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07528.jpeg)

活期存款账号的月末处理简单地重置取款次数即可：

![](../Images/image07529.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第8步　创建不同子类的对象并处理它们。

在我们的示例程序中，我们分配了5个活期存款账号和5个储蓄账号并且使用一个银行账号列表保存它们的地址。然后我们接收用户命令并执行存款、取款和月末处理。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07530.jpeg)

完整的程序可以在本书配套源码中找到，包括测试程序（ch10/how_to_1/accountdemo.py）和类定义（ch10/how_to_1/accounts.py）。

编程实战10.1　在工资处理中实现员工层次结构

问题描述　你的任务是实现不同员工的工资处理。

·小时工按小时计算，但是如果他们每周工作超过40小时，超出的部分要按原来的1.5倍进行支付。

·薪水工按工资支付，不论工作多少小时。

·经理是拿工资和奖金的薪水工。

你的程序应该计算一组员工的薪水。对每个员工，问一下在给定的周内工作了多少小时，然后显示赚到的工资。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　列出层次结构中的类。

在我们的例子中，问题描述列出了3个类：HourlyEmployee，SalariedEmployee和Manager。我们需要一个表示这三个类共性的类：Employee。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　把类组织进继承层次结构。

下面是我们的4个类的继承图。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07531.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　决定这些类的通用职责。

为了发现通用职责，编写处理对象的伪代码。

![](../Images/image07532.gif)

然后总结发现Employee超类有这些职责：

![](../Images/image07533.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　决定在子类中覆盖哪些方法。

在我们的例子中，获取员工姓名的操作是没有变化的，但是每个子类的工资计算方法是不同的，所以应该在每个子类中覆盖weeklyPay。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07534.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07535.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　声明每个类的公开接口。

我们通过提供姓名和工资信息来创建员工。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07536.jpeg)

这些构造函数都需要设置一个Employee对象的姓名，我们会在Employee类的构造函数中要求指定姓名作为参数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07537.jpeg)

当然，每个子类都需要一个计算周薪的方法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07538.jpeg)

在这个简单例子中，不再需要更多的方法。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第6步　确定实例变量。

所有员工都有一个姓名。因此，Employee类应该有一个实例变量_name。（见下面修改后的层次结构。）

工资怎么办呢？小时工有时薪，而薪水工有年薪。尽管有可能把这些值保存在超类中的一个实例变量中，但那不是一个好主意。结果代码需要知道那个数字表示什么，这样的代码会很复杂并且容易出错。

相反，HourlyEmployee对象应该保存时薪，SalariedEmployee对象应该保存年薪，而Manager对象应该保存周奖金。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07539.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第7步　实现构造函数和方法。

在子类构造函数中，我们需要记住设置超类的实例变量。因为超类负责初始化它自己的实例变量，我们把员工姓名传递给超类的构造函数。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07540.jpeg)

每周应支付的费用需要按问题描述中指定的方式进行计算：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07541.jpeg)

![](../Images/image07542.gif)

对于Manager而言，我们需要调用超类SalariedEmployee中的版本：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07543.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第8步　创建不同子类的对象并处理它们。

在我们示例程序中，把一些员工对象存入列表并计算周薪：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07544.jpeg)

完整的程序包含在配套源码中的文件ch10/worked_example_1/salarydemo.py和ch10/worked_example_1/employees.py中。