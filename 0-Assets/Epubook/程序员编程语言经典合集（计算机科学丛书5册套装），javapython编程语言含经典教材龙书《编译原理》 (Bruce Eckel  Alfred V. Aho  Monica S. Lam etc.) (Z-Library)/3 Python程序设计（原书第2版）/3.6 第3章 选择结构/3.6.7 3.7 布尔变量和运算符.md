   

## 3.7　布尔变量和运算符

有时你需要对程序某个部分的一个逻辑条件进行求值然后用在其他地方。为了保存取值可能为真或假的条件，你需要使用布尔变量。布尔变量是以逻辑领域的先驱、数学家乔治·布尔（1815-1864）命名的。

在Python中，布尔数据类型只有两个值，记为False和True。这些值不是字符串或整数，他们是专门为布尔变量设置的特殊值。下面的代码把一个变量初始化为True：

![](../Images/image05700.gif)

你可以在程序中稍晚的位置使用这个值来实现一个判定：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05701.jpeg)

在做出复杂判断时，你往往需要组合多个布尔值。组合布尔条件的运算符叫做布尔运算符。在Python中，and运算符只有两个条件都成立时才会得到True，or运算符只要其中一个条件成立就会得到True。

假设你编写处理温度的程序，并且想测试给定的温度下水是否以液态形式存在。（在海平面，水会在0摄氏度时结冰而在100摄氏度沸腾。）如果温度高于0度而小于100度，水是液态的：

![](../Images/image05702.gif)

测试条件有两部分，使用and运算符连接起来。每一部分是可能成立或不成立的布尔值。对于组合后的表达式而言，只有两个独立的表达式都成立时才会成立，如果两个表达式中任何一个不成立，那么结果就是不成立（见图3-8）。

布尔运算符and和or的优先级低于关系运算符。基于这个原因，你可以在布尔运算符的任意一侧使用关系运算符而不需要使用括号。例如，在表达式

![](../Images/image05703.gif)

中，表达式temp>；0和temp<；100会先被计算。然后and运算符再把计算结果组合到一起。（然而，对于复杂表达式，括号可以使得代码可读性更好。）

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05704.jpeg)

图3-8　布尔真值表

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05705.jpeg)

在冰岛的间歇性喷泉，你可以看到冰、液态水和蒸汽

相反，让我们测试在给定温度下水是否不是液体。也就是温度低于0度或高于100度。使用运算符or来组合表达式：

![](../Images/image05706.gif)

图3-9给出了这些例子的流程图。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05707.jpeg)

图3-9　and和or运算符组合表达式的流程图

有时候你需要使用布尔运算符not对条件进行求反。运算符not接收单个条件，如果条件不成立就得到True，如果条件成立就得到False。在这个例子中，如果布尔变量frozen的值是False则会得出输出：

![](../Images/image05708.gif)

表3-5给出了布尔运算符求值的更多例子。下面的程序演示了布尔表达式的应用。

ch03/sec07/compare2.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05709.jpeg)

程序运行结果

![](../Images/image05710.gif)

表3-5　布尔运算符的例子

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05711.jpeg)

自测题

31.假设x和y是两个整数，你如何测试它们两个是否都为0？

32.你如何测试是否至少有一个为0？

33.你如何测试恰好只有一个为0？

34.表达式not not frozen的值是什么？

35.与使用字符串”false”/”true”或者整数0/1相比，使用布尔类型有什么优势？

练习它　现在你可以尝试本章最后的练习：R3.29，P3.29。

常见错误3.3　混淆and和or条件

混淆and和or条件是一个非常常见的错误。介于0和100之间的值最小为0并且最大为100。如果一个值小于0或者大于100，那么就落在这个范围之外。没有什么金科玉律，你只需要考虑清楚即可。

一般而言and或者or都会清楚地进行描述，并不是很难实现。但是有时候用词可能并不是很明显。很常见的情况是每个独立的条件都可以使用列表清晰地区分开，但是关于它们应该如何组合的提示却很少。考虑报税表的这些指令。如果下面的条件中任意一个成立，你就可以确定单身纳税人的身份：

·一直没有结婚。

·在上个税收年度的最后一天合法离婚了。

·配偶去世，并且没有再婚。

由于上面的条件中只要有一个成立就可以通过测试，所以你必须使用or组合这些条件。相反，如果下面的5个条件全部成立，那么同样的税收政策允许你可以使用更加有利的身份，也就是“夫妻合并申报”：

·配偶去世不足两年，并且没有再婚。

·有个可以确定为自己后代的孩子。

·那个孩子在所有的税收年度中都生活在你的家中。

·你承担家庭支出中孩子那部分超过一半的费用。

·在配偶去世的那一年与他/她申请了联合报税。

因为上面的条件必须全部满足才能通过测试，你必须使用运算符and组合它们。

编程小提示3.4　可读性

程序不仅仅是可以被计算机执行的指令。程序实现了某个算法并且应该可以被其他人正常阅读。因此，你的程序不仅要正确，容易被其他人阅读也很重要。尽管多数程序员只关注代码布局的可读性，语法的选择也会影响代码的可读性。

为了帮助写出可读性好的代码，你应该永远不要在逻辑表达式中与布尔常量（True或者False）相比较。例如，考虑下面if语句中的表达式：

![](../Images/image05712.gif)

这个代码的读者可能会被使得该if语句能够执行的条件搞糊涂。相反，你应该使用下面的更容易接受的形式

![](../Images/image05713.gif)

这样更容易阅读，也明确描述了条件。

给包含布尔值的变量起个合适的名字也同样重要。选择使用类似于done或者valid这样的名字，使得变量值为True或False时应该采取什么操作更加明确。

专题3.3　连用关系运算符

在数学中，组合使用多个关系运算符把一个值和多个值相比较是很常见的。例如，考虑表达式

![](../Images/image05714.gif)

Python也允许使用这种方式连续使用关系运算符。表达式被求值时，Python解释器自动插入布尔运算符and形成两个独立的关系表达式

![](../Images/image05715.gif)

关系运算符可以任意组合。例如，表达式a<；x>；b是完全合法的，它表示的意思与a<；x and x>；b完全一样。换句话说，x必须比a和b都大。

大多数编程语言不允许以这种形式组合使用多个关系运算符，而是要求显式地使用布尔运算符。在开始学编程时，显式插入布尔运算符是个不错的练习。那样的话，如果你以后必须要使用另外一个不同的编程语言，就可以避免由于在逻辑表达式中连续使用关系运算符而导致的语法错误。

专题3.4　布尔运算符的短路求值

运算符and和or具有短路求值的特点。换句话说，逻辑表达式从左往右进行求值，能够确定值的同时就立刻停止求值过程。如果表达式是使用and连接的，并且第一个条件不成立，那么第二个条件不会被求值，因为无论第二个测试的结果是什么都不影响整个表达式的值。

例如，考虑下面的表达式

![](../Images/image05716.gif)

假设quantity的值为0。那么测试quantity>；0会失败，第二个测试不会再尝试。这样写是合适的，因为0做除数是非法的。

类似地，如果使用or连接的表达式中第一个条件成立，剩余的条件就不会求值了，因为结果已经确定成立了。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05717.jpeg)

在短接的电路中，电流会从最小电阻值的线路通过。类似地，短路求值会选择能够确定逻辑表达式结果的最短路径

专题3.5　德摩根定律

人们理解带有not运算符的逻辑表达式时一般会比较痛苦。根据逻辑学家Augustus De Morgan（1806-1871）命名的德摩根定律可以用来简化这些逻辑表达式。

假设我们想使用高的运输费用标准，如果不是在美洲大陆进行运输的话：

![](../Images/image05718.gif)

这个测试稍微有点复杂，你必须认真思考其中的逻辑。如果country是美国并且state不是阿拉斯加并且state不是夏威夷这个大的条件不成立，就收费20美元。嗨？这段代码绝对会把很多人搞糊涂的。

计算机并不关心这个，但是代码需要人类程序员来编写和维护。因此，知道如何简化这样的条件是非常有用的。

德摩根定律有两个形式：一个用于and表达式的否定，一个用于or表达式的否定：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05719.jpeg)

要特别注意在not移入的时候and和or运算符被翻转了。例如，“state是阿拉斯加或者是夏威夷”这个条件的否定，

![](../Images/image05720.gif)

是“state不是阿拉斯加也不是夏威夷”：

![](../Images/image05721.gif)

现在，我们把德摩根定律应用到运费计算：

![](../Images/image05722.gif)

等价于

![](../Images/image05723.gif)

因为两次取反被互相抵消了，得到一个更简单的测试

![](../Images/image05724.gif)

换句话说，当目的地是美国之外或者阿拉斯加或者夏威夷时采用更高的运费标准。

为了简化带有and和or表达式的否定的条件，使用德摩根定律把否定移入到内层往往是个好主意。