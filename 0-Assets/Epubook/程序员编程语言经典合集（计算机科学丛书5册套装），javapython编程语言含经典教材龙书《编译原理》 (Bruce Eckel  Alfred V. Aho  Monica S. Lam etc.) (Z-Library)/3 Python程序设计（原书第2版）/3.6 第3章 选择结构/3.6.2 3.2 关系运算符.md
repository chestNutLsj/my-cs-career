   

## 3.2　关系运算符

在本节中，你会学到如何在Python中比较数字和字符串。

每个if语句包含一个条件。在很多情况中，条件涉及到比较两个值的大小。例如，在前面的例子中我们测试floor>；13。比较符号>；被称作关系运算符。Python中有6个关系运算符（见表3-1）。

表3-1　关系运算符

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05594.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05595.jpeg)

在Python中，你使用关系运算符来检查一个值是否比另一个大

如你所见，只有两个Python关系运算符（>；和<；）和你期望的数学符号的含义一样。计算机键盘没有和≥、≤或≠对应的键，但是运算符>；=、<；=和!=更容易记忆，因为它们看起来非常相似。Python新手刚开始的时候可能会对运算符==比较迷惑。

在Python中，=已经有一个含义了，也就是赋值。==运算符表示相等性测试：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05596.jpeg)

你必须记住在测试语句中使用==而在测试语句之外使用=。

字符串也可以使用Python的关系运算符进行比较。例如，为了测试两个字符串是否相等，使用==运算符

![](../Images/image05597.gif)

或者，如果要测试它们是否不相等，使用!=运算符

![](../Images/image05598.gif)

对于两个相等的字符串，它们必然具有相同的长度并且包含同样的字符序列：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05599.jpeg)

哪怕只有一个字符不相等，两个字符串也不会相等：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05600.jpeg)

表3-1中的关系运算符具有比算术运算符略低的优先级。也就是说，你可以在关系运算符任何一侧直接编写算术运算符而不需要使用圆括号。例如，表达式

![](../Images/image05601.gif)

中，<；运算符两边的表达式（floor-1和13）被求值，然后对结果进行了比较。

表3-2总结了如何在Python中比较值。下面的程序使用逻辑表达式演示了比较操作。

表3-2　关系运算符示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05602.jpeg)

ch03/sec02/compare.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05603.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05604.jpeg)

程序运行结果

![](../Images/image05605.gif)

自测题

6.假设a是3并且b是4，下面哪个条件是成立的？

a.a+1<；=b

b.a+1>；=b

c.a+1!=b

7.给出下面条件的相反条件。

![](../Images/image05606.gif)

8.下面的语句有什么错误？

![](../Images/image05607.gif)

9.为下面的if语句提供一个条件，用来测试用户是否输入了Y：

![](../Images/image05608.gif)

10.你如何测试字符串userInput是空字符串？

11.考虑下面两个字符串

![](../Images/image05609.gif)

为什么这两个字符串不相等？

练习它　现在你可以尝试本章最后的练习题：R3.4，R3.7。

常见错误3.2　在浮点数之间进行精确比较

浮点数仅支持有限精度，与之相关的计算会引入舍入误差。在对浮点数进行比较时你必须认真考虑这些舍入误差。例如，下面的代码用2的平方根乘以它自己。理想情况下，我们应该会得到答案2：

![](../Images/image05610.gif)

程序显示

![](../Images/image05611.gif)

精确比较浮点数在大多数场合中是没有意义的。相反，我们应该测试它们是否足够接近。也就是说，它们的差的绝对值应该小于某个阈值。在数学上，如果对于非常小的数字ε有

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05612.jpeg)

我们认为x和y足够接近。ε是希腊字母epsilon，一般用来表示很小的数，用于比较浮点数时一般将其设置为10-14：

![](../Images/image05613.gif)

专题3.2　字符串的字典顺序

如果两个字符串互相不相等，你可能仍然需要知道它们的关系。Python的关系运算符使用字典顺序对字符串进行比较。这个顺序和字典里单词的排序方式非常类似。如果

![](../Images/image05614.gif)

那么字符串string1在字典中出现在string2的前面。例如，假设string1是”Harry”，string2是”Hello”，就是这样的情况。如果

![](../Images/image05615.gif)

那么string1按字典顺序会出现在string2的后面。

正如在前面的小节中见到的，如果

![](../Images/image05616.gif)

那么string1和string2是相等的。

字典中顺序和Python中的字典顺序有一些技术上区别。

在Python中：

·所有大写字母都排在小写字母之前。例如，”Z”在”a”的前面。

·空格在所有可打印字符的前面。

·数字在字母的前面。

比较两个字符串时，会先比较每个单词的第一个字母，然后比较第二个字母，以此类推，直到其中一个字符串结束或发现了第一对不相等的字母。

如果其中一个字符串结束，那么长的字符串被认为更“大”一些。例如，比较”car”和”cart”。前三个字母是可以匹配的，并且第一个字符串已经结束了。所以”car”按照字典顺序会出现在”cart”的前面。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05617.jpeg)

字典顺序

如果遇到不匹配的字母，包含“大”字母的字符串被认为更“大”一些。例如，比较”cat”和”cart”。

前两个字母是匹配的。因为t在r之后，所以按照字典顺序字符串”cat”排在”cart”的后面。

如何做3.1　实现一个if语句

这是关于教你如何实现一个if语句的话题。

问题描述　大学书店每年的10月24日都会举行一个千字节日优惠活动，如果价格低于128美元就给所有计算机配件8%的折扣，如果超过或等于128美元就给以16%的折扣。编写一个程序，询问收银员原始价格，然后给出打折后的价格。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　确定分支条件

在我们的示例问题中，很明显可以把条件选择为：

![](../Images/image05618.gif)

这样非常合适，我们会在我们的解决方案中使用这个条件。

但是如果你选择相反的条件，一样可以工作得很好，可以得到一个正确的解决方案：原始价格大于或等于128美元？如果换位思考，作为顾客的话，你可能会选择后面这个条件，毕竟顾客更关心什么时候可以得到最大的折扣。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　给出当条件成立时需要做的事情的伪代码。

在这一步中，你列出条件成立时需要采用的动作，细节依赖于你的具体问题。你可能想打印一个信息、计算一个值或者甚至退出程序。

在我们的例子中，我们需要使用8%的折扣：

![](../Images/image05619.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　给出条件不成立时需要做的事情的伪代码。

如果第1步中的条件不成立，你想做什么？有时，你可能什么都不想做。如果是那样的话，可以使用不带else分支的if语句。

在我们的例子中，测试的条件是价格是否低于128美元。如果那个条件不成立，价格至少是128美元，所以更高的16%的折扣会被使用：

![](../Images/image05620.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　复核关系运算符

首先，确保测试沿正确的方向进行。混淆>；和<；是一个常见的错误。然后，考虑是应该使用<；还是它的近亲<；=。

如果原始价格恰好是128美元会发生什么？仔细阅读题目，我们会发现，如果原始价格低于128美元就使用较低的折扣，如果价格至少是128美元就使用更高的折扣。128美元的价格不满足我们的条件，我们必须使用<；，而不是<；=。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　删除重复。

检查两个分支中哪些操作是共同的，移动到外面。

在我们的例子中，我们有两个如下形式的语句

![](../Images/image05621.gif)

他们的区别仅在于折扣率。最好在分支中设置折扣率，然后再进行计算：

![](../Images/image05622.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第6步　测试两个分支。

形式化两个测试用例，一个满足if语句的条件，一个不满足。想想每种情况下应该发生什么，然后按照伪代码实现每个分支。

在我们的例子中，让我们考虑原始价格为100美元和200美元的两种情况。我们期望的是第一个价格的折扣为8美元而第二个的折扣为32美元。

如果原始价格为100，那么条件100<；128成立，我们得到

![](../Images/image05623.gif)

当原始价格为200时，那么条件200<；128不成立，有

![](../Images/image05624.gif)

在两种情况下，我们得到了预期的答案。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第7步　使用Python组织if语句。

输入下面的框架

![](../Images/image05625.gif)

然后进行填充，如语法3.1所示。如果需要的话就省略else分支。

在我们的例子中，完整的语句为

![](../Images/image05626.gif)

ch03/how_to_1/sale.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05627.jpeg)

编程实战3.1　提取中间位置的元素

问题描述　你的任务是从一个给定的字符串中提出包含中间字符的字符串。例如，如果字符串是”crate”，结果是字符串”a”。然而，如果字符串包含偶数个字母，提取中间的两个字符。如果字符串是”crates”，结果是”at”。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　决定分支条件。

我们需要对奇数长度和偶数长度的字符串采取不同的行为。所以，条件是

![](../Images/image05628.gif)

在Python中，我们使用对2的余数来确定一个值是偶数还是奇数。然后决定字符串长度是奇数的测试变为

![](../Images/image05629.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　给出条件成立时要完成的工作的伪代码。

我们需要查找中间位置的字符。如果长度为5，位置是2.

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05630.jpeg)

一般地，

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05631.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　给出（如果有的话）当条件不成立时需要完成的工作的伪代码。

我们需要再次查找中间位置的字符。如果长度是6，开始位置是2，结束位置是3。也就是说，我们会执行

![](../Images/image05632.gif)

![](../Images/image05633.gif)

一般地，

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05634.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　复核关系运算符。

我们确实想要len(string)%2==1吗？例如，如果长度为5，那么5%2是除法5/2的余数，也就是1。一般地，一个奇数除以2得到余数1。所以，我们的条件是正确的。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　删除重复。

下面是我们编写的语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05635.jpeg)

每个分支中的语句几乎是完全相同的。我们可以把它们改成一样的吗？答案是肯定的，如果我们调整第二个分支中的位置：

![](../Images/image05636.gif)

现在我们把重复的代码移动到if语句的外面：

![](../Images/image05637.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第6步　测试两个分支。

我们会使用不同的字符串集进行测试。对于奇数长度的字符串，考虑”monitor”。我们得到

![](../Images/image05638.gif)

对于偶数长度的字符串”monitors”，我们得到

![](../Images/image05639.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第7步　使用Python实现语句。

下面是完整的代码片段（参见你的源代码中的ch03/worked_exaple_1/middle.py）

![](../Images/image05640.gif)