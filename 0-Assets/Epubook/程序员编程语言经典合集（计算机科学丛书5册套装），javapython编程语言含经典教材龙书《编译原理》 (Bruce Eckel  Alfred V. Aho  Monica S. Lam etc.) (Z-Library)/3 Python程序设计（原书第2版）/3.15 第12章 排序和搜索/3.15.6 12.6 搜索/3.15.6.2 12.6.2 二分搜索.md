   

### 12.6.2　二分搜索

现在我们从一个已经提前排好序的数据序列中查找一个目标。当然，我们仍然可以使用线性搜索，但是我们可以做得更好。考虑下面排好序的列表values，数据集为：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07796.jpeg)

我们想看目标值15是否存在于数据集中。通过查找目标是否存在于列表的前一半或者后一半，我们可以限制搜索过程。数据集前面一半的最后一个值values[4]是9，比目标值小。所以，我们应该在列表的后面一半来查找，也就是在下面的序列中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07797.jpeg)

这个序列中间位置上的值是20，所以目标值应该在下面的序列中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07798.jpeg)

这个非常短的序列前一半最后一个值是12，小于目标值，所以我们必须在后面一半中查找：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07799.jpeg)

很容易看出来我们找不到匹配项，因为15≠17。如果我们想在这个序列中插入15，那么应该把它插入到values[6]的前面。

这个搜索过程叫作二分搜索，因为我们在每一步中把搜索的范围缩小一半。而那个减半之所以可行，是因为我们知道值的序列是已经排好序的。

下面的函数对一个排好序的整数列表进行二分搜索。如果搜索成功的话，binarySearch函数返回匹配项的位置，如果目标值不在values中就返回-1。这里，我们显示的是二分搜索算法的递归版本。

ch12/sec06/binarysearch.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07800.jpeg)

现在让我们来确定一下执行二分搜索需要多少次列表元素的访问。我们可以使用和分析归并排序时使用的同样的技术。因为我们首先查看中间位置上的元素，这记为一次访问，然后搜索左边或右边的子列表，我们有

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07801.jpeg)

使用同样的公式，

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07802.jpeg)

把这个结果插入到原始公式，我们得到：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07803.jpeg)

可以一般化为：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07804.jpeg)

和分析归并排序一样，我们做一个简化，假设n是2的幂，n=2m，其中m=log2(n)。然后我们得到：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07805.jpeg)

所以，二分搜索是一个O(log(n))算法。

那个结果还是很直观的。假设n是100，那么每次搜索之后，搜索范围的大小减半为50、25、12、6、3、1。比较7次之后，我们的任务就完成了。这和我们的公式也是相符的，因为log2(100)≈6.643 86，而2的下一个大点的指数是27=128。

二分搜索比线性搜索快得多，那么是否值得先对列表进行排序然后再使用二分搜索呢？那要看实际情况。如果只需要搜索一次列表，那么使用一个O(n)的线性搜索就比使用一个O(nlog(n))的排序加一个O(log(n))的二分搜索要高效得多。但是如果你会对同一个列表进行多次搜索，那么排序就非常有必要了。

自测题

18.假设你需要遍历1 000 000条记录来查找一个电话号码，在找到这个号码之前预计会搜索多少条记录？

19.在linearSearch函数中你为什么不能使用循环for element in values：？

20.假设你需要遍历1 000 000个元素的已排序列表来查找一个值。使用二分搜索算法，找到这个值之前预计会搜索多少条记录？

练习它　现在你可以尝试本章最后的练习：R12.12，P12.15，P12.18。