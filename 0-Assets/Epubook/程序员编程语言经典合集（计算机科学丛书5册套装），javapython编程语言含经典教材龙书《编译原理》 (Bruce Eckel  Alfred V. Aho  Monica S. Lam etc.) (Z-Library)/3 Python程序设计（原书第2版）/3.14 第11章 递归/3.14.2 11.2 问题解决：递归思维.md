   

## 11.2　问题解决：递归思维

第5章的如何做5.2告诉你如何通过假装会有别人解决更简单输入的问题和把精力放在如何把更简单方案转换为完整问题解决方案来递归地解决问题。

在本节中，我们对一个更加复杂的问题走一遍这些步骤：测试一个句子是否为回文——翻转所有字符时得到与原来一样的字符串。常见的例子有

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07617.jpeg)

当然，回文中最古老的一个是：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07618.jpeg)

测试回文时，我们忽略大小写之间的不同，以及空格和标点符号。

我们想实现下面的isPalindrome函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07619.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　考虑简化输入的不同方式。

在你的脑子里，致力于想解决的问题的一个或一组特定的输入。想一下你可以如何简化这些输入，使得同样的问题可以应用到更简单的输入。

在考虑更简单的输入时，你可能想从原始输入中删除一点点——可能从一个字符串中删除一个或两个字符，或者删除一个几何形状的很小一部分。但是有时候把输入从中间切分开然后看一下使用这两半来解决问题意味着什么会更有帮助。

在回文测试问题中，输入是我们需要测试的字符串。你可以如何简化这个输入？这里是几种可能：

·删除第一个字符。

·删除最后一个字符。

·删除第一个和最后一个字符。

·删除中间位置的字符。

·把字符串切分成两半。

这些更简单的输入都是回文测试的潜在输入。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　把简单输入的解决方案组合为原始问题的解决方案。

考虑一下第1步中发现的更简单输入的解决方案。不用担心那些解决方案是怎么获得的。只要相信那些方案已经有了就可以。只需要告诉自己：这些是更简单的输入，所以会有别人帮我解决这个问题的。

现在思考一下你可以怎么把简单输入的解决方案转换为正在考虑的输入的解决方案。可能你需要增加一个很小的量，或许与你为了得到简单输入而砍掉的量有关。也可能你把原始输入切成两半，然后得到每一半的解决方案。那么你可能需要把两个解决方案加起来得到完整问题的解决方案。

考虑为回文测试简化输入的方法。把字符串切成两半好像不是个好主意。如果你把

![](../Images/image07620.gif)

切成两半，得到

![](../Images/image07621.gif)

和

![](../Images/image07622.gif)

第一个字符串不是回文。把输入从中间切开然后测试两半是不是回文看起来是行不通的。

最有希望的简化方法是删除第一个和最后一个字符。在前面删掉M，在后面删掉m，得到

![](../Images/image07623.gif)

假设你可以验证得到的短字符串是回文，那么原始字符串当然也是回文——我们把同样的字母放到了字符串前后。那是非常有希望的。一个单词是回文，如果：

·第一个和最后一个字母一样（忽略大小写）

·删除第一个和最后一个字母得到的单词是回文。

同样，不要担心如何测试短字符串，它绝对可以工作。

还有一个情况需要考虑。如果一个单词的第一个或最后一个字符不是字母，怎么办？例如，字符串

![](../Images/image07624.gif)

以一个!字符结束，和最前面的字母A不匹配。但是我们在测试回文时应该忽略非字母的字符。这样的话，如果最后一个字符不是字母而第一个字符是字母，同时删除第一个和最后一个字符是没有意义的。那不是问题，只删除最后一个字符就可以了。如果短字符串是回文，在后面追加一个非字母字符仍然是回文。

同样的描述也适用于第一个字符不是字母的情况。现在我们有了一组完整的用例。

·如果第一个和最后一个字符都是字母，检查它们是否一样。如果是的话，删除两端的字符，测试得到的短字符串。

·否则，如果最后一个字符不是字母，删掉它再测试得到的短字符串。

·否则，如果第一个字符不是字母，删掉它再测试得到的短字符串。

在所有这三种情况中，你可以使用简单问题的解决方案来得到原始问题的解决方案。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　查找最简单输入的解决方案。

递归计算不停地简化输入，最终到达一个非常简单的输入。为了确保递归能够停止，你必须单独处理这个最简单的情况。为它们提供特殊的解决方案，而这些解决方案通常是非常容易的。

然而，有时候你会陷入一个处理变质输入的哲学问题：空字符串，没有面积的形状，等等。这时你可能想研究一下得到这个无意义输入的那个稍大一点的输入，看一下在用于第2步中发现的规则时，你应该给这个变质输入增加什么才能使得那个简单的值可以得到正确答案。

让我们看一下回文测试的最简单字符串：

·只有两个字符的字符串

·只有一个字符的字符串

·空字符串

我们不需要为包含两个字符的字符串提供专门的解决方案。第2步仍适用于那样的字符串——删除一个或两个字符。但是我们确实需要考虑长度为0和1的字符串。在那些情况中，第2步不适用。没有两个可删除的字符。

空字符串是回文——如果反着读的话是同一个字符串。如果你感觉不对的话，考虑字符串"mm"。根据第2步中发现的规则，如果第一个和最后一个字符一样并且剩余部分——空字符串——也是回文，那么这个字符串是回文。因此，认为空字符串是回文是有意义的。

包含单个字母的字符串是回文，例如"I"。那么单个非字母字符的情况怎么办呢，例如"!"？删除!得到空字符串，而空字符串是回文。所以，我们认为长度为0或1的所有字符串都是回文。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　通过组合最简单情况和简化步骤来实现解决方案。

现在你已经准备好实现这个解决方案了。把你在第3步中发现的简单输入作为独立的情况，如果该输入不是最简单的情况之一，就实现你在第2步中发现的逻辑。

下面是isPalindrome函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07625.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07626.jpeg)

自测题

6.考虑从一个字符串中删除所有标点符号的任务。我们可以怎样把字符串分解为可以递归处理的小字符串？

7.在从字符串中删除所有标点符号的递归函数中，我们决定删除最后一个字符，然后递归处理剩余的部分。如何组合这些结果？

8.从字符串中删除标点符号时，如何发现最简单输入的解决方案？

9.写出用于从字符串中删除标点符号的递归函数的伪代码，使用自测题6～8的答案。

练习它　现在你可以尝试本章最后的练习：R11.3，P11.3，P11.6。

编程实战11.1　查找文件

问题描述　你的任务是输出一个目录树中以给定扩展名结束的所有文件名。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07627.jpeg)

一个目录树的最顶层叫做根目录。这个目录的“孩子”可以是文件或子目录。每个子目录的孩子也可以是文件或子目录。你需要输出根目录及其所有子目录中以给定扩展名结束的所有文件。

因为这些孩子中的一部分又是目录，我们很自然地想到要使用递归算法。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　考虑简化输入的不同方式。

我们的问题有两个输入：一个目录名和一个扩展名。很明显，从处理扩展名方面得不到有用的信息。然而，有个很明显的方式可以分解目录树：

·考虑根目录中的所有孩子。

·如果一个孩子是目录，使用同样的方式检查那个目录。

·如果一个孩子是文件，检查它是否具有期望的扩展名。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　把解决简单输入的方案组合为原始问题的解决方案。

我们被要求只是简单地输出找到的文件，所以没有什么结果需要合并。如果要求生成一个文件列表，我们会把从根目录开始的所有匹配项放入一个列表，并把子目录中的所有结果也放入同一个列表中。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　找到最简单输入的解决方案。

最简单的输入是一个不是目录的文件。在那种情况下，我们检查一下它是否以给定扩展名结束，如果是的话就输出它。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　通过组合简单情况和简化步骤来实现解决方案。

在我们的情况中，简化步骤就算查看这些文件和子目录：

![](../Images/image07628.gif)

为了解决这个任务，你需要使用工具箱7.2中介绍过的os模块中的几个函数。其中，listdir函数接收目录的路径（例如/home/myname/pythonforeveryone）并返回该目录中每个文件和目录的名字的列表。这些就是简单的名字，例如ch01或者hello.py。

为了把一个简单的名字转换为完整路径，我们使用join函数把这个名字和它父目录的名字组合到一起。结果是一个完整的路径，例如/home/myname/pythonforeveryone/ch01。最后，isdir函数接收这样一个路径字符串并决定它是不是一个目录名。

下面是Python版本的find函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image07629.jpeg)

在配套源码的ch11/worked_example_1/filefinder.py中可以找到完整的解决方案。