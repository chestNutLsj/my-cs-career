   

## 6.5　问题解决：修改算法

在6.2节和6.3节，你学习了一些基本的列表操作和算法。这些操作和算法构成了很多处理列表的程序的基本部分。一般来说，拥有一个基本算法的指令表并能够根据需要进行组合和修改，是解决问题的一个很好的策略。

考虑这样一个问题：已知一个学生的测验成绩，要求丢弃最低分。

对于这个问题我们没有现成的算法，但是很容易组合两个标准操作来实现：

![](../Images/image06605.gif)

例如，假设已知列表

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06606.jpeg)

最小值为4。删除最小值之后，我们得到：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06607.jpeg)

这个预排说明我们的策略是可以工作的。如果我们不关心效率，现在就可以结束了。然而，当计算机科学家处理更大的数据集时，不能满足于得到一个可以工作的解决方案，思考是否可以更高效地得到正确结果是值得的。

这对于了解库函数如何工作是有帮助的。为了删除一个值，必须首先找到它，可以使用线性搜索（6.3.5节）。这恰恰是remove方法做的事情。

先确定最小值然后再扫描列表来找到它，这样的效率是很低的。如果我们能够记住最小值出现的位置，可以直接调用pop，从而避免上面效率低的问题。

我们可以修改查找最小值的算法来得到位置。下面是原始算法：

![](../Images/image06608.gif)

找到最小值时，我们同时更新位置：

![](../Images/image06609.gif)

实际上，这样的话就没有理由再跟踪最小值了，values[smallestPosition]就是最小值。基于这个观察，我们可以把算法修改为下面的样子：

![](../Images/image06610.gif)

自测题

24.假设我们的任务是把最小值替换为0。（如果最小值出现了很多次的话，只替换其中一个。）6.2节的哪个操作可以完成这个任务？你如何更高效地完成任务呢？

25.假设你被要求计算除最小值之外所有元素的和。描述一下你如何不真的删除最小值就能解决这个任务。

26.使用6.3节中的一个或多个算法，你如何输出给定列表中正数和负数的数量？

27.修改6.3.3节中的算法，输出列表中的所有正数，使用逗号进行分隔。

28.6.3.6节中的算法如何应用在自测题27中？

练习它　现在你可以尝试本章最后的练习：R6.22，R6.23。

如何做6.1　处理列表

在很多数据处理的场合，你需要处理一系列值。这个如何做带你一步一步完成把输入值保存到列表中和对列表元素进行计算。

问题描述　最终测验成绩是把除最小的两个成绩之外的所有成绩都加起来。例如，如果成绩为

![](../Images/image06611.gif)

那么最终成绩是50。编写程序以这个方式计算最终成绩。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　把任务分解为多个步骤。

你通常会把任务分解为多个步骤，例如

·把数据读入列表。

·使用一步或多步处理数据。

·显示结果。

决定如何处理数据时，你应该熟悉6.2节和6.3节中的列表操作和算法。大多数处理任务可以使用那些算法中的一个或多个来解决。

在我们的问题中，我们会读入数据，然后删除最小值，删除剩余数据中的最小值，最后计算总和。例如，如果输入是8 4 7 8.5 9.5 7 5 10，我们会删除最小的两个成绩（4和5），得到8 7 8.5 9.5 7 10。这些值的和就是最终成绩50。

这样，我们可以分解为下面的步骤：

![](../Images/image06612.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　决定使用哪个算法。

有时候，一个步骤精确对应于一个基本的列表操作或算法。求和（6.2.7节）与读取输入（6.3.9节）都是这样的情况。其他时候，你需要组合使用几个算法。为了删除最小值，你可以先找到最小值然后删除它。如6.5节所述，找到最小值的位置然后弹出那个元素会更加高效一些。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　使用函数来构建程序。

尽管把所有步骤都放进main函数是可能的，但这不是个好主意。把每个处理步骤放进单独的函数会更好一些。我们不需要编写求和的函数，因为可以直接调用sum函数。然而，我们会实现下面的两个函数：

·readFloats

·removeMinimum

mian函数调用这些函数即可：

![](../Images/image06613.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　组装并测试程序。

回顾你的代码并检查是否处理了正常和异常的情况。空列表时会发生什么？只包含一个元素的呢？如果没有找到匹配项怎么办？有多个匹配项怎么办？考虑这些边界条件并确保你的程序工作正常。

在我们的例子中，如果列表为空或者长度为1，不可能计算最小值。在那种情况下，你应该在试图调用removeMinimum函数之前使用一个错误提示来结束程序。

如果最小值出现很多次怎么办？那意味着一个学生有多于一个测试具有同样低的成绩。和预期行为一样，我们只删除最低成绩的两次出现。

下面的表给出了测试用例和预期输出：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06614.jpeg)

下面是完整的程序：

ch06/how_to_1/scores.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06615.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06616.jpeg)

编程实战6.2　掷骰子

问题描述　你的任务是通过统计1、2……6这些值的出现频率来分析一个骰子是否均匀。你的输入是一系列掷骰子的值，应该输出一个显示每个骰子值的频率的表。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　把你的任务分解为多个步骤。

在分解时我们第一次尝试简单反映问题描述：

![](../Images/image06617.gif)

但是，让我们再深入思考一下这个任务。上面的分解建议我们首先读取和保存所有骰子的值。我们确实需要保存这些值吗？毕竟，我们只是想知道每个面的值出现了多少次。如果使用列表作为计数器，就可以在增加对应的计数器之后丢弃每个输入。

这样一提炼就得到下面的方案：

![](../Images/image06618.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　决定使用哪个算法。

我们没有能够读取输入并增加计数器的现成的算法，但是开发一个并不难。假设我们把输入读进value，这是一个介于1和6之间的整数。如果我们有一个长度为6的计数器列表，那么就可以调用

![](../Images/image06619.gif)

或者，我们可以使用7个整数的列表，浪费掉元素conters[0]。这个小改动使得更新计数器更加容易。每次读取一个输入值时，只需要执行

![](../Images/image06620.gif)

也就是说，我们定义列表为

![](../Images/image06621.gif)

为什么要引入sides变量呢？假设你以后会改变主意想研究12个面的骰子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06622.jpeg)

那么这个程序可以很容易修改，把sides设置为12即可。

现在就剩下输出计数的任务了。一个典型输出可能看起来像这样：

![](../Images/image06623.gif)

前面还没见过能够输出这样格式的算法。这类似于一个输出所有元素的基本循环：

![](../Images/image06624.gif)

然而，上面的循环并不合适，这有两个原因。首先，它会显示没有使用的第0个项目。如果我们想跳过那个项目，就不能简单地迭代列表中的元素。我们需要一个传统的计数控制的循环：

![](../Images/image06625.gif)

这个循环输出计数器的值，但是与样例输出并不完全一样。我们还想输出对应的面值：

![](../Images/image06626.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　使用函数构建你的程序。

我们会为每个步骤提供一个函数：

·countInputs(sides)

·printCounters(counters)

在main函数中调用这些函数：

![](../Images/image06627.gif)

countInputs函数读取所有输入，增加匹配的计数器，返回计数器列表。printCounters函数输出面值和计数器的值，如前所述。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　组装并测试程序。

本节最后的清单给出了完整的程序。有一个要注意的地方是我们前面没有讨论的。在更新计数器时：

![](../Images/image06628.gif)

我们想要确保用户没有提供会导致列表越界错误的错误输入。因此，我们拒绝小于1或大于sides的输入。

下面的表显示了测试用例和它们的预期输出。为了节省空间，我们只显示了输出中的计数器。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06629.jpeg)

下面是完整的程序：

ch06/worked_example_2/dice.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06630.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06631.jpeg)

程序运行结果

![](../Images/image06632.gif)

练习P6.14邀请你修改这个解决方案，使用随机生成的值来更精确地分析一个骰子是否均匀。