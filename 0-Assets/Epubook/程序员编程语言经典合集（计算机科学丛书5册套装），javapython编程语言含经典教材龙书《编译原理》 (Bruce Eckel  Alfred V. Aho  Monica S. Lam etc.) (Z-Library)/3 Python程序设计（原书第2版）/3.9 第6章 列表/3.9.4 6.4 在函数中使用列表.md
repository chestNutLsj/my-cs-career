   

## 6.4　在函数中使用列表

函数可以接收列表作为参数。例如，下面的函数计算一个浮点数列表的和：

![](../Images/image06573.gif)

这个函数访问列表中的元素，但是并没有修改它们。它也可能会修改列表中的元素。下面的函数把列表中的所有元素都乘以给定的系数：

![](../Images/image06574.gif)

图6-8跟踪了这个函数调用：

![](../Images/image06575.gif)

注意这些步骤：

·创建形参变量values和factor。①

这些形参变量被函数调用时提供的实参所初始化。在我们的示例中，values被设置为scores，factor被设置为10。注意values和scores是同一个列表的引用。②

·函数把所有列表元素都乘以10。③

·函数返回，其中的形参变量被删除。然而，scores仍然引用修改元素之后的列表。④

函数可以返回列表。在函数中创建结果并返回即可。在上面的例子中，squares函数返回一个包含从02到(n-1)2的平方数列表：

![](../Images/image06576.gif)

![](../Images/image06577.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06578.jpeg)

图6-8　跟踪multiply函数的调用

下面的程序从标准输入读取一些值，把它们乘以10，再以相反的顺序输出结果。程序使用了3个函数：

·readFloats函数返回一个列表，使用6.3.1节中的算法。

·multiply函数有一个列表参数，它会修改列表元素。

·printReversed函数也有一个列表参数，但是不会修改列表元素。

ch06/sec04/reverse.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06579.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06580.jpeg)

程序运行结果

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06581.jpeg)

自测题

19.如何调用squares函数计算前5个平方数并把结果保存到列表numbers中？

20.编写函数fill使用给定值填充列表元素。例如，调用fill(scores，10)应该使用10填充列表scores。

21.描述下面函数的功能（假设randint函数已从random模块中导入）：

![](../Images/image06582.gif)

22.考虑下面翻转列表的函数：

![](../Images/image06583.gif)

假设reverse函数被调用并传递包含数字1、4和9的列表。函数调用之后scores的内容是什么？

23.提供自测题22中的reverse函数被调用并传递值1、4和9时的跟踪图。

练习它　现在你可以尝试本章最后的练习：R6.21，P6.8，P6.9。

专题6.3　传值调用和传址调用

我们已经告诉你Python函数永远不会修改传递给它的变量的内容。如果你调用fun(var)，那么var的内容在调用函数之后和调用之前是一样的。原因很简单。函数被调用时，var的内容会被复制到对应的形参变量中。但当函数退出时，形参变量被删除。var的内容在任何位置都不会被修改。计算机科学家称这种调用机制为“传值调用”。

另外一个编程语言，例如C++，支持一种称为“传址调用”的机制，可以修改函数实参。你可能听说过在Python中“数值是传值的，列表是传址的”。那在技术上并不是正确的。在Python中，列表本身永远不会被作为参数传递，只有它们的引用会被传递。数字和列表引用都是传值的。

Python函数在接收到列表的引用时可以修改列表的内容（见图6-8），所以导致了混淆。在Python中，当你调用fun(lst)时，函数可以修改列表的内容，lst中保存着列表的引用，但是无法使用不同列表的引用替换lst。

专题6.4　元组

Python提供了一个包含任意数据的不可变序列的数据类型。元组非常类似于列表，但是一旦创建其内容无法被修改。元组通过指定其内容为逗号分隔的序列来创建。你可以使用圆括号来界定这个序列：

![](../Images/image06584.gif)

如果你愿意，也可以省略圆括号：

![](../Images/image06585.gif)

然而，我们更倾向于使用圆括号使代码更清晰。

你已经知道字符串格式化时元组的用法：

![](../Images/image06586.gif)

这里的元组(low，high)用来传递值的集合以替换格式字符串中的格式符。

列表的很多操作也适用于元组：

·通过位置访问元组中的单个元素（element=triple[1]）。

·使用len函数获得元组中元素的数量。

·使用for循环迭代元组中的元素。

·使用in和not in测试成员。

实际上，任何不修改列表内容的操作都可以用于元组。元组仅仅是列表的不可变版本。

在本书中，我们不使用元组——仅仅使用列表，即使我们永远不会改变它们。但是，正如你在下面的专题中看到的，元组在Python函数中非常有用。

专题6.5　参数数量可变的函数

在Python中，可能会定义能够接收可变数量参数的函数。例如，我们可以编写能够计算任意数量个参数和的sum函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06587.jpeg)

然后修改sum函数的定义为

![](../Images/image06588.gif)

形参变量之前的星号表示函数可以接收任意多个参数。形参变量values实际上是一个包含传递给函数的所有实参的元组。函数实现遍历values元组并处理这些元素：

![](../Images/image06589.gif)

因为形参变量是一个元组，包含0在内的任意数量实参都可以传递给这个函数：

![](../Images/image06590.gif)

函数也可以定义为接收固定数量个实参然后再接收可变数量个实参：

![](../Images/image06591.gif)

在这个例子中，前两个参数需要传递并赋值给形参变量idNum和name。任何剩余的实参会被保存到grades元组中。当与固定形参变量组合时，元组形参变量必须是最后一个。

专题6.6　元组赋值

在Python中（与很多其他编程语言不同），你可以在单个赋值语句中为多个变量赋值：

![](../Images/image06592.gif)

左边是一个包含多个变量的元组。元组中的每个变量被赋值为右边元组中对应位置的元素值。

省略圆括号是合法的：

![](../Images/image06593.gif)

很多时候，这并不比分开写的赋值语句更有用。

![](../Images/image06594.gif)

然而，同时赋值是交换两个值的一种非常方便的快捷形式：

![](../Images/image06595.gif)

当然，赋值不会是真的同时的。真相是，右边的值先保存在一个临时元组中，然后这个元组中的值被赋值。

专题6.7　使用元组返回多个值

在第5章中，你学习了函数只可以返回单个值。然而，在Python经常会使用元组来返回多个值。例如，假设我们定义了一个函数可以从用户获取表示月、日、年的整数作为日期，然后在元组中返回这3个值：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06596.jpeg)

当这个函数被调用时，你可以把整个元组赋值给一个变量：

![](../Images/image06597.gif)

或者你可以使用元组赋值：

![](../Images/image06598.gif)

有人喜欢省略圆括号，使得看起来好像函数真的返回了多个值：

![](../Images/image06599.gif)

尽管如此，那仍然是个元组。

如果愿意，你也可以在元组赋值时省略圆括号：

![](../Images/image06600.gif)

为简单起见，在本书中不在函数中返回元组。当然，我们经常实现和使用返回列表的函数。在我们的例子中，readDate可以简单地返回一个列表[month，day，year]。

工具箱6.1　编辑声音文件

声音震动由琴弦或扬声器隔膜之类的物体产生，然后通过某种介质传播——一般是空气——直到遇到麦克风或耳膜。压力的变化产生了声音的感觉。为了测量声音，需要不停地确定压力的大小。测量的频率称作“采样频率”。例如，音乐CD使用每秒44 100次的采样频率。你应该简单地认为声波是按固定间隔采样得到的一系列测量值。

有很多有趣的方法可以处理声音数据。在这个工具箱中，我们会使用工具箱2.1中和其他模块一起安装的SciPy扩展库来编辑声音文件。

关于声音文件

包括音乐CD在内的很多声音文件把声音值表示为在-32 768和32 767之间变化的16位整数。在处理声音时，你实际上是在处理一个很长的整数列表。图6-9显示了猫叫的声波。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06601.jpeg)

图6-9　猫叫的声波

一些声音文件包含立体声音，这时每个采样有两个值：左右扬声器各一个。

声音文件可能会非常大。CD质量的声音每分钟大概需要10MB空间。CD包含原始的声音数据，但是在互联网上购买音乐时，数据是经过压缩的，这样可以使文件更小。目前，最通用的压缩格式都受专利保护。基于这个原因，我们把精力放在未压缩的声音文件上。如果想使用本节的技术处理压缩文件，你应该首先将其解压缩为WAV格式。推荐使用Audacity程序（可以在[http://audacity.sourceforge.net](http://audacity.sourceforge.net)获得），对于分析你制作的声音文件也是很有用的。

读取和写入声音文件

我们使用SciPy扩展库中的scipy.io.wavfile模块来读取和写入声音文件。你可以使用read函数读取一个声音文件，该函数返回一个包含两个元素的元组（见专题6.4）：采样频率和声音数据。声音数据存储在一种特殊格式中（NumPy数组），可以将其转换为Python列表：

![](../Images/image06602.gif)

如果文件包含单声道声音，声音数据是一个数字列表。（处理立体声文件的内容见练习P6.47。）你可以以某种方式处理这个列表，然后使用scipy.io.wavfile.write函数把处理结果保存到另一个文件中。在把声音数据传递给那个函数之前，你需要使用numpy.asarray函数把数据转换回NumPy数组：

![](../Images/image06603.gif)

运行你的Python程序之后，使用你的计算机上的音乐播放器或者Audacity程序听一下输出的文件。

处理声音数据

这里给出了一个处理声音数据的令人惊讶的简单例子。让我们把所有正数都替换为30 000，把所有负数都替换为-30 000。

![](../Images/image06604.gif)

看起来好像这个操作会彻底毁坏数据，但是并没有。你必须亲自体验一下！大胆开始吧，使用你的源码中提供的输入文件（一个猫叫片段和一个经典的音乐片段）运行这个程序。结果很粗糙，但是你可以清晰地听出原来的声音。

练习P6.39到练习P6.49邀请你完成几个有用的声音处理。你可以通过在列表的开始或最后降低音量来增加“淡入”和“淡出”效果。你可以通过计算列表值的平均值来混合两个音轨。你可以通过偏移声波，将其稀薄化，然后和原始声波混合，从而产生回声效果。所有这些效果都可以通过处理列表中的数字轻易实现。