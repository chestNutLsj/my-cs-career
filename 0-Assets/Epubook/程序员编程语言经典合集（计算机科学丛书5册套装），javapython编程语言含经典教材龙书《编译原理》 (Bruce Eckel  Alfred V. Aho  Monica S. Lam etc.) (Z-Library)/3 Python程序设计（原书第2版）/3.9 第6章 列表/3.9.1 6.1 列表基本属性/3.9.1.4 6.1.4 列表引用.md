   

### 6.1.4　列表引用

如果近距离观察图6-1，会注意到变量values中没有存储任何数字。相反，列表是存储在另一个地方的，values变量存储的是列表的引用。（引用表示列表在内存中的地址。）当访问列表中的元素时，你不需要关心Python使用列表引用的事实。这一点仅在复制列表引用时比较重要。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06475.jpeg)

图6-2　两个变量引用同一个列表

当把一个列表变量复制给另一个变量时，两个变量引用同一个列表（见图6-2）。第二个变量是第一个变量的别名，因为两个变量引用同一个列表。

![](../Images/image06476.gif)

你可以通过其中任何一个变量来修改列表：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06477.jpeg)

6.2.8节介绍了如何复制列表中的内容。

自测题

1.定义一个包含前5个素数的整数列表。

2.假设列表primes已如自测题1中的描述进行了初始化，执行完下面的循环后这个列表中包含什么？

![](../Images/image06478.gif)

3.假设列表primes已如自测题1中的描述进行了初始化，执行完下面的循环后这个列表中包含什么？

![](../Images/image06479.gif)

4.已知定义

![](../Images/image06480.gif)

编写语句把整数10放进列表values的最小和最大有效索引的元素中。

5.定义一个包含两个字符串"Yes"和"No"的列表。

6.你能使用类似于4.5.4节给出的查找最大值的算法不把输入保存为列表的情况下直接给出6.1.1节的输出吗？输出见下图：

![](../Images/image06481.gif)

练习它　现在你可以尝试本章最后的练习：R6.1，R6.2，R6.7，P6.1。

常见错误6.1　越界错误

在使用列表时最常见的错误可能是访问不存在的元素。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06482.jpeg)

如果你的程序在访问列表时存在越界错误，程序会在运行时引发异常。

专题6.1　反向下标

和很多其他语言不同，Python还允许你在访问列表元素时使用负数下标。负数下标提供了按相反顺序访问列表元素的方法。例如，下标-1可以访问列表中的最后一个元素：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06483.jpeg)

类似地，values[-2]是倒数第二个元素。

注意values[-10]是第一个元素（参见上图）。

一般地，负数下标的有效范围介于-1和-len(values)之间。

编程小提示6.1　使用列表存储相关元素的序列

列表一般用来存储相同含义的值的序列。例如，一个包含考试成绩的列表是有意义的：

![](../Images/image06484.gif)

但是下面的列表

![](../Images/image06485.gif)

分别在位置0、1、2和3包含了一个人的名字、年龄、银行余额和鞋子的尺寸，这就是一个很糟糕的设计。让程序员记住这些数据中哪一个存储在什么位置，这是很无聊的一件事。在这种场合中，使用3个独立的变量会好很多。

计算与社会6.1　计算机病毒

1988年11月，康奈尔大学的学生罗伯特·莫尔斯编写了一个所谓的病毒程序并感染了美国连接到互联网的6000台计算机。成千上万的计算机用户无法阅读他们的电子邮件或者无法使用计算机。所有的主要大学和很多高科技公司被感染。（当时的互联网比现在要小得多。）

这次攻击中使用的病毒叫作蠕虫。蠕虫程序在互联网上从一台计算机爬到另一台计算机。蠕虫会试图连接finger，一个在UNIX操作系统中用来查找在网络上特定主机有账号的用户信息的程序。和UNIX中很多程序一样，finger是用C语言编写的。为了存储用户名，finger程序分配了512个字符的数组（数组是类似于列表的一个序列结构），这基于一个假设：没有人会提供这么长的输入。不幸的是，C语言并不会检查数组索引是否小于数组的长度。如果你使用太大的索引往数组中写入数据，就会覆盖属于其他对象的内存地址。在finger程序的一些版本中，程序员很懒，没有检查存储输入字符的数组是否足够大和是否能够容纳用户输入。所以这个蠕虫有针对性地使用536个字节去填充512字节的数组。超出的24个字节会覆盖一个返回地址，攻击者知道这个返回地址恰好在数组之后。当那个方法调用完成之后，并没有返回它的调用者，而是返回到蠕虫提供的一段代码（见图）。那段代码以和finger同样的超级用户权限运行，允许蠕虫获得远程系统的入口。如果编写finger的程序员认真负责的话，这种特定的攻击是不可能成功的。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06486.jpeg)

一个“缓冲区溢出”攻击

和C一样，在Python中所有程序员必须非常注意不要超过序列的边界。然而，在Python中这样的错误会引发一个运行时异常，而不会破坏列表之外的内存。

有人可能会深入思考是什么让病毒作者花费数周的时间来计划破坏数千台计算机并使它们无法工作这样的反社会行为。看起来进入计算机完全是作者的意图，但是使得计算机无法工作是一个bug，是由连续的重复感染导致的。莫尔斯被判3年缓刑，400小时社区服务，和10 000美元罚款。

近些年来，计算机攻击不断加强，并且动机也越来越险恶。不再是使得计算机无法工作，病毒往往会偷取财务数据或者使用被攻击的计算机发送垃圾邮件。悲催的是，因为程序代码写得很糟糕以至于很容易受到缓冲区溢出错误的影响，很多这样的攻击仍然能够成功。