   

## 4.7　嵌套循环

在3.3节中，介绍了如何嵌套两个if语句。类似地，复杂的迭代有时候需要嵌套循环：一个循环语句包含另外一个循环。在处理表格时，很自然会使用到嵌套循环。外循环迭代表格的所有行，内循环处理当前行的所有列。

在本节中，你会学习到如何打印一个表格。为了简单，我们会打印x的幂xn，如表所示。

下面是打印这个表格的伪代码

![](../Images/image05986.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05987.jpeg)

你如何打印表格的一行呢？这需要为每个指数打印一个值，需要第二个循环。

![](../Images/image05988.gif)

这个循环必须放在前面的循环内部。我们说内循环是嵌套在外循环里面的。

外循环需要打印10行。对于每个x程序在内循环中打印4列（见图4-5）。这样，一共会打印输出10×4=40个值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05989.jpeg)

图4-5　嵌套循环的流程图

在这个程序中，我们想在同一行显示多个输出语句的结果。这通过调用print函数时增加参数end=””来实现（见专题4.3）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05990.jpeg)

电子时钟上小时和分钟的显示就是嵌套循环的例子。小时循环12次，对于每个小时，分钟循环60次  

下面是完整的程序。注意我们还使用循环打印了表头，不过这个循环并不是嵌套的。

ch04/sec07/powertable.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05991.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05992.jpeg)

程序运行

![](../Images/image05993.gif)

自测题

30.为什么在内循环中禁用换行（使用end=””）而在外循环中不这样做？

31.如果要显示从x0到x5的所有幂，应如何修改程序？

32.如果按照自测题31的要求修改程序，一共会显示多少个值？

33.下面的嵌套循环会显示什么？

![](../Images/image05994.gif)

34.编写嵌套循环生成下面模式的括号：

![](../Images/image05995.gif)

练习它　现在你可以尝试本章最后的练习：R4.26，P4.18，P4.22。

表4-3展示了嵌套循环的例子。

表4-3　嵌套循环的例子

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05996.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05997.jpeg)

专题4.3　print函数的特殊形式

Python提供了print函数的一种特殊形式可以在输出完参数之后不换行。

![](../Images/image05998.gif)

例如，下面两个语句

![](../Images/image05999.gif)

的输出是一行

![](../Images/image06000.gif)

通过在第一个print函数中包含最后一个参数end=””，我们表示显示在第一个参数之后会输出一个空字符串而不是另起一行。下一个print函数在同一行中前面的print函数停止的地方开始输出。

参数end=””称作具名参数。具名参数允许你为函数或方法中定义的特定可选参数指定内容。尽管具名参数可以用在很多Python内置函数和方法中，我们在本书中限制在print函数中使用。

编程实战4.1　平均考试成绩

问题描述　重复读取和处理多组值是很常见的操作。编写一个程序用来计算多个学生的平均考试成绩。每个学生具有同样数量的考试成绩。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　理解问题。

为了计算一个学生的平均考试成绩，我们必须输入记录那个学生的所有成绩。这可以使用一个循环来完成。但是我们需要计算多个学生的平均考试成绩。这样的话，单个学生平均成绩的计算就必须被重复。这需要一个嵌套的循环，内循环处理一个学生的成绩，外循环为每个学生重复这个过程。

![](../Images/image06001.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　计算一个学生的平均成绩。

4.5.1节的算法可以用来提取成绩和计算平均值。然而，本问题中不同的是，对于每个学生我们可以读取固定数量的成绩，而不是在输入警戒值之前一直读。因为我们知道需要读取多少个成绩，那就可以使用带有range函数的循环：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06002.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　为每个学生重复这个过程。

因为我们要计算多个学生的平均考试成绩，那就必须为每个学生重复第2步中的任务。因为我们不知道有多少个学生，需要使用带有警戒值的while循环。但是应该使用什么作为警戒值呢？为了简单，可以通过一个简单的是或否的问题来解决。用户输入完一个学生的成绩之后，我们可以提示用户是否需要继续输入另一个学生的成绩：

![](../Images/image06003.gif)

否定的输入作为结束条件。这样的话，每次在遇到提示时用户输入”Y”，循环就会再次执行。

我们使用moreGrades==“Y”作为循环条件，并且初始化循环变量为字符串”Y”。这样允许循环至少执行一次，用户可以为第一个学生输入成绩，然后程序再提示输入是或否。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06004.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　使用Python实现你的解决方案。

下面是完整的程序：

ch04/worked_example_1/examaverages.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06005.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06006.jpeg)

编程实战4.2　成绩分布直方图

问题描述　直方图用来显示数据在固定数量的类别之间的分布。直方图本质上就是柱状图，每个柱的高度表示该类别中项目的数量。你的任务是构造一个直方图来可视化一个班级中字母等级的分布，使用工具箱3.2中描述的绘图包。成绩是以数字值进行输入的，必须转换为相应的字母等级。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06007.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　初始化等级计数器。

为了构建直方图，我们必须首先记录每个字母等级中学生的数量。这需要5个计数器，每个对应一个字母等级。

![](../Images/image06008.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　读取和处理成绩。

成绩是0到100之间的数字值。这些成绩需要一个一个进行读取，使用带警戒值的while循环，就像4.3节描述的那样。读取每个数字成绩之后，必须确定相应的字母等级并且更新相应等级的计数器。为了确定字母等级，我们使用传统的分级范围：A：grade≥90，B：80≤grade<；90，C：70≤grade<；80，D：60≤grade<；70，F：grade<；60。

![](../Images/image06009.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　构建图。

读取和处理完成绩之后，我们就可以构建柱状图了。每个柱的高度表示给定字母等级的数量。

![](../Images/image06010.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　格式化图。

每个柱都增加到图中之后，我们还需要为每个轴设置合适的标签。

![](../Images/image06011.gif)

为了帮助观察者确定输入的学生的总数，给图增加标题来提供这样的信息：

![](../Images/image06012.gif)

最后，默认的x值对于描述单个柱来说并不是很有帮助，所以我们修改一下使得与字母等级相匹配。

![](../Images/image06013.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　使用Python实现你的解决方案。

下面是完整的程序：

Ch04/worked_example_2/histogram.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06014.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06015.jpeg)