   

## 4.2　问题解决：手工跟踪

在编程小提示3.2中，你学习到了手工跟踪的方法。在手工跟踪代码或伪代码时，你在一张纸上写下变量的名字，在脑子里执行代码的每一步，并更新变量的值。

最好把代码写在或打印在一张纸上。使用一个回形针之类的东西来标记当前行。只要变量的值发生了改变，划掉旧的值并且在下面写上新的值。程序产生输出时，也在另一个列写下输出。

看下面的例子，会显示什么值？

![](../Images/image05899.gif)

有3个变量：n、total和digit。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05900.jpeg)

在进入循环之前，前两个变量被初始化为1729和0。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05901.jpeg)

因为n大于0，进入循环。变量digit被设置为9（1729除以10的余数）。变量total被设置为0+9=9。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05902.jpeg)

最后，n变成172。（回顾运算符用法，除法1729//10的余数被丢弃，因为运算符//执行的是向下取整的除法。）

把旧的值划掉，并在旧值下面写出新的值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05903.jpeg)

现在再次检查循环条件。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05904.jpeg)

因为n仍大于0，重复循环。现在digit变成2，total被设置为9+2=11，n被设置为17。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05905.jpeg)

再次重做循环，设置digit为7，total为11+7=18，n为1。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05906.jpeg)

最后一次进入循环，现在digit被设置为1，total为19，n变为0。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05907.jpeg)

条件n>；0现在不成立，继续循环后面的语句。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05908.jpeg)

这是一个输出语句，输出的是变量total的值，也就是19。

当然，你只需要运行一下代码也可以得到同样的答案。然而，手工跟踪可以让你有更深刻的认识，这可能是你简单地运行代码无法得到的。再次思考在每次迭代中发生了什么：

·提取n的最后一位数。

·把那位数字加到total上。

·删除n的最后一位。

换句话说，上面的循环用来计算n的各位数字之和。你现在知道这个循环对任意值n做了什么，而不仅仅是例子中的数字。（为什么会有人需要计算各位数字之和呢？这样的操作对于检查信用卡号码或其他形式的ID号码的有效性是非常有用的——见练习P4.35。）

手工跟踪不仅能够帮你理解正常工作的代码，它还是发现代码中错误的一个强有力技术。如果程序行为与预期不相符，拿出一张纸，在脑子里单步调试代码时跟踪这些变量的值。

你在手工跟踪时不需要可工作的程序，可以直接手工跟踪伪代码。实际上，在费劲把伪代码翻译成实际代码之前对伪代码进行手工跟踪，是个非常棒的想法，可以确认它是否可以正确工作。

自测题

6.手工跟踪下面的代码，给出n的值和输出结果。

![](../Images/image05909.gif)

7.手工跟踪下面的代码，给出n的值和输出结果。

![](../Images/image05910.gif)

8.手工跟踪下面的代码，假设a的值为2并且n的值为4。然后解释对于任意值a和n，代码做了什么。

![](../Images/image05911.gif)

9.手工跟踪下面的代码，你能发现什么错误？

![](../Images/image05912.gif)

10.下面的伪代码用来统计数字n有多少位数字：

![](../Images/image05913.gif)

手工跟踪上面的伪代码，跟别使用n=123和n=100。你能发现什么错误？

练习它　现在你可以尝试本章最后的练习：R4.3，R4.6。