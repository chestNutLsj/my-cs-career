   

## 5.7　问题解决：逐步提炼

解决问题时最强有力的策略之一就是逐步提炼。为了解决一个困难的任务，把它分解成简单一些的任务。然后把这些简单的任务继续分解为更简单的任务，直到所有任务你都知道如何解决。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06288.jpeg)

一个生产过程被分解为装配步骤的序列

现在把这个过程应用到日常生活中的一个问题。你早上起床并且必须喝咖啡。如何才能喝到咖啡呢？你会尝试让另外一个人，例如你的妈妈或配偶，帮你拿过来。如果不能的话，你必须做咖啡。你如何煮咖啡呢？如果有可用的速溶咖啡，你可以做速溶咖啡。你如何做速溶咖啡呢？很简单，把水烧开，然后把开水和速溶咖啡混到一起就可以了。你如何把水烧开呢？如果你有微波炉的话，就把杯子里灌上水，然后放到微波炉中加热3分钟。否则的话，你就在壶里灌上水然后在炉子上加热，直到水沸腾为止。

另一方面，如果你没有速溶咖啡，你就必须煮咖啡。如何煮咖啡呢？你在咖啡壶里灌上水，放上过滤器，研磨咖啡，把咖啡放进过滤器，然后打开咖啡壶的电源。如何研磨咖啡呢？把咖啡豆放进研磨机，按下按钮，等待60秒。

图5-5显示一个咖啡制作方案的流程图。提炼的部分被显示为扩展框。在Python中，你把提炼出来的内容实现为一个函数。例如，函数brewCoffee会调用grindCoffee，而brewCoffee又会被函数makeCoffee所调用。

让我们把逐步提炼的过程应用到一个编程问题。在打印支票时，习惯上会把支票数额同时写成数字（“$274.15”）和文本字符串（“Two hundred seventy four dollars and 15 cents”）。这样做可以防止支票接收者在数额的前面加一些数字。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06289.jpeg)

图5-5　咖啡制作方案的流程图

对于人类而言，这并不是很难，但是计算机如何完成这样的任务呢？没有内置函数可以把274转换成”two hundred seventy four”。我们需要编写这样的函数。下面是我们想编写的函数的描述：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06290.jpeg)

这个函数如何完成任务呢？首先考虑一个简单的情况。如果数字介于1和9之间，我们需要计算”one”……“nine”。实际上，我们对于百位需要进行同样的计算（two hundred）。在你需要做一个事情多于一次的任何时候，将其转换为函数都是一个好主意。先不编写整个函数，而是只写注释：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06291.jpeg)

![](../Images/image06292.gif)

10和19之间的数字属于特例。让我们编写一个独立的函数teenName用来把这些数字转换成字符串”eleven”、“twelve”、“thirteen”，等等：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06293.jpeg)

接下来，假设数字介于20到99之间。这样一个数字的名字包含两部分，例如”seventy four”。我们需要一个方法得到第一部分：”twenty”，”thirty”，等等。再一次，我们会把那个计算放进一个独立的函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06294.jpeg)

现在让我们把函数intName的伪代码写出来。如果数字介于100和999之间，那么我们显示一位数字和单词”hundred”（例如”two hundred”）。然后把百位去掉，例如，把274变成74。接下来，假设剩余部分至少为20并且至多为99。如果这个数字能被10整除，我们使用tensName任务完成。否则，我们使用tensName输出十位上的数字（例如”seventy”）并去掉十位上的数字，把74变成4。在一个独立的分支中，我们处理介于10和19之间的数字。最终，我们输出剩余的个位数（例如”four”）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06295.jpeg)

把上面的伪代码转换成Python程序是很直观的，转换结果参见本节末尾的源码列表。

注意我们是如何依赖辅助函数来完成大部分细节工作的。使用逐步提炼的过程，我们现在需要考虑这些辅助函数了。

让我们从digitName函数开始，这个函数简单到不需要伪代码就可以直接实现。使用带有9个分支的if语句就可以：

![](../Images/image06296.gif)

函数teenName和tensName也是类似的。

上面总结了逐步提炼的过程。下面给出完整的程序：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06297.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06298.jpeg)

程序运行结果

![](../Images/image06299.gif)

自测题

25.解释一下你如何改进intName函数使得它可以处理最大到9999的参数。

26.第26行为什么要设置part=0？

27.调用intName(0)会发生什么？你如何修改intName函数才能使它正确处理这种情况？

28.跟踪函数调用intName(72)，就像编程小提示5.4中描述的那样。

29.使用逐步提炼的过程，把输出下面表格的任务分解为更简单的任务。

![](../Images/image06300.gif)

练习它　现在你可以尝试本章最后的练习：R5.11，P5.11，P5.23。

编程小提示5.3　函数宜短

编写函数是有一定代价的。你需要设计、编码和测试这个函数。函数需要文档化，你需要花费一些精力让函数可复用而不是捆绑到特定的上下文。为了避免这些开销，一般会把越来越多的代码塞进一个地方而不是多花一些心思拆分成独立的函数。没有经验的程序员会写出包含几百行代码的函数，这是非常常见的情况。

作为首要原则，如果一个函数的代码在你的开发环境中一屏放不下，那很可能应该拆分成多个函数。

编程小提示5.4　跟踪函数

在设计一个复杂函数时，把程序交给计算机之前先手工模拟一遍是个好主意。

拿一个索引卡，或者一张纸，写下你想研究的函数调用。写上函数的名字以及形参变量的名字和值，就像这样：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06301.jpeg)

然后，写上函数中变量的名字和初始值。把它们写在表格里，因为在模拟代码执行时会更新它们。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06302.jpeg)

我们进入测试part>；=100。part//100是4，part%100是16。digitName(4)很容易知道是”four”。（如果digitName函数非常复杂的话，你可能需要在另外一张纸上模拟那个函数调用。在这样的方式中用掉好几张纸是很正常的。）

现在，name已经被改成了name+““+digitName(part//100)+“hundred”，也就是”four hundred”，然后part被改成了part%100，或者16。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06303.jpeg)

现在你进入了分支part>；=10，teenName(16)是sixteen，所以变量的值为

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06304.jpeg)

现在，第26行为什么要把part设置为0就很显然了。否则的话，你会进入下一个分支，结果会变成”four hundred sixteen six”。跟踪代码是理解函数细节的有效方法。

编程小提示5.5　插桩

在编写更大的程序时，并不总是能够一次性实现和测试所有函数。你通常需要测试一个需要调用另外一个函数的函数，而另一个函数还没有实现。这时你可以使用一个桩临时替代一下缺少的函数。桩是这样一个函数，它返回一个足够用来测试另一个函数的简单值。下面是桩函数的例子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06305.jpeg)

如果你使用intName函数组合这些桩函数并使用参数274进行测试，会得到结果

”mumble hundred mumblety mumble”，这表示intName函数的基本逻辑是可以正确工作的。

编程实战5.2　计算考试成绩

问题描述　学习某课程的学生参加4个考试，然后每次考试都会得到一个字母成绩（A+、A、A-、B+、B、B-、C+、C、C-、D+、D、D-或者E）。去掉一个最低成绩然后对剩余的3个成绩计算平均值得到课程成绩。为了计算平均值，需要首先把字母成绩转换为数字成绩，使用一般方案A+=4.3，A=4.0，A-=3.7，B+=3.3，……，D-=0.7，F=0。然后计算它们的平均值再转换成最接近的字母成绩。例如，平均值3.51的话可以得到A-。

你的任务是读取4个字母成绩，每行一个。

![](../Images/image06306.gif)

例如，

![](../Images/image06307.gif)

对于每个4行输入的序列，你的输出应该是该课程的一个字母成绩，就像刚刚描述的一样。例如，A-。

可以为letterGrade1输入Q来表示输入的结束。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第1步　执行逐步提炼。

我们会使用逐步提炼的过程。为了处理输入，我们可以分别处理每一行。因此，我们定义一个任务Process line。

为了处理一行，我们读取第一个成绩并检查，如果是字母Q就退出。否则的话，就读取4个成绩。因为我们需要它们的数字形式，我们定义一个任务Convert letter grade to number。

这样我们就有了4个数字，现在需要找出最小的一个。那是另外一个任务，Find smallest of four numbers。为了计算剩余成绩的平均值，我们需要计算所有值的和，减去最小的值，再除以3。我们认为没必要再分解为子任务了。

接下来，我们把结果转换回去成为字母成绩。那是另外一个子任务Convert number grade to letter。最后，我们输出字母成绩。那同样很简单，不需要子任务。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第2步　把字母成绩转换为数字。

如何把一个字母成绩转换为数字呢？使用下面的算法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06308.jpeg)

下面是用来实现这个任务的函数

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06309.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第3步　把数字成绩转换为字母。

如何执行相反的转换呢？这里的挑战在于我们需要转换为最相近的字母成绩。例如，如果x表示数字成绩，那么

![](../Images/image06310.gif)

我们可以编写一个具有13个分支的函数，每个分支对应于一个合法的字母成绩。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06311.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第4步　查找4个数字中的最小值。

最后，如何查找4个数字的最小值呢？Python提供了min函数可以接收多个值作为参数并且返回那些值的最小值。例如：

![](../Images/image06312.gif)

会把2赋值给变量result。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第5步　处理一行输入。

如前所述，为了处理一行，执行下面的步骤：

![](../Images/image06313.gif)

然而，如果我们读取第一个输入字符串并且发现Q，就需要通知调用者输入已经结束并且不能再调用。

我们的函数会返回一个布尔值，False表示成功，True表示遇到了警戒值（原文中此处描述错误。——译者注）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06314.jpeg)

![](../Images/image06315.gif)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image05174.jpeg)第6步　编写main函数。

现在，main函数就水到渠成了。当函数processLine返回False时就一直调用它（原文为返回True时一直调用，与代码不符。——译者注）。

![](../Images/image06316.gif)

把所有函数写入单个Python文件，在源码ch05/worked_example_2/grades.py中可以查看完整程序。

编程实战5.3　使用调试器

到目前为止，你肯定已经意识到了，计算机程序很少能第一次就顺利执行。有时，在由程序员调用时，试图发现错误或bug是非常痛苦的一件事。当然，你可以在代码中插入print语句来显示执行流程和关键变量的值。然后运行程序并试图分析输出。但是如果输出并不能准确指出问题所在，你需要增加和删除print语句并反复执行程序。这是一个非常耗时的过程。

现代开发环境都有一个调试器，能够让你跟踪程序执行并帮你定位bug的一个程序。你可以停止和重启程序并在程序临时停止时观察变量的内容。每次停止时，你可以决定下一次停止前程序执行多少步。

Python调试器

正如编译器一样，不同系统之间的调试器也有很大区别。大部分集成环境的调试器具有类似的布局——见图5-6。你必须清楚如何准备一个用来调试的程序，以及如何在你的系统上启动调试器。对于大多数开发环境而言，你可以简单地单击菜单来构建用来调试的程序并启动调试器。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06317.jpeg)

图5-6　Spyder、PyDev和PyCharm的调试器

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06318.jpeg)

图5-6　（续）

调试器要点

启动调试器之后，你可以使用设置断点（set breakpoint）、运行至断点（run until breakpoint）、步过（step over）和步入（step into）这4个调试命令完成很多调试任务。对于不同的调试器，这些命令的名字和按键或鼠标操作方式略有不同，但是所有的调试器都会支持这些基本的命令。

启动调试器时，它会全速运行直到遇到一个断点，然后停止执行。包含断点并导致停止的那一行代码会被显示出来，但是暂时还没有执行这一行。

现在你可以观察变量并逐行执行程序，或者全速运行程序直到遇到下一个断点。程序结束时，调试器也同时停止。

运行至断点可以让你更快地到达那儿，但是你无法知道这个过程中程序做了什么。为了更好地理解程序流，你可以逐行执行程序。一个通常叫作“step into”的命令会进入函数调用的内部，另一个叫作“step over”的命令会跳过函数调用。如果你想要检查函数是否正常工作就应该进入函数，如果你确定函数可以正常工作就应该跳过它。

最后，当程序结束运行时，调试会话也结束了。如果想再次运行程序，你需要启动另一个调试会话。

调试器对于发现和移除程序中的bug是非常有用的工具。然而，好的设计和良好的编程习惯更加重要。如果调试器没有发现任何错误，这并不意味着你的程序没有bug。测试和调试只能用来显示bug的存在，而不是证明不存在bug。

调试练习

下面是一个用来练习使用调试器的简单程序，用来计算小于n的所有素数。（如果一个整数除1和自身之外不能被其他数字整除，就称作素数。另外，数学家发现不把1看作素数会很方便。这样的话，前几个素数是2、3、5、7、11、13、17、19。）

ch05/worked_example_3/primes.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06319.jpeg)

运行这个程序并输入10时，输出是

![](../Images/image06320.gif)

结果并不是很正确，似乎只是简单地输出了所有奇数。让我们使用调试器来确定到底错在哪里。

首先，在第7行设置一个断点。对于大多数调试器，右键单击或者左键双击这一行就可以完成。然后选择菜单项来启动调试。这时，程序会停止并接收一个值给变量n，输入10，程序继续执行并在断点处停止。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06321.jpeg)

现在我们很奇怪为什么程序把1当作素数，把鼠标放到“step over”和“step into”命令的位置。对于Spyder调试器，它们的样子如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06322.jpeg)

进入isprime函数。执行几次“step over”命令，直到到达while循环。你会注意到程序跳过了两个if语句。看一下变量的值。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06323.jpeg)

如你所见，n的值是1，因为现在正在测试1是否为素数。if语句被跳过是因为它们处理偶数。然后k被设置为3。

继续单步执行，你会注意到while循环被跳过，因为k*k不小于n。然后isprime函数返回True，这里是一个bug。看起来这个函数需要重写一下并把1当作特例处理。

接下来，我们会知道为什么程序不输出2作为素数，即使isprime函数认为2是素数。继续调试，它会停在第7行的断点位置，注意i是3。现在就清晰了。main函数中的循环只测试奇数。修改程序，或者main函数同时测试奇数和偶数，或者更好一些把2当作特例处理。

最后，我们还要查找程序认为9是素数的原因。继续调试，直到i=9时到达断点。进入isprime函数，然后重复使用“step over”命令。两个if语句被跳过，因为9是奇数，所以这是正确的。程序有一次跳过了while循环。让我们观察k的值来查找原因。现在k是3，而while循环的条件是测试是否k*k<；n。现在k*k的值是9并且n也是9，所以测试失败。

检查一个整数是否为素数时，只需要检查![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06324.jpeg)之内的除数即可。如果n可以分解为p×q，那么两个因数不可能都大于![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06324.jpeg)。不过，实际上这样说也不是完全准确。如果n恰好是一个素数的平方，那么它的唯一非平凡因子就是![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06324.jpeg)。9=3×3就恰好是这样一个例子我们应该测试k*k≤n。

通过运行调试器，我们在程序中发现了3个bug：

1.函数isprime错误地认为1是素数。

2.函数main没有测试2。

3.在函数isprime中存在“差一”错误，while语句的条件应该是k*k≤n。

下面是改进后的程序：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06325.jpeg)

我们现在的程序不存在bug了吗？这不是调试器能够回答的问题。记住，测试只能证明bug的存在，而无法证明它们不存在。