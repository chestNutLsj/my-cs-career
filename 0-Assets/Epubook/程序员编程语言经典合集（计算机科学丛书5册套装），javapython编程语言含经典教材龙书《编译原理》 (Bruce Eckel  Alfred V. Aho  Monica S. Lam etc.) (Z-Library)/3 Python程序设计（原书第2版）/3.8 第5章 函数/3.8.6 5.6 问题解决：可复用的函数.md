   

## 5.6　问题解决：可复用的函数

你已经使用过很多Python函数了，既有内置函数也有标准库函数。这些函数是作为Python的一部分提供的，所以程序员不需要创建就可以使用。当然，Python标准库无法覆盖每个可能的需要。通过设计可以解决多个问题的函数，你会节省很多时间。

不管是在同一个程序中还是在互相独立的程序中，如果要写很多次几乎一样的代码或伪代码，就应该考虑引入一个函数。下面是一个代码重复的典型例子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06272.jpeg)

这个程序段读取两个变量，确保每个都在特定的范围之内。很容易提炼共同的行为然后放到一个函数中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06273.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06274.jpeg)

然后使用这个函数两次：

![](../Images/image06275.gif)

我们现在已经删除了循环中的重复代码——只在函数中出现一次。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06276.jpeg)

这些房子都是由独立的建筑工人建造的。类似地，程序员使用函数来多次完成同样的任务，而不是复制代码  

注意，这个函数可以在需要读取整数值的其他程序中重复使用。然而，我们应该考虑到最小值不是0的可能性。

下面是一个更好的替代方案：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06277.jpeg)

在我们的程序中，我们调用

![](../Images/image06278.gif)

另外一个程序可以调用

![](../Images/image06279.gif)

一般地，你会为函数复用时会变化的数值提供形参变量。下面是一个演示readIntBetween函数用法的完整程序。

ch05/sec06/readtime.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06280.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06281.jpeg)

程序运行结果

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06282.jpeg)

自测题

20.考虑下面的语句：

![](../Images/image06283.gif)

编写一个函数来减少代码的重复。

21.考虑在页面左侧或右侧打印页码的函数：

![](../Images/image06284.gif)

编写一个返回布尔值的函数使得if语句中的条件更容易理解。

22.下面的函数计算初始金额为10 000美元并且利率为5%的复利：

![](../Images/image06285.gif)

你如何让这个函数更方便复用？

23.下面代码中的注释解释了循环是用来做什么的，使用函数进行改写。

![](../Images/image06286.gif)

24.在自测题23中，要求编写一个统计空格数量的函数。你如何对那个函数进行通用化，使得可以统计任意字符的数量？你为什么会想这样做呢？

练习它　现在你可以尝试本章最后的练习：R5.8，P5.21。

计算与社会5.1　个人计算

1971年，英特尔公司的工程师Marcian E.Ted Hoff正在为一家电子计算器生产商设计芯片。他意识到，开发一个可以通过编程与按键和计算器显示屏交互的通用芯片更有意义，而不是做另一个定制任务的芯片。由此，微处理器诞生了。在当时，它的主要应用是作为计算器、洗衣机或类似产品的控制器。计算机产业花费了很多年才注意到真正的中央处理器是可以在单个芯片上实现的。

爱好者总是走在前面的。1974年，第一个微型计算机Altair 8800在MITS电子公司上市，售价350美元。这款微型计算机包含一个微处理器、一个电路板、一个很小的内存、一些开关和一行显示灯。购买者必须进行焊接和组装，然后通过开关使用机器语言把程序编写进去。这在当时并没有流行起来。第一个红极一时的是苹果II，这是带有键盘、监视器和软盘驱动器的真正意义上的计算机。苹果II最初发行时售价3000美元，能够玩游戏Space Invaders，可以运行简单的记账程序，或者用户可以使用BASIC对其编程。最初的苹果II不支持小写字母，这使得它无法进行文字处理。比较大的突破是1979年推出的带有新的电子表格程序VisiCalc的计算机。在电子表格中，你在行、列表格中输入金融数据和它们的关系（见下图），然后修改其中一些数据并实时观察其他数据如何变化。例如，你可以发现在制造厂中修改小部件的混合如何影响预期成本和收益。公司经理大量抢购VisiCalc和运行这个程序所需要的计算机。对他们而言，计算机就是电子表格机器。更重要的是，它是一台个人设备。经理们可以自由地执行他们想进行的计算，而不仅仅是数据中心的“主教”提供的那些。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image06287.jpeg)

在苹果Ⅱ上运行的VisCalc电子表格

个人计算机从此开始伴随着我们，并且有无数人修改他们的硬件和软件，有时候创立了非常成功的公司，或者开发了数百万用户可以使用的免费软件。“自由修改”是个人计算的重要组成部分。在个人设备上，你应该可以安装任何你想安装的软件来使自己更加有生产力和创造力，即使那不是大多数人使用的同款软件。你应该可以安装自己选择的外部设备。对于个人计算的前30年，这个自由被认为是理所当然的。

我们正在进入一个智能电话、平板电脑和智能电视正在逐步替代原来个人计算机完成的功能的时代。在手机中能够执行比20世纪90年代最好的个人计算机还强大的计算能力，尽管令人惊讶，让人不安的是我们在一定程度上失去了个人控制的能力。在有些品牌的电话和平板电脑上，你只能安装生产商在“app商店”发布的那些应用程序。例如，苹果拒绝MIT为教育语言Scratch开发的iPad应用，因为它包含了一个虚拟机。你可能会认为鼓励下一代热衷于编程是符合苹果公司的利益的，但是为了阻止类似Flash或者Java这样的竞争环境，他们有一个拒绝在他们的设备上编程能力的通用策略。

在你选择打电话或者看电影的设备时，咨询一下谁有控制权是很值得的。你是正在购买可以在任何方式下都能使用的个人设备吗，或者你正在被限制到由别人控制的数据流中吗？