   

### 11.2.5　收集HTTP超链接的解析器

接下来我们开发另一个版本的LinkParser类，称之为Collector。它只收集HTTP URL，并将它们放入列表中，而不是输出它们。列表中的URL将是绝对URL，而不是相对URL格式。最后，要求该类支持方法getLinks()，返回该列表。

我们期望Collector解析器的示例用法如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09266.jpeg)

（同样，省略了许多输出行，它们都是绝对URL。）

要实现Collector，同样我们需要重载handle_starttag()。处理方法不是简单地输出开始标记中href属性的值（如果有的话），还必须处理属性值，以保证仅仅收集绝对的HTTP URL。

因此，针对待处理的每一个href值，处理方法需要执行下列操作：

1.把href值转换为绝对URL；

2.如果结果是一个HTTP URL，则附加到一个列表中。

为了实现第一步，处理方法必须获得传递给它的HTML文件的URL。因此，Collector解析器对象必须有一个实例变量存储URL。该URL必须以某种方式传递给Collector对象，我们选择将URL作为Collector构造函数输入参数的方法传递URL。

为了实现第二步，我们必须有一个list实例变量以存储所有的URL。在构造函数中必须初始化list。Collector类的完整实现代码如下：

模块：ch11.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09267.jpeg)

练习题11.3　扩展类Collector的功能，使得它可以收集所有的文本数据到一个字符串，可以使用方法getData()获得收集的文本数据。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09268.jpeg)

（仅仅显示了少数几个字符。）