   

### 11.3.1　正则表达式

如何识别文本文件中的电子邮件地址？我们通常不觉得这很难。我们理解电子邮件地址遵循如下字符串模式：

电子邮件地址由用户ID（即一个“允许”的字符序列），后跟@符号，后跟一个主机名（即用英文句点分隔的“允许”的字符序列）。

虽然这个非正式的电子邮件地址的字符串模式描述可能对我们有用，但是它不够精确，不足以在程序中使用。

计算机科学家已经开发出一种更正式的方法来描述字符串模式：正则表达式。正则表达式是由字符和正则表达式运算符组成的字符串。我们现在将学习其中的一些运算符，以及它们如何使我们能够精确地定义所需的字符串模式。

最简单的正则表达式是不使用任何正则表达式运算符的表达式。例如，正则表达式best只匹配一个字符串，字符串'best'：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09269.jpeg)

运算符.（英文句点）是一种通配字符：它匹配除换行符（'\n'）意外的任意Unicode字符。因此，'be.t'匹配best，同事还匹配'belt'、'beet'、'be3t'和'be!t'，等等：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09270.jpeg)

注意，正则表达式be.t不匹配字符串'bet'，因为运算符'.'必须匹配一个字符。

正则表达式运算符*、+ 和? 匹配前一个字符（或正则表达式）的特定重复次数。例如，正则表达式be*t中的运算符*与前一个字符（e）的0次或多次重复匹配。因此，它匹配bt，也匹配bet、beet等：  

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09271.jpeg)

上一个例子还说明运算符+匹配前一个字符（或正则表达式）的一次或多次重复，而?匹配0次或1次重复。

运算符[]匹配方括号中列出的任意一个字符。例如，正则表达式[abc]匹配字符串a、b和c，但不匹配其他字符串。在运算符[]中使用运算符-时，指定字符的范围。此范围由Unicode字符排序指定。所以正则表达式[l-o]匹配字符串l、m、n和o。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09272.jpeg)

为了匹配不在给定范围或者不在指定集合的一组字符，可以使用插入字符^。例如，[ ^ 0-9 ]匹配任何不是数字的字符：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09273.jpeg)

运算符|是“或”运算符：如果A和B是两个正则表达式，则A|B匹配任何A或B匹配的字符串。例如，正则表达式hello|Hello匹配字符串'hello'和'Hello':

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09274.jpeg)

我们刚刚讨论的运算符总结在表11-2。

知识拓展：其他正则表达式运算符

Python支持更多的正则表达式运算符。在这一节中，我们只触及了表面。要了解更多关于正则表达式运算符的知识，请阅读大量的在线文档：

[http://docs.python.org/py3k/howto/regex.html](http://docs.python.org/py3k/howto/regex.html)  

以及

[http://docs.python.org/py3k/library/re.html](http://docs.python.org/py3k/library/re.html)  

练习题11.4　下列列表中给出了一个正则表达式和若干字符串。请选择与正则表达式匹配的字符串。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09275.jpeg)

表11-2　正则表达式运算符。运算符.、*、?作用于正则表达式中该运算符的前一个项。运算符|作用于正则表达式中该运算符的左右两个项

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09276.jpeg)

由于运算符*、.、和[在正则表达式中有特殊含义，因此它们不能用来匹配字符'*'，'.'，或'['。为了匹配有特殊含义的字符，必须使用转义序列\。因此，例如正则表达式\*\[将匹配字符串'*['。除了可以作为转义字符，反斜杠（\）还可以表示正则表达式特殊序列。正则表达式特殊序列表示常用的预定义字符集。表11-3列举了一些常用的正则表达式特殊序列。

表11-3　特殊的正则表达式序列。注意，表中的转义序列仅用于正则表达式中，它们不能用于一个任意的字符串中

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09277.jpeg)

练习题11.5　为下列每个非正式模式描述或者一组字符串定义一个正则表达式，要求仅仅匹配模式描述或者匹配字符串集合中所有字符串。

（a）aac，abc，acc

（b）abc，xyz

（c）a，ab，abb，abbb，abbbb，…

（d）包含字母表（a，b，c，…，z）中小写字母的非空字符串

（e）包含子字符串oe的子字符串

（f）表示HTML开始或结束标记的字符串