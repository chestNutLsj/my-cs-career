   

### 5.5.1　循环模式：序列循环

有些问题，特别是来自科学、工程学和金融学的问题，可以通过生成一系列最终达到期望数值的数字来解决。我们以著名的斐波那契数列来说明这种模式：

1.1,2,3,5,8,13,21,34,55,89,…

斐波那契数列是从整数1和1开始的，随后的数字满足如下规则：序列中的当前数是序列中前两个数字之和。

拓展知识：斐波那契数列

斐波那契数列是以比萨的列奥纳多（他被称为斐波那契）命名的，他把斐波那契数列引入了西方世界。这个序列在印度数学家中早就知道了。

斐波那契开发该序列作为一个理想化的兔子种群增长的模型。他认为（1）兔子能在一个月大的时候交配，（2）小兔子出生需要一个月的时间。在第i个月的月末兔子对的数目可以用第i个斐波那契数描述如下：

·最初，在第1个月的开始，只有一对兔子。

·在第1个月的月末，第1对兔子交配但还是只有1对兔子。

·在第2个月的月末，第1对兔子产下了一对兔子，并继续交配，因此有2对兔子。

·在第3个月的月末，第1对兔子又产下了一对兔子，并继续交配。第2对兔子交配但还没有产下后代。现在有3对兔子。

·在第4个月的月末，第1对兔子和第2对兔子分别产下一对兔子，因此有5对兔子。

一个自然的问题是计算第i个斐波那契数。本章最后的思考题5.32要求读者完成该任务。现在我们要解决一个稍微不同的问题。我们希望计算第一个大于给定整数大小的斐波那契数。我们将通过生成斐波那契数列来完成这项工作，当我们到达一个大于所限定边界的数时，就停止。因此，假如当前的斐波那契数是current，则while循环条件是：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08432.jpeg)

如果条件为真，则需要计算下一个斐波那契数，换言之，计算current的下一个值。为了计算，必须保留current之前的斐波那契数。因此，除了当前斐波那契数的变量current之外，我们需要另一个变量，例如previous。在while循环之前，我们把previous和current初始化为第1个和第2个斐波那契数：

模块：ch5.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08433.jpeg)

注意，使用系列解包赋值语句来计算下一个current和previous的值。

在函数fibonacci()中，使用循环语句来计算一个数值序列直到满足某种条件为止。我们称这类循环模式为序列循环模式。在下一个问题中，我们使用序列循环模式来求数学常数e（称之为欧拉常数）的近似值。

练习题5.11　众所周知，e的精确值等于下列无穷序列之和：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08434.jpeg)

无限之和是不可能计算的。通过计算无穷和中的前几个项之和，我们可以得到e的近似值。例如，![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08435.jpeg)是e的一个（糟糕的）近似。下一个计算和![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08436.jpeg)稍微好些，但还是比较差。下一个计算和![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08437.jpeg)则看起来更好。接下来的若干计算和则向正确的方向趋近：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08438.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08439.jpeg)

现在，因为![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08440.jpeg)，我们知道e4和实际的e值相差在范围![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08441.jpeg)之内。这给我们提供了一种计算e的近似值的方法，它保证近似值与e的真值的误差在给定范围之内。

编写一个函数approxE()，带一个浮点数error作为输入参数，返回误差在error范围内的常数e的近似值。可以通过生产系列近似值e0、e1、e2、…，直到当前的近似值与前一个近似值之间的误差不大于error。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08442.jpeg)