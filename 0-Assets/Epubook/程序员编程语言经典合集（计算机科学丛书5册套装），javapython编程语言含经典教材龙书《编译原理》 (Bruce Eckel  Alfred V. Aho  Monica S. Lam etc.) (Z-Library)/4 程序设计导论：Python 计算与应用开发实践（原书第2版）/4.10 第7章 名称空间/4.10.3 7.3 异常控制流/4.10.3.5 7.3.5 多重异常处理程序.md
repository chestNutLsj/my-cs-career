   

### 7.3.5　多重异常处理程序

try语句后可以紧跟多个except语句，每个except语句有自己的异常处理程序。我们使用如下的函数readAge()为例来说明。readAge()在一个try语句块中尝试打开一个文件，读取第一行内容，并将其转换为一个整数。

模块：ch7.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08704.jpeg)

执行函数readAge的try代码块时，可能会引发若干不同类型的异常。文件可能不存在：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08705.jpeg)

在这种情况下，执行try语句块的第一条语句时将抛出IOError。语句块中剩余的语句将被跳过，执行IOError异常处理程序。

另一种错误是文件age.txt的第一行不包含可以转换为一个整数值的内容：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08706.jpeg)

文件age.txt的第一行的内容是'fifteen\n'，因此尝试把它转换为一个整数时，会引发ValueError异常。关联的异常处理程序输出用户友好的提示信息，不中断程序。

最后一个except语句将捕获前两个except语句没有捕获的任何其他异常。

知识拓展：阿丽亚娜5火箭首飞

1996年6月4日，由欧洲航天局研发多年的阿丽亚娜5型火箭进行了首飞测试。发射后几秒钟，火箭爆炸了。

事故发生的根源是把一个浮点数转换到整数时引发了溢出异常。事故的原因并不是转换失败（事实证明，这并不重要）。真正的原因是没有进行异常处理。正因为如此，火箭控制软件崩溃了，并关闭了火箭电脑。没有了导航系统，火箭开始无法控制地转动，机载控制器使火箭自毁。

这可能是历史上最昂贵的电脑错误之一。

练习题7.3　为open()函数创建一个“包装器”函数safe-open()。调用open()来打开一个在当前工作目录不存在的文件时，会抛出一个异常：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08707.jpeg)

如果文件存在，则返回一个指向打开文件对象的引用：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08708.jpeg)

当使用safe-open()打开一个文件时，如果没有引发异常，则返回指向打开文件对象的引用，这和open()函数一致。如果尝试打开文件时引发了异常，则safe-open()返回None。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08709.jpeg)