   

### 7.4.3　模块搜索路径

现在我们来看看解释器是如何找到要导入的模块所对应的文件的。import语句只列出名称（模块的名称），没有任何目录信息或.py后缀。Python使用Python搜索路径来定位模块。搜索路径只是一个目录（文件夹）列表，Python将在其中寻找模块。标准库模块sys中定义的变量名称path指向此列表。因此，通过在shell中执行下面命令，可以查看（当前）搜索路径是什么：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08722.jpeg)

（我们忽略包含标准库模块的长目录列表。）模块搜索路径总是包含顶层模块的目录，我们将在下一节讨论，也包含标准库模块的目录。在每个导入语句中，Python将从左到右在该列表中的每个目录中搜索请求的模块。如果Python找不到模块，则引发一个ImportError异常。

例如，假设我们希望导入保存在主目录/Users/me（或其他任何保存example.py的目录）中的模块example.py：

模块：example.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08723.jpeg)

导入该模块之前，我们运行函数dir()，检查在命令行名称空间中定义了哪些名称：  

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08724.jpeg)

当不带参数调用函数dir()时，结果返回当前名称空间中的名称，在本例中为命令行名称空间。结果似乎只显示了定义的“记账”名称。（请读者阅读下一个有关名称__builtins__的拓展知识。）

现在，让我们尝试导入模块example.py：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08725.jpeg)

结果并不成功，因为sys.path列表中不存在目录/Users/me。因此让我们把它添加到列表中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08726.jpeg)

然后重试：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08727.jpeg)

运行成功。让我们再次运行dir()检查模块example是否成功导入：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08728.jpeg)

知识拓展：builtins

名称__builtins__指向builtins模块的名称空间，我们在图7-8中引用过。

builtins模块包含了所有的内置类型和函数，通常在启动Python时自动导入。使用dir()函数列出模块builtins的属性可以证明这一点：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08729.jpeg)

注意：使用dir(__builtins__)，而不是dir('__builtins__')。

练习题7.5　在sys.path中列举的路径之一中查找random模块，打开该模块，查找函数randrange()、random()和sample()的实现。然后导入该模块到解释器命令行，并使用dir()函数查看其属性。