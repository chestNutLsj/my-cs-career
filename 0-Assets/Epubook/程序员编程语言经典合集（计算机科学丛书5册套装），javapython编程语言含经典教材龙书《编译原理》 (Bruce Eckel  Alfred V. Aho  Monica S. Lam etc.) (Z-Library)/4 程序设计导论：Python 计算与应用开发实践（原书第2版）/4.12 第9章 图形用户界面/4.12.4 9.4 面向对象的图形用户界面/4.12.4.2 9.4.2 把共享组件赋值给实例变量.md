   

### 9.4.2　把共享组件赋值给实例变量

在下一个例子中，我们将GUI应用程序day.py重新实现为一个类。我们用它来说明何时给出组件实例变量名。原始程序day.py（同样省略了导入语句和注释语句）如下：

模块：day.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09051.jpeg)

在上述实现中，名称compute、label、dateEnt和button具有全局作用范围。我们重新实现该程序，采用类（称之为Day）的方式来封装这些名称和代码。

Day构造函数应该负责创建标签、输入框和按钮组件，正如ClickIt构造函数负责创建按钮组件一样。虽然有一处不同：输入框dateEnt被事件处理函数compute()引用。基于这个原因，dateEnt不能作为Day构造函数的局部变量。作为替代，我们把它作为一个实例变量，从而可以被事件处理函数引用：

模块：ch9.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09052.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09053.jpeg)

Label和Button组件则不需要赋值给实例变量，因为它们永远不会被事件处理函数引用。它们仅仅给定相对于构造函数的局部变量名称。事件处理函数compute()是一个类方法，正如ClickIt中的clicked()方法。事实上，在用户自定义组件中事件处理函数永远是类方法。

因此，类Day封装了程序day.py中的四个全局范围的名称。正如ClickIt类一样，把一个Day组件整合到一个GUI变得非常容易。为了说明这一点，让我们允许组合这两个自定义组件的GUI：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09054.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09055.jpeg)

图9-13　一个GUI中的两个用户自定义组件。一个用户自定义组件可以像一个内置组件类一样使用

图9-13显示了结果GUI，包括一个Day组件，位于一个ClickIt组件之上。

练习题9.8　重新实现GUI应用程序keylogger.py为一个新的用户自定义组件类。请确定是否需要把包含在该组件中的Text组件赋值给一个实例变量。