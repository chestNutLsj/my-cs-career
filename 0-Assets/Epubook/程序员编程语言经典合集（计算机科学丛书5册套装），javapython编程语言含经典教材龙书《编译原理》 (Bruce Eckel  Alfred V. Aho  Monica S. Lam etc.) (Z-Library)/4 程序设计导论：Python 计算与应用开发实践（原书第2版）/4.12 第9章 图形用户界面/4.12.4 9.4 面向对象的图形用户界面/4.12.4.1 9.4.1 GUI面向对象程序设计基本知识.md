   

### 9.4.1　GUI面向对象程序设计基本知识

为了说明GUI开发的面向对象程序设计方法，我们重新实现了应用程序clickit.py。这个应用程序是包含一个按钮的GUI。单击按钮时弹出一个窗口并显示当前时间。下面是我们的原始代码（导入语句和注释语句被删除，这样我们就可以专注于程序结构）：

模块：clickit.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09046.jpeg)

这个程序有一些不可取的特性。名称button和clicked具有全局范围。（我们忽略窗口组件root，实际上它“位于应用程序之外”，稍后我们将说明这一点。）而且，该程序也没有封装到一个单独的命名组件（函数或类）中，因而无法被简洁地引用或整合到一个更大的GUI中。

面向对象程序设计的GUI开发方法的核心思想是开发GUI应用程序作为一个新的用户自定义的组件类。组件是一个复杂的东西，从零开始实施一个组件类将是一个艰巨的任务。OOP的继承为此提供了挽救方法。只要继承一个现有组件类的属性，就可以确保我们的新类是一个组件类。因为我们的新类包含其他组件（按钮），所以它应该继承一个可以包含其他组件的组件类（也即Frame类）。

因此，重新实现GUI clickit.py包含定义一个新类（例如，ClickIt），作为Frame的子类。ClickIt类中仅应该包含一个按钮组件。由于按钮必须从GUI启动时就成为GUI的一部分，因此当ClickIt组件实例化时应该创建和布局按钮组件。这意味着必须在ClickIt构造函数中创建和布局按钮组件。

那么，按钮的父组件是什么？由于按钮包含在实例化的ClickIt组件中，因此按钮组件的父组件是ClickIt组件本身（self）。

最后，回顾一下，我们在创建一个组件时通常会指定其父组件。同样我们应该指定ClickIt组件的父组件，因此可以按下列方法创建GUI：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09047.jpeg)

因此，ClickIt构造函数应该定义为带一个参数：其父组件。（顺便说一下，这个代码显示了为什么我们没有把窗口组件root封装到ClickIt中。）

基于上述知识，我们可以开始实现ClickIt组件，特别是它的构造函数：

模块：ch9.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09048.jpeg)

关于构造函数__init__()需要注意三点：首先，在第10行ClickIt构造函数__init__()扩展了Frame的构造函数__init__()。这样做的原因有下列两点：

1.我们希望ClickIt组件像Frame组件一样初始化，以保证它是一个完整的框架部件；

2.我们希望ClickIt组件像任何其他框架组件一样被分配一个父组件，因此我们把ClickIt构造函数的master输入参数传递给Frame的构造函数。

其次要注意的是，button不是一个全局变量，与在原始程序clickit.py中是一个全局变量相比，目前它只是一个局部变量，不会影响使用类Click的程序中定义的名称。最后要注意的是我们定义按钮事件处理函数为self.clicked，这意味着clicked()是类ClickIt的一个方法。代码实现如下：

模块：ch9.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09049.jpeg)

因为它是一个类方法，因此名称clicked不是一个全局名称，这区别于原始程序clickit.py。

因此，类ClickIt封装代码和名称（clicked和button）。这意味着，这些名称对使用ClickIt组件的程序都不可见，这使开发人员不需要担心是否程序中的名称会发生冲突。此外，开发者会发现在一个大的GUI中整合使用ClickIt组件非常容易。例如，下面的代码将在一个窗口中整合使用ClickIt组件，并启动GUI：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09050.jpeg)