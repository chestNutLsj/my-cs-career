   

### 8.4.2　使Point类对用户友好

先回顾一下之前我们所使用的如下示例：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08869.jpeg)

假设我们更期望point的求值结果如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08870.jpeg)

为了理解我们如何做到这一点，首先需要理解，当在命令行中对point求值时，Python将显示对象的字符串表示形式。对象的默认字符串表示形式是它的类型和地址，如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08871.jpeg)

要修改一个类的字符串表示形式，我们需要为该类实现重载运算符repr()。当对象需要表示为一个字符串时，解释器自动调用运算符repr()。在解释器命令行中需要显示一个对象时，就是这种情况。因此包含数值3、4和5的列表lst的友好表示为[3,4,5]：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08872.jpeg)

实际上显示的是调用repr(lst)的字符串输出：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08873.jpeg)

基于上述目的，所有的内置类都实现了重载运算符repr()。要修改用户自定义类的对象的默认字符串表示形式，我们需要同样操作。我们通过实现表8-3中对应于运算符repr()的方法：方法__repr__()。

要使得一个Point对象的显示格式为Point(<x>,<y>)，我们需要做的是添加如下方法到类Point中：

模块：ch8.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08874.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08875.jpeg)

现在，让我们在命令行中对一个Point对象求值，结果的确符合预期：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08876.jpeg)

注意事项：对象的字符串表示形式

实际上有两种方式来获取对象的字符串表示形式：重载运算符repr()和字符串的构造函数str()。

运算符repr()用于返回对象的规范字符串表示形式。理想情况下（不是必然），这就是用来构造对象的字符串表示形式，例如'[2,3,4]'或者'Point(3,5)'。

换言之，表达式eval(repr(o))的求值结果应该返回对象原来的o。在解释器命令行中当一个表达式的求值结果为一个对象并且需要在命令行窗口中显示该对象时，会自动调用方法repr()。

字符串构造函数str()返回对象的非正式且非常易于阅读的字符串表示形式。该字符串表示形式通过调用方法o.__str__()获得（如果实现了__str__()的话）。当使用函数print()来“美化输出”对象时，Python解释器调用字符串构造函数来代替重载运算符repr()。我们以下述类为例说明：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08877.jpeg)

测试结果如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08878.jpeg)