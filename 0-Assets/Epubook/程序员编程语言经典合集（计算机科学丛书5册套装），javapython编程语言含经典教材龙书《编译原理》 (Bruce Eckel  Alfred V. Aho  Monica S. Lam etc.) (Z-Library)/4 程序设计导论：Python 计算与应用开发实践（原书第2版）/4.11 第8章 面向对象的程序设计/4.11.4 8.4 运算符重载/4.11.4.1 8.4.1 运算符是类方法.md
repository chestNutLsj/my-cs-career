   

### 8.4.1　运算符是类方法

考虑运算符+。它可以用于两个数值相加：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08860.jpeg)

也可以用于拼接列表或字符串：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08861.jpeg)

+运算符被称为重载运算符。重载运算符是一个为多个类定义的运算符。对于每一个类，运算符的定义和意义都是不同的。例如，对于int、list和str类，都定义了+操作符。对于int类，它实现整数相加运算；对于list类，它实现列表拼接运算；对于str类，它实现字符串拼接运算。现在的问题是：如何为特定类定义运算符+？

Python是一种面向对象的语言，正如我们所说，任何“求值”，包括对算术表达式（如2+4）的求值，实际上是一种方法调用。要确定究竟调用了什么方法，需要使用help()文档工具。无论输入help(int)、help(str)或help(list)，都会看到+运算符的如下文档：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08862.jpeg)

这意味着当Python表达式x+y求值时，它首先把表达式替换为x.__add__(y)，即对象x的方法调用（y作为输入参数），然后对新的表达式（方法调用）求值。不管x和y是什么，求值过程都是这样的。因此，对表达式2+3、[4,5,6]+[7]和'strin'+'g'的求值，实际上可以使用如下方法调用__add__()来代替：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08863.jpeg)

知识拓展：归根结底，加法只是一个函数

Python解释器把代数表达式：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08864.jpeg)

翻译成方法调用：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08865.jpeg)

在第7章，我们学习到解释器把该方法调用翻译成：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08866.jpeg)

（请回忆，type(x)的求值结果为对象x的类。）最后一个表达式是实际求值的表达式。

当然，所有的运算符都是如此：任何表达式或方法调用实际上是调用第一个操作数所在的类的名称空间中定义的一个函数。

+运算符仅仅是Python重载运算符之一，表8-3显示了其他一些重载运算符。对于每个运算符，显示了其对应的函数，及其针对数值类型、list类型和str类型的运算行为的解释说明。所有列举的运算符同样在其他内置类型（dict、set等）中定义，也可以在用户自定义类型中定义（如下文所示）。

注意，表8-3列举的最后一个运算符是重载构造函数运算符，对应于函数__init__()。我们已经讨论了在一个用户自定义类中如何实现一个重载构造函数。我们将看到实现其他重载运算符的方法都十分类似。

表8-3　重载运算符。其中列出了一些常用的重载运算符，以及对应的方法和针对数值、列表和字符的运算行为

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08867.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08868.jpeg)