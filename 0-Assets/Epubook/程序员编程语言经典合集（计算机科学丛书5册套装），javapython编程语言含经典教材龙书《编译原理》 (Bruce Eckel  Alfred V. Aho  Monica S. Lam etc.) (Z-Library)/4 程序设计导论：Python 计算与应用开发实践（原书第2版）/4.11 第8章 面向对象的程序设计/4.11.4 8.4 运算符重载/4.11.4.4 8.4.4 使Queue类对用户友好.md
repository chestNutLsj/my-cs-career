   

### 8.4.4　使Queue类对用户友好

接下来我们通过重载运算符repr()、==和len()，使得上一节的类Queue更加友好。在开发过程中我们发现扩展构造函数有帮助。

我们从如下Queue的实现开始：

模块：ch8.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08887.jpeg)

让我们首先处理“简单的”运算符。两个队列相等意味着什么？意味着两个队列包含相同的元素且顺序相同。换言之，两个队列包含的列表相同。因此，类Queue的运算符__eq__()的实现应该包括我们比较的两个Queue对象对应的两个列表之间的比较：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08888.jpeg)

重载运算符len()返回容器中的项目的个数。要在Queue对象上使用len()函数，必须在Queue类中实现对应的方法__len__()（参见表8-3）。很显然，队列的长度是底层列表self.q的长度：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08889.jpeg)

接着让我们解决repr()运算符的实现。假设按如下方式构建队列：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08890.jpeg)

那么我们希望规范字符串表示形式是什么样子呢？请问如下形式如何：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08891.jpeg)

如前所述，要实现重载运算符repr()，理想情况是满足其与构造函数之间的约定。要满足约定，则必须能够按照如下形式构建队列：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08892.jpeg)

结果出错啦！因为Queue构造函数实现为不带任何输入参数，所以，我们决定修改构造函数。这样做的优点有二：（1）满足构造函数和repr()之间的约定；（2）新建的Queue对象在实例化的时候可以初始化。

模块：ch8.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08893.jpeg)

练习题8.7　在Deck类中实现重载运算符len()、repr()和==。新的Deck类的运行结果如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08894.jpeg)