   

### 8.5.3　重写父类方法

我们使用另一个简单示例描述继承。假如我们需要一个与8.1节中类Animal类似的类Bird。类Bird和类Animal一样，支持方法setSpecies()和setLanguage()：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08909.jpeg)

类Bird同样支持名为speak()的方法。然而，其行为与Animal方法speak()不同：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08910.jpeg)

下面是我们期望的类Bird的行为的另一个示例：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08911.jpeg)

接下来我们讨论如何实现类Bird。因为Bird共享既存类Animal的属性（毕竟鸟类也是动物），我们把它开发成Animal的一个子类。让我们首先回顾8.1节中类Animal的定义：

模块：ch8.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08912.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08913.jpeg)

如果把类Bird定义为类Animal的一个子类，则其方法speak()的行为将不相符。所以问题是：有没有一种方法来定义Bird为Animal的一个子类，同时在类Bird中改变方法speak()的行为？

当然，只需要在类Bird中简单地实现一个新的方法speak()即可：

模块：ch8.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08914.jpeg)

类Bird被定义为Animal的一个子类。因此，它继承类Animal的所有属性，包括Animal方法speak()。但是，在类Bird中存在一个方法speak()，这个方法替代继承的Animal方法speak()。我们称之为Bird方法重写了父类方法speak()。

现在，当在一个Bird对象上（例如daffy）调用方法speak()时，Python解释器如何确定调用哪个speak()方法呢？我们使用图8-8来说明Python解释器如何查找属性定义。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08915.jpeg)

图8-8　与类Animal和Bird、对象daffy、命令行关联的名称空间。省略了实例变量的值和类方法的实现

当解释器执行如下语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08916.jpeg)

解释器创建一个名为daffy的Bird对象和一个相关联的名称空间（初始为空）。接下来让我们考虑Python解释器如何查找下列语句中的setSpecies()的定义：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08917.jpeg)

解释器从与对象daffy关联的名称空间开始沿着类层次结构查找属性setSpecies()的定义。解释器在与对象daffy关联的名称空间和与类Bird关联的名称空间中都没有查找到其定义。最终，在类Animal关联的名称空间中查找到了setSpecies()的定义。

解释器对下列表达式求值时查找方法定义，最终也是在类Animal的名称空间中找到：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08918.jpeg)

然而，当Python解释器执行如下语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08919.jpeg)

解释器在类Bird中查找到方法speak()的定义。换言之，查找属性speak永远不会到达类Animal。最后执行的是Bird的speak()方法。

注意事项：关于属性名称问题

现在我们理解了Python解释器如何对对象属性求值，接下来我们讨论由于粗心大意选择属性名称可能导致的问题。例如，对于下列类定义：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08920.jpeg)

然后尝试：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08921.jpeg)

一切看起还不错。当执行p.value(9)时，对象p并没有实例变量value，属性搜索结果为类Problem中的函数value()。随后在对象自身中创建一个实例变量value，通过对后面的语句（p.value）求值证明了这一点。

接着让我们尝试：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08922.jpeg)

哪儿出错了？查找属性value从对象p开始到对象p结束：对象有一个名为value的属性。该属性指向一个整型对象（也就是9），该整型对象是不能作为函数被调用的。