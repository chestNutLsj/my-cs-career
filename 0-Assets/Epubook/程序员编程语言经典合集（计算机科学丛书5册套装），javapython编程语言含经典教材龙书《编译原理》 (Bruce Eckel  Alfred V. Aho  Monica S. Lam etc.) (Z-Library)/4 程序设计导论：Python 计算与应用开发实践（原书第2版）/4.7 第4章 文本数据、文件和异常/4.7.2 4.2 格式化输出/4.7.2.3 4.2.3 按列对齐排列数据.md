   

### 4.2.3　按列对齐排列数据

接下来讨论按列对齐“漂亮地”呈现数据的问题。作为问题的动机，设想邮件客户的From（发件人）、Subject（主题）和Date（日期）字段的组织方式，或者屏幕上显示的火车或飞机的出发时间和到达时间信息。当我们开始处理大量数据时，有时候也需要以按列对齐的方式呈现数据。

为了描述这个问题，让我们考虑针对i=1，2，3，…，整齐输出函数i2、i3和2i的值的问题。整齐输出这些值非常有用，因为结果可以描述这些函数的不同增长率：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08247.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08248.jpeg)

那么，如何获得这种输出格式呢？我们首先尝试使用print()函数的sep参数，在各行的不同值之间插入适当数量的空格：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08249.jpeg)

输出结果如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08250.jpeg)

虽然前几行的格式看起来没有问题，但是我们发现同一列的数据并没有很好地对齐。问题的根源在于固定大小的分隔符，当某一项的数值的位数增加时，其位置将向右偏移。因此，固定大小的分隔符不能胜任该任务。整齐呈现列数据的正确方法是保证所有数值的位一致对齐。我们需要的是把每列数值的宽度固定，然后使用右对齐的方式输出这些固定宽度的数值。可以使用格式化字符串实现该功能。

在格式化字符串的花括号中，可以指定映射到花括号占位符的值的呈现方式：我们可以指定字段宽度（width）、对齐方式（alignment）、小数点精度（decimal precision）、数据类型（type），等等。

我们可以使用一个十进制整数指定（最小）字段宽度，定义值的保留字符数位置。如果没有指定或者指定的字段宽度不够，则字段宽度将由显示值的数值位数/字符数确定。例如：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08251.jpeg)

在上例中，我们输出整数值12和354。格式化字符串中12的占位符为{0:3}。0表示format()函数的第一个参数（即12），如前所述。':'后的内容用于指定值的格式。在这个例子中，3表示占位符的宽度应该为3。因为12是一个两位数的数值，因此在前面添加了一个额外的空格。354的占位符包括'1:5'，因此在354前面添加了2个空格。

当字段宽度大于数值的位数时，默认情况下右对齐（即把数值靠右对齐）。字符串是左对齐。在下一个例子中，为参数first和last保留的字段宽度为10个字符。注意多余的空格添加到字符串值的后面：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08252.jpeg)

精度（precision）是指定浮点值的小数点前后显示位数的十进制数。它位于字段宽度之后，用逗号分隔。在下一个例子中，字段宽度为8，但只显示4位浮点数值：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08253.jpeg)

比较无格式化的输出结果：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08254.jpeg)

类型（type）决定值呈现的方式。整数的呈现方式类型如表4-2所示。

表4-2　整数的呈现方式类型

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08255.jpeg)

以整数10为例，其不同的整数类型选项描述如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08256.jpeg)

浮点数的呈现方式选项有两种：f和e。类型选项f把值显示为定点数（即包括小数点和小数部分）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08257.jpeg)

在上例中，格式化规格':6.2f'保留最小宽度为6，正好2位小数，把浮点数值表述为定点数。类型选项e表述科学计数法，指数部分显示在字符e之后：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08258.jpeg)

即结果表示1.666667×100。

现在让我们回到最初问题：对于i=1，2，3，…，12，显示函数i2、i3、2i的值。我们为i的值指定最小宽度3，为i2、i3、2i的值指定最小宽度6，以获得期望的格式。

模块：ch4.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08259.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08260.jpeg)

练习题4.6　实现函数roster()，带一个包含学生信息的列表作为输入参数，输出如下所示的花名册。学生信息包含学生的姓、名、班级和平均课程成绩，按顺序保存在一个列表中。因此，输入参数为一个列表的列表。请确保花名册输出的每个字符串值包含10个字符位置，成绩包含8个占位字符（包括2个小数点位）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08261.jpeg)