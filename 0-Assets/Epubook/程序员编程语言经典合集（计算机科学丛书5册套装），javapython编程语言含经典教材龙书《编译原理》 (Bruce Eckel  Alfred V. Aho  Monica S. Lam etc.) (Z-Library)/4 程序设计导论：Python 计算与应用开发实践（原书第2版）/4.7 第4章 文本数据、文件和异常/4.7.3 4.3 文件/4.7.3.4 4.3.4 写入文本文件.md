   

### 4.3.4　写入文本文件

为了向文本文件中写入内容，文件必须以写入方式打开：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08304.jpeg)

如果在当前工作目录中，不存在文件test.txt，则open()函数将创建该文件。如果文件test.txt已经存在，则清空其内容。两种情况下，游标都会指向（空）文件的开头。（如果我们希望向既存文件中添加更多内容，则需要使用打开模式'a'替代'w'。）

一旦以写入方式打开了文件，则可以使用函数write()写入字符串到文件。它将从游标位置开始写入字符串。让我们先写入一个单字符字符串：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08305.jpeg)

返回值是写入到文件的字符个数。游标现在指向字符T后面的位置，下一次写入将从此位置开始。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08306.jpeg)

这次写入将在文件的第一行的字符T之后写入22个字符。现在游标将指向句点后面的位置。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08307.jpeg)

直到换行符之前写入的所有内容都将写入到同一行之中。当写入'\n'之后，下一次写入将写入第二行：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08308.jpeg)

转义字符\n表示我们结束了第二行，接下来写入到第三行。要写入字符串以外的其他内容，必须先转换为字符串：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08309.jpeg)

此时可以借助于字符串的format()函数。为了说明使用字符串格式化的优越性，下面使用字符串格式化输出前面相同的行内容：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08310.jpeg)

在读取文本文件之前，必须在写入之后先关闭文件：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08311.jpeg)

test.txt文件将被保存在当前工作目录中，且其内容如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08312.jpeg)

注意事项：刷新输出

当一个文件被打开用于写入时，内存中会创建一个缓冲区。对文件的所有写入实际上都是写入这个缓冲区，并没有写入到磁盘，至少不是立即写入。

不直接写入诸如磁盘之类的辅助存储器的原因在于，这种写入需要很长时间，如果每次写入都要在辅助存储器上进行，那么进行多次写入的程序将非常缓慢。这意味着在文件和写入刷新之前，文件系统中没有创建文件。close()函数将在关闭文件之前，刷新缓冲区的内容到磁盘文件，所以一定不要忘记关闭文件。也可以使用flush()函数刷新写入内容而不用关闭文件：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image08313.jpeg)