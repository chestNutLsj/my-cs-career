   

## 12.9　思考题

12.16　编写函数ranking()，带一个输入参数：一个数据库文件的名称，数据库包含图12-2a所示的表相同格式的名为Hyperlinks的表。要求函数向数据库中增加一张表，包含Hyperlinks中Link列中列举的所有URL的导入超链接的个数。把新的表和列字段分别命名为Ranks、Url和Rank。在数据库文件links.db的Rank表上执行下列通配符查询时，结果如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09431.jpeg)

12.17　编写一个应用程序，带一个输入参数：一个文本文件名。计算文件中每个单词的出现频率，并把结果(word,frequency)对保存到新的数据库文件中一个名为Wordcounts的新的表中。新的表包含列Word和Freq，用于存储(word,frequency)对。

12.18　使用海龟绘图开发一个应用程序，显示一个文本文件中出现频率最高的n个单词。假设文件中的单词频率已经统计并存储在思考题12.17中创建的数据库文件中。要求你的应用程序带两个输入参数：数据库文件的名称和数值n。程序应该在海龟绘图屏幕上的随机位置显示n个出现频率最高的单词。尝试设置单词使用不同的字体大小：出现频率最高的单词的字体最大，接下来两个单词字体稍小些，接下来四个单词的字体更小些，以此类推。

12.19　在练习题12.4中，我们开发了一个简单的搜索引擎，基于单词频率对网页进行排序。有好多理由证明这种网页排序方式并不好，包括该方式太易于操作的事实。

现代搜索引擎（例如Google）使用超链接信息（包括其他内容）实现网页排名。例如，如果一个Web页面有很少的导入链接，它可能不包含有用的信息。然而，如果一个网页有许多导入超链接，那么它可能包含有用的信息，故排名应该靠前。

使用图12-1中的通过网页爬虫抓取的结果数据库文件和思考题12.6计算的Rank表，重新开发练习题12.4中的搜索引擎，按导入链接数进行网页排名。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09432.jpeg)

12.20　UNIX文本搜索工具grep带两个参数：一个文本文件和一个正则表达式。返回一个包含匹配该模式的字符串的文本行的列表。开发一个并行版本的grep，带两个参数：来自用户的文本文件和正则表达式，然后使用一个进程池来搜索文件中的行。

12.21　我们使用程序primedensity.py比较几个非常大的整数的大数值范围内的素数的密度。在这个问题中，你将比较孪生素数的密度。孪生素数是素数对，其差为2。最开始的几个孪生素数分别是3和5、5和7、11和13、17和19、29和31。编写一个应用程序，使用计算机的所有内核，比较我们在primedensity.py中使用的相同整数范围中的孪生素数个数。

12.22　思考题10.26要求读者开发函数anagram()，使用一个字典（即一个单词列表）来计算一个给定字符串的字谜（anagram）。开发panagram()，该函数的一个并行版本，带一个单词列表作为输入参数，为每一个单词计算一个字谜列表。

12.23　在这本书的最后有一个索引，把单词映射到包含该单词的页的页码。一个行索引与其相似：它将单词映射到它们出现的文本行的行号。使用MapReduce框架开发一个应用程序，带一个输入参数：一个文本文件名，创建一个行索引。你的应用程序应该将索引输出到一个文件中，以便单词按字母顺序出现，每行一个单词。每个单词的行号应该跟随单词之后，并以递增的顺序输出。

12.24　重新实现思考题12.16，使用MapReduce计算每个网页的导入链接的数量。

12.25　Web链接图是一组相互链接的网页的超链接结构的描述。表示网络链接图的一个方法是使用一个(url,linksList)对的列表，(url,linksList)对应于一个网页，url表示网页的URL，linksList是包含在网页中的超链接的URL列表。请注意，网络爬虫可以很容易收集此信息。

反向Web链接图是一组相互链接的网页的超链接结构的另一种描述。它可以表示为(url,incomingList)对列表，url表示一个网页的URL，incomingList表示导入超链接的URL列表。因此反向Web链接图明确导入链接而不是导出链接。它有助于高效地计算网页的Google PageRank（网页排名）。

开发一个函数，带一个Web链接图作为参数（如上所述），返回反向Web链接图。

12.26　Web服务器通常会为其处理的每个HTTP请求创建一个日志，并把日志字符串添加到一个日志文件。保存日志文件有多种原因。一个特殊的原因是它可以用来发现哪些服务器管理的资源（由URL标识）被访问，以及被访问的频率（表示为URL访问频率）。在本思考题中，请开发一个程序，计算一个给定日志文件中的URL访问频率。

Web服务器日志条目是以一种众所周知的标准格式写入的，这种格式称为公共日志格式。这是一种被Apache httpd服务器以及其他服务器所采用的标准格式。标准格式使开发挖掘访问日志文件的日志分析程序成为可能。公共日志格式生成的日志文件条目如下所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09433.jpeg)

这条日志包含很多信息。对于我们的目的而言，关键信息是请求的资源：index.html。编写一个程序，计算日志文件中出现的每个资源的访问频率，并将这些信息写入数据库表，表的列包含资源URL和访问频率。将访问频率写入数据库使URL访问频率适合于查询和分析。

12.27　使用MapReduce编写一个应用程序，计算一组小说的词语索引。词语索引是一种映射关系，把一组单词中的每个单词映射到小说中包含该单词的句子的列表。应用程序的输入是包含小说的文本文件集合和要映射的单词集合。要求将词语索引输出到一个文件中。