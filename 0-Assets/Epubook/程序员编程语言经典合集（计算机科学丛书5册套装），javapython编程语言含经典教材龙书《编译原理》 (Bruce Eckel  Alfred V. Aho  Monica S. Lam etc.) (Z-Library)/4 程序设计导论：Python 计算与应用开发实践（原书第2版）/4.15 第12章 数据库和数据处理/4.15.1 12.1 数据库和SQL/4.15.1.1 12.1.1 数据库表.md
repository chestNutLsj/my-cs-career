   

### 12.1.1　数据库表

在电子案例研究CS.11中，我们开发了一个Web爬虫程序——通过网页中的超链接访问网页的程序。爬虫程序扫描每个访问的网页的内容并输出有关它的信息，包括网页中包含的所有超链接URL和网页中每个单词的出现频率。如果我们在图12-1所示的链接Web页面上运行爬虫程序，每个网页包含一些世界城市的名称及其出现的次数，超链接URL将以下列格式输出：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09298.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09299.jpeg)

图12-1　五个相互链接的Web页面。每个网页都有一些世界主要城市的出现次数。例如，网页one.html包含三次“Beijing”、五次“Paris”、五次“Chicago”。它还包含指向Web页面two.html和three.html的超链接

例如，前两行显示网页one.html包含指向网页two.html和three.html的超链接。

爬虫程序将以下列格式输出每个Web页面中每个单词的出现频率：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09300.jpeg)

因此，网页one.html包含三次'Beijing'、五次'Paris'和五次'Chicago'。

假设我们希望分析爬虫程序收集的数据。例如，我们可能希望查询下列信息：

1.单词X出现在哪个网页？

2.根据网页中出现的单词X的数量排名，包含单词X的网页的排名是什么？

3.包含单词X的网页有多少个？

4.哪些网页包含指向网页Y的超链接？

5.单词'Paris'在所有的网页上出现的次数是多少？

6.每个访问过的网页有多少个导出超链接？

7.每个访问过的网页有多少个导入超链接？

8.哪些网页指向一个包含单词X的网页？

9.包含单词X的网页中，哪个网页有最多的导入超链接？

在爬虫生成的数据集上回答这些问题是相当麻烦的。数据集的文本文件格式要求将文件读入到字符串中，然后必须使用特殊字符串操作来检索相关数据。例如，为了回答问题1，我们必须找到包含单词X的文件中的所有行，将每一行拆分成单词（即用空格分隔的字符串），收集每行中的第一个单词，然后删除重复的URL地址。

另一种方法是将爬虫程序收集的信息保存到数据库文件中，而不是一般用途的文本文件中。数据库文件以结构化的方式存储数据，从而能有效地访问和处理数据。

结构化意味着数据库文件中的数据存储在一个或多个表中。每个表由一个名称（如客户Customers或产品Products）标识，每个表由列和行组成。每个列都有一个名称，包含特定类型的数据：字符串、整数、实数（浮点数）等。表的每一行包含与一个数据库记录相对应的数据。

在我们的示例中，图12-1所示的爬虫程序从Web页面上抓取的信息可以存储在图12-2所示的两个数据库表中。第一个表称为Hyperlinks，包含列Url和Link。表中的每一行（记录）包含一个Url列中的字符串X和一个Link列中的字符串Y，表示在Web页面X中有一个指向Y的超链接。第二个表称为Keywords，包含列Url、Word和Freq。每条记录分别包含列Url和Word的字符串X和Y，以及列Freq的整数Z，对应于单词Y出现在URL为X的Web页面中，其出现频率为Z。

把数据存储在数据库表中后，我们可以使用一种特殊的数据库编程语言来查询数据。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09301.jpeg)

图12-2　数据库表Hyperlinks和Keywords。这两个表包含爬虫程序在图12-1所示的页面集上抓起处理后的数据。Hyperlinks的行对应于网页Url中的一个到网页Link的超链接。Keywords的行对应于一个单词出现在网页Url中，Word在网页中出现的频率为Freq