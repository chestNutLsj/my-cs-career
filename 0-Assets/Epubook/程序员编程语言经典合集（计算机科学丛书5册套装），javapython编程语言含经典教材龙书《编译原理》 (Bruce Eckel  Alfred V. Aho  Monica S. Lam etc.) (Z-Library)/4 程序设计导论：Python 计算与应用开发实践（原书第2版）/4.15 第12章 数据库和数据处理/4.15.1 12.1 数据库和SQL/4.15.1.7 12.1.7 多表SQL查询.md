   

### 12.1.7　多表SQL查询

假设我们想知道“什么网页有一个指向包含单词Bogota的网页的超链接？”的问题。这个问题需要查找两个表：Keywords和Hyperlinks。我们需要在Keywords中查找包含单词“Bogota”的网页的URL的结果集S，然后在Keywords中查找包含指向S中网页的超链接的网页的URL。

SELECT语句可以在多个表上使用。为了理解在多个表上使用SELECT时的行为，我们开发了几个示例。第一个示例如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09321.jpeg)

上述查询返回一个包含104条记录的表，每个记录包含Hyperlinks中的记录和Keywords中的记录的组合。结果表如图12-6所示，称之为交叉连接，它有五个命名列，对应于表Hyperlinks的两个列和表Keywords的三个列。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09322.jpeg)

图12-6　连接数据库表。该表由表Hyperlinks的每一行和表Keywords的每一行组合而成。由于表Hyperlinks有8行，表Keywords中有13行，交叉连接将有8×13=104行。图中只显示前3行和后3行

当然，在交叉连接中有条件地选择一些记录是可能的。例如，下一个查询从104行交叉连接中，选择表Keywords中列Word包含“Bogota”的16行记录（图12-6中显示了其中的两行）：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09323.jpeg)

注意最后一个SQL查询的语法。在多个表中的列的查询中，必须在列名之前添加表名和一个英文句点。如果不同表中的列具有相同的名称，这可以避免混淆。要指向表Keywords的列Word，必须使用符号Keywords.Word。

下面是另一个示例。下一个查询抽取交叉连接中Hyperlinks.Url和Keywords.Url值相等的记录：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09324.jpeg)

上述查询的结果如图12-7所示。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09325.jpeg)

图12-7　连接数据库表。其中包含了图12-6中满足条件Hyperlinks.Link=Keywords.Url的行

概念上，图12-7中的表包含这样的记录：超链接指向的网页中出现的单词（即URL Hyperlinks.Link的网页）与另一个超链接（从Hyperlinks.Url到Hyperlinks.Link）之间的联系。

现在，回到我们最初的问题：“什么网页有一个指向包含单词Bogota的网页的超链接？”要回答这个问题，我们需要在交叉连接中选择记录，满足如下条件：Keywords.Word的值等于‘Bogota’，并且Keywords.Url的值等于Hyperlinks.Link的值。图12-8显示了这些记录。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09326.jpeg)

图12-8　连接数据库表。该表包含图12-7中满足条件Keywords.Word='Bogota'的记录

要查询一个指向包含'Bogota'的网页的所有网页的URL，我们需要执行如图12-9所示的查询。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09327.jpeg)

图12-9　连接数据库表。结果表仅包含图12-8中所示表的列Hyperlinks.Url