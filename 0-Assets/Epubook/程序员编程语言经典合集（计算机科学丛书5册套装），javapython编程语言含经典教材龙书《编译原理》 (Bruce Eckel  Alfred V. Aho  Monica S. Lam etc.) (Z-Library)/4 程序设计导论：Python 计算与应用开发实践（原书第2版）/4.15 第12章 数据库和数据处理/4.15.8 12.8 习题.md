   

## 12.8　习题

12.9　编写SQL查询，查询图12-2中的表Hyperlinks和Keywords，返回下列结果：

（a）在URL four.html的网页上出现的不重复的单词。

（b）包含'Chicago'或者'Paris'的网页的URL。

（c）所有网页中每个不重复单词出现的总次数。

（d）从包含'Nairobi'的网页具有导入超链接的网页的URL。

12.10　编写SQL查询，查询图12-16中的WeatherData表，返回下列结果：

（a）城市为London的所有记录。

（b）所有夏天（summer）的记录。

（c）平均气温小于20度的city、country和season。

（d）平均气温大于20度且总降水量（rainfall）小于10mm的city、country和season。

（e）最大的总降水量（rainfall）。

（f）所有记录的城市（city）、季节（season）和总降水量（rainfall），按降水量的降序排列。

（g）Cairo,Egypt（埃及和开罗）的年降水量。

（h）每个不同城市的城市名（city name）、国家（country）和年总降水量。

12.11　使用模块sqlite3，创建一个数据库文件weather.db，并在其中创建表WeatherData。在表中定义如图12-16所示的列名称和类型，然后插入图12-16所示的所有行记录。

12.12　使用sqlite3，在其交互式命令行中，打开在习题12.11中创建的数据库文件，然后通过运行相应的Python语句来执行习题12.10中的查询。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09429.jpeg)

图12-16　世界天气数据库节选。其中显示了几个世界城市的冬天（1）、春天（2）、夏天（3）和秋天（4）的24小时平均气温（单位：摄氏温度）和总降水量（单位：毫米）

12.13　假设列表lst定义如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09430.jpeg)

创建基于列表lst的列表解析表达式，生成如下列表：

（a）[3,6,4,9]（即列表lst的个位数）

（b）[12,14,6,4,20]（即列表lst中的偶数）

（c）[12,3,21,14,6,4,9,20]（即列表lst中被2或者3整除的数）

（d）[4,9]（即列表lst的平方数）

（e）[6,7,3,2,10]（即列表lst中的偶数的一半）

12.14　使用一个、两个、三个、四个，或者计算机上的所有内核来运行程序primeDensity.py，并记录运行时间。然后编写一个primeDensity.py程序的顺序版本（例如，使用列表解析）并记录其运行时间。比较每次primeDensity.py执行的加速比，使用两个或更多内核。

12.15　通过记录MapReduce每一步（Map、Partition和Reduce）的运行时间，微调程序ch12.py的运行时间分析（需要修改类MapReduce）。哪一步的加速比更好？