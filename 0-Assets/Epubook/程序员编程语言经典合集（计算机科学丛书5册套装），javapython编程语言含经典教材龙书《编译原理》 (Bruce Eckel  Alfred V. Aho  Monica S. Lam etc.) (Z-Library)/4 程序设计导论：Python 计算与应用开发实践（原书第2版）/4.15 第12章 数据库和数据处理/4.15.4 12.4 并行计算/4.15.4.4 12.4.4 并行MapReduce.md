   

### 12.4.4　并行MapReduce

掌握了列表解析的并行版本之后，我们可以修改第一个顺序MapReduce的实现，实现一个可以并行运行Map和Reduce的版本。唯一要修改的是在构造函数中增加一个可选的输入参数：所需的进程数。

模块：ch12.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09406.jpeg)

修改方法process()，在Map和Reduce步骤中使用Pool方法map()代替列表解析。

模块：ch12.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09407.jpeg)