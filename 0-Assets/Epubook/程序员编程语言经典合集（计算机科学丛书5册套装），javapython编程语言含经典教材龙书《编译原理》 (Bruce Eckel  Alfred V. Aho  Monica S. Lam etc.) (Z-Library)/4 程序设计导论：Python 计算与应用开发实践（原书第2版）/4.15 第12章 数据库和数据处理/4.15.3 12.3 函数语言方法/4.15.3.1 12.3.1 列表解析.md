   

### 12.3.1　列表解析

打开一个文本文件后，使用方法readlines()读取文件，将获得一个文本行的列表。列表中的每一行以新的换行符\n结尾。例如，假设获得的文本行列表如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09359.jpeg)

在典型应用中，字符\n会妨碍文本行的处理，我们需要删除它。删除\n的一种方法是使用for循环和熟悉的累加器模式：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09360.jpeg)

在for循环的每次迭代i中，删除第i行的最后一个字符（换行字符\n）并把修改后的文本行添加到一个累加器列表newlines中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09361.jpeg)

Python中还有一种完成同样任务的方法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09362.jpeg)

Python语句“[line[:-1] for line in lines]”基于列表lines构造一个新的列表，是Python的列表解析构造。其工作原理如下：从左到右，针对lines中的每一个项应用line[:-1]来生成新列表。新列表中项出现的顺序对应于原始列表lines中对应项的顺序（参见图12-12）。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09363.jpeg)

图12-12　列表解析。从一个既存列表构造一个新的列表。把同一个函数应用到既存列表中的每一个项来构造新的列表

更一般地，列表解析语句的语法格式如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09364.jpeg)

语句的计算结果为一个列表，通过把<表达式>（通常与<项>相关联）应用到可迭代容器<序列/迭代器>的每个项生成新列表的项。一个更一般的版本格式还包括一个可选的条件表达式：  

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09365.jpeg)

在这种情况下，通过应用<表达式>到<序列/迭代器>的满足<条件>的项来生成新列表的项。

让我们尝试几个示例。对上一个示例进行如下更改，使得新的列表将不包含空字符串（对应于原始文件的空行）：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09366.jpeg)

在下一个示例，我们构造一个不超过20的偶数列表：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09367.jpeg)

在下一个示例，我们计算一个列表中字符串的长度：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09368.jpeg)

练习题12.5　假设字符串列表words定义如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09369.jpeg)

编写列表解析语句，使用words作为原始列表，构造如下列表：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09370.jpeg)

我们对（c）中的列表加以解释。对于原始列表中的每个字符串s，创建一个新的元组列表，每个元组映射字符串的一个字母到字符串s本身。

知识拓展：函数式编程

列表解析是借用自函数式编程语言的编程结构。列表解析起源于编程语言SETL和NPL，当它被包含在函数式编程语言Haskell和（特别是）Python后，越来越为大众知晓。

函数式语言范式不同于命令式、陈述式和面向对象的范式，因为它没有“语句”，只有表达式。函数式语言程序是一个表达式，它包含一个函数调用，它通过数据和其他可能的函数作为参数。函数式编程语言的例子包括Lisp、Scheme、Clojure、ML、Erlang、Scala、F #，和Haskell。

Python不是一种函数式语言，但它借用了一些有助于创建更简洁、更短小的Python程序的函数语言结构。