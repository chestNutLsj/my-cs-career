   

### 10.3.1　指数函数

接下来我们讨论指数函数an的实现。我们已经知道，Python提供了求幂运算符**：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09145.jpeg)

但是，如何实现幂运算符**呢？如果不存在该运算符，我们该如何实现它？直接的方法是把a相乘n次。累加器模式可以用来实现这种思想：

模块：ch10.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09146.jpeg)

我们应该可以很自信地认为函数power()功能正确。但这是实现函数power()的最好方式吗？有没有运行速度更快的实现？很明显，函数power()将执行n次乘法来计算an。如果n是10 000，则需要执行10 000次乘法。我们可不可以实现power()，使得要执行的乘法次数显著减少，例如20次而不是10 000次？

让我们看看递归方法会给我们带来什么。我们要开发一个递归函数rpower()，带两个输入参数：a和非负整数n，返回an。

很显然，递归的基本情况是n=0，此时an=1，应该返回1：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09147.jpeg)

让我们处理递归步骤。为此，我们需要把an(n>0)递归地表示为a的较小的幂（即“更接近”基本情况）。实际上这并不困难，有很多实现方法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09148.jpeg)

最后一个表达式的吸引人之处是an/2和an/2这两个项相同，因此通过一次计算an/2的递归调用可以计算an。唯一的问题是当n为奇数时，n/2不是一个整数。让我们考虑两种情况。

如上分析结果，当n的值为偶数，我们可以使用rpower(a,n//2)的结果来计算rpower(a,n)，如图10-9所示。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09149.jpeg)

图10-9　递归计算an。当n为偶数时，an=an/2×an/2

当n的值为奇数，我们同样可以使用递归调用rpower(a,n//2)的结果来计算rpower(a,n)，但是需要增加一个因子a，如图10-10所示。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09150.jpeg)

图10-10　递归计算an。当n为奇数时，an=an//2×an//2×a

基于上述观察分析结果，rpower()的递归实现代码如下所示。注意，只有一次递归调用rpower(a,n//2)。

模块：ch10.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09151.jpeg)

现在我们有两个不同版本的幂函数的实现：power()和rpower()。如何判断哪一个更有效率呢？