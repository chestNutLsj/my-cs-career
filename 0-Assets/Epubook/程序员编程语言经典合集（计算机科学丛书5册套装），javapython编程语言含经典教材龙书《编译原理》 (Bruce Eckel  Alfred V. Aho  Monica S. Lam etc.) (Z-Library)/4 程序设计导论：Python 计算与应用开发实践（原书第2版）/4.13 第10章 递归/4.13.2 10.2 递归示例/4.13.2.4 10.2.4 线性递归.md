   

### 10.2.4　线性递归

我们在这一节中讨论的三个问题——打印数字序列模式、绘制科赫曲线，以及扫描文件系统查找病毒，都可以不使用递归方法来解决。这些问题的迭代解法确实存在，然而，迭代解决方案需要比递归复杂得多的算法，超出了计算机科学导论教科书的范围。

另一方面，我们在10.1节中讨论的问题存在简单的迭代解决方案。10.1节中的递归函数vertical()、reverse()、cheers()和factorial()，可以很容易地使用迭代方法来实现。事实上，递归方法和迭代方法是密切相关的。练习题10.3和练习题5.4中的函数factorial()的两种实现方法可以用来说明这一点。虽然一种实现是递归方法而另一种实现是迭代方法，但两个函数使用相似的过程来计算n!：对于i=1，…，n，它们都通过把前一个中间结果(i-1)!乘以i来计算中间结果序列i!。因此，递归函数可以看作是这一思想的递归实现。

当一个函数的递归步骤是使用一个递归调用（计算“前一个”的中间结果）和“基本情况”非递归（具体问题）操作来计算“下一个”中间结果时，这个函数被称为使用线性递归。例如，在函数vertical()中，递归步骤包含一个递归调用vertical(n//10)（输出除最后一位数字的所有数字）和语句print(n%10)（输出最后一位数字）。

线性递归是实现基于列表的函数的一种特别有用的技术。例如，一个累加数字列表中数值的函数可以使用线性递归来实现，代码如下所示：

模块：ch10.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09137.jpeg)

注意，递归步骤包含一个递归调用（累加列表中除最后一个数值的所有数）和一个“基本情况”操作（把最后一个数加到累加和中）。

练习题10.6　使用线性递归实现函数recNeg()，带一个数值列表作为输入参数，如果列表中某些数值为负数，则返回True，否则返回False。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09138.jpeg)

在下一个示例中，我们实现函数recIncr()，带一个数值列表作为输入参数，返回列表的一个副本，列表中的每个数都递增1：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09139.jpeg)

我们选择使用递归方法而不是迭代方法实现该函数：

模块：ch10.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09140.jpeg)

递归步骤由拼接递归调用的结果列表和包含列表最后一个值加1的列表组成。

函数recIncr()是带一个列表输入参数并返回一个每个列表项都执行了同样操作的列表副本的示例。把列表中的项逐个递增1可能仅仅是希望针对列表项执行的许多操作之一。因此，这有助于实现一种更加抽象的函数recMap()，带两个参数（操作和列表），然后针对列表中的每个项应用该操作。当然，这里的“操作”意味着一个函数。例如，如果我们希望使用函数recMap()递增一个数值列表中的每个数值，首先必须定义希望应用到每个数值的函数：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09141.jpeg)

然后使用recMap()把函数f应用到列表中的每个数值：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09142.jpeg)

如果我们希望获得列表lst中所有数值的平方根，可以使用math.sqrt函数来代替：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09143.jpeg)

注意，recMap()的输入参数是f而不是f()，或者是sqrt而不是sqrt()。这是因为我们仅仅是传递一个指向函数对象的引用，而不是进行函数调用。

可以使用线性递归实现recMap()：

模块：ch10.py

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09144.jpeg)

知识拓展：高阶函数

在函数recmap()中，第二个输入参数是一个函数。以另一个函数作为输入或者返回函数的函数称为高阶函数。把一个函数作为一个值对待是一种程序设计风格，在函数式程序设计范式中被广泛使用，我们将在12.3节中介绍。

Python支持高阶函数，因为函数的名称与其他对象的名称没有什么区别，因此可以将其视为一个值。并非所有语言都支持高阶函数。其他一些支持高阶函数的语言包括LISP、Perl、Ruby和JavaScript。

练习题10.7　使用函数recMap()编写一个简单的语句，对一个二维数值列表table中的行之和进行求值，结果保存在一个列表中。