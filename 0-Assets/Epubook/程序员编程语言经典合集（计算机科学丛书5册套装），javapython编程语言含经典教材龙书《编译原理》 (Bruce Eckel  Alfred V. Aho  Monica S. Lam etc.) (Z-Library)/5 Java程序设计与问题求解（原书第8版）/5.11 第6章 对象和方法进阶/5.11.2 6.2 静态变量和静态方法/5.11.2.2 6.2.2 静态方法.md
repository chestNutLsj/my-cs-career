   

### 6.2.2　静态方法

有时，我们想让某个方法与任何种类的对象都没有关联。例如，我们可能需要一个计算两个整数中最大值的方法，或者是一个计算平方根的方法，抑或是一个将字母从小写转换为大写的方法。对于这些方法而言，不存明显的其应该归属的对象。在这种情况下，我们可以将这些方法定义为静态的。在定义静态方法时，该方法仍旧是类的成员，因为我们是在类中定义它的，但是这个方法可以在不使用任何对象的情况下就被调用。正常情况下，我们会用类名而不是对象名来调用静态方法。

例如，程序清单6.5中包含了一个名为DimensionConverter的类，它定义了两个静态方法，用于在英尺长度与英寸长度之间转换。可以按照与定义其他任何方法都相同的方式来定义静态方法，但是在方法头中要添加关键词static。

程序清单6.5　静态方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10348.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10349.jpeg)

下面的例子展示了如何调用这两个方法：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10350.jpeg)

在调用静态方法时，需要编写类名而不是对象名。程序清单6.6展示了这些方法在完整程序中的用法。尽管可以创建一个DimensionConverter类的对象，然后使用它来调用这个类中的这两个静态方法，但是这么做会对阅读代码的程序员造成困惑。

牢记：由静态方法构成的类

我们可以创建一组静态方法来执行彼此间存在一定关联的计算任务，并将它们群组到单个类中。

程序清单6.6　使用静态方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10351.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10352.jpeg)

在程序清单6.5的DimensionConverter类中，具名常量和两个方法都是静态且公有的。（如果我们不想让具名常量INCHES_PER_FOOT在这个类的外部仍旧可以访问，那么确实可以将其声明为私有的。）尽管这个类没有声明任何实例变量，但是一个类中可以同时拥有实例变量、静态变量、静态常量、静态方法和非静态方法。尽管有可能存在这种组合方式，但是我们确实需要仔细处理。

让我们来审视程序清单6.7中的SavingAccount类，以此来研究类中各种静态和非静态成员之间的交互方式。这个类用于维护个人存款账户的余额，因此声明了一个实例变量balance。由于所有账户都按照相同的利率赚取利息，所有这个类有一个静态变量interestRate。这个类还使用了静态变量numberOfAccounts来记录开户数。

程序清单6.7　在类中混合了静态和非静态成员

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10353.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10354.jpeg)

这个类具有针对利率的静态的设置和获取方法，针对账户数量的获取方法，以及存钱、取钱、追加利息和获取账户余额等非静态的方法。最后，该类还具有显示任何给定存款账户余额的静态方法。

在静态方法的定义内部，不能引用实例变量。因为静态方法在不使用任何对象名的情况下就可以被调用，所以没有任何实例变量可以引用。例如，静态方法setInterestRate可以引用静态变量interestRate，但是不能引用实例变量balance，因为它不是静态的。

静态方法（这里要记住，main就是静态方法）如果在调用时未使用类的实例，那么就不能调用非静态方法。例如，静态方法showBalance有一个参数是SavingsAccount对象，它用该对象来调用非静态方法getBalance。showBalance唯一可以获取某个账户余额数据的方式就是从表示该账户的对象中获得。

非静态的addInterest可以引用静态变量interestRate，或者调用静态方法get-InterestRate。可以选择在getInterestRate调用的方法名前面放上类名和圆点，因为这些方法都在SavingsAccount类中。注意，构造器也不是静态的，它会递增静态变量numberOfAccounts，从而对其被调用的次数计数，也就是对新创建的账户对象计数。

程序清单6.8展示了用于演示SavingsAccount类的样例程序。因为我们使用了一个double变量来表示账户的余额，所以屏幕输出的美元数额中，有一个看起来不那么齐整。在本章稍后，我们将对这种情况进行修正。

程序清单6.8　使用静态和非静态方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10355.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10356.jpeg)

疑难杂症：在静态方法内部调用非静态方法

你经常听到人们说：“不能在静态方法的定义中调用非静态方法。”但是，事实并非完全如此。更准确也更正确的说法应该是：“不能在静态方法中调用非静态方法，除非你有一个可以用于调用该非静态方法的对象。”换句话说，在静态方法的定义中，例如在main中，我们不能使用隐式或显式地将this作为其调用对象的实例变量或实例方法。因为静态方法可以在无须任何调用对象的情况下被调用，所以当this没有任何意义时，它也可以被调用。套用格特鲁德·斯坦的话，在静态方法中，“没有this的位置。”

回顾：静态方法

如果将关键词static置于某个方法定义的头部时，该方法就可以用类名而不是对象名来调用。因为在对静态方法的调用中无须任何对象，所以静态方法不能引用其所属的类中的实例变量。静态方法也不能调用其所属的类中的非静态方法，除非该静态方法中有一个其所属类的对象，并且它使用了该对象来调用非静态方法。换句话说，静态方法的定义不能使用实例变量或将隐式或显式的this作为其调用对象的非静态方法。

自测问题

6.静态变量和实例变量之间的差异是什么？

7.一个类是否可以同时包含实例变量和静态方法？

8.是否可以在静态方法的定义中不使用类名和圆点而只通过名字来引用静态变量？

9.是否可以在静态方法的定义中不使用类名或对象名以及圆点而只通过名字来引用实例变量？

10.是否可以在非静态方法的定义中不使用类名和圆点而只通过名字来引用静态变量？

11.是否可以在非静态方法的定义中不使用类名或对象名以及圆点而只通过名字来引用实例变量？

12.在程序清单6.5的DimensionConverter类中，下面的代码是否合法？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10357.jpeg)

13.一个类是否可以同时包含静态和非静态方法？

14.是否可以在静态方法中调用非静态方法？

15.是否可以在非静态方法中调用静态方法？

16.在程序清单6.7的SavingsAccount类中，下面的代码是否合法？

![](../Images/image10358.gif)