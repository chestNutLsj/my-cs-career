   

### 4.1.5　for语句

for语句（或者称为for循环）使得我们可以很容易地编写出由某种计数器控制的循环。例如，下面的伪代码定义了一个需要迭代3次的循环，它由计数器count来控制：

针对从1到3的count的每个取值，执行下面的操作：

　显示count

这段特定的伪代码可以用Java表示成下面的for语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09971.jpeg)

这条for语句会产生下面的输出：

![](../Images/image09972.gif)

在for语句终止后，会执行循环体之后的语句。

在这第一个for语句示例中，循环体是：

![](../Images/image09973.gif)

该循环体的迭代由下面的代码控制：

![](../Images/image09974.gif)

圆括号中三个表达式的第一个（即count=1）说明了循环体第一次执行之前所发生的事情。第三个表达式（即count++）会在循环体的每次迭代之后执行。中间的表达式（即count<=3）是一个用来确定循环何时终止的布尔表达式，它与while循环中的控制布尔表达式的工作方式是相同的。因此，循环体会在count的值小于等于3时执行。也就是说，下面的for语句：

![](../Images/image09975.gif)

等价于

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09976.jpeg)

for语句的语法如下：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09977.jpeg)

Body可以是一条简单语句，就像第一个示例一样，但是更有可能是一条复合语句。因此，for循环更通用的形式可以描述成下面的样子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09978.jpeg)

当for语句执行时，等价于包含while循环的语句。因此，之前形式的for语句等价于下面的语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09979.jpeg)

因为for语句基本上像是while循环的另一种表示形式，所以for语句，就像while语句一样，可以压根不重复其循环体。

程序清单4.5展示了一个for语句的示例，其动作总结在图4.5中。图4.6在总体上描述了for循环的语义。

程序清单4.5　一个for语句的示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09980.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09981.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09982.jpeg)

图4.5　程序清单4.5中for循环的动作

回顾：for语句

语法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09983.jpeg)

Body可以是单条语句，但是更有可能是由{}括起来的一组语句构成的复合语句。注意，圆括号内的三项是由2个而不是3个分号隔开的。

示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09984.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09985.jpeg)

图4.6　for语句的语义

疑难杂症：循环语句中多余的分号

下面的代码看起来非常普通。而且，它可以编译和运行，不会产生任何错误消息。但是，它包含了一个错误。在继续往下读之前，看看你是否能够发现这个错误。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09986.jpeg)

![](../Images/image09987.gif)

如果将这个代码放到程序中，然后运行这个程序，其输出将会如下所示：

![](../Images/image09988.gif)

现在，你是否能够看出错在哪儿了？在继续往下读之前，试着解释这个问题。

如果去测试这个输出令人十分困惑的程序，会让你觉得很迷茫。很明显，for循环中有错误，但到底是什么呢？for循环原本是要将product的值设置为等于下面的值：

![](../Images/image09989.gif)

但是，它将product的值设置成了等于11。这是怎么发生的呢？

问题在于一个很小的拼写错误，在第一行的末尾，for语句多了一个分号：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09990.jpeg)

这个for语句会做些什么呢？末尾的分号表示for语句的循环体为空。分号本身被认为是不执行任何操作的语句，称为空语句或null语句。这条带有多余分号的for语句等价于：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09991.jpeg)

因此，这条for语句的循环体实际上执行了10次，但是，每次执行时，循环除了将变量number的值递增1之外，没有做任何事情。导致当程序执行到下面的语句时，number等于11：

![](../Images/image09992.gif)

（记住，number的起始值为1，每次递增1，共递增10次，因此它的值变成了11）。因为product仍旧是1，而number等于11，所以赋值语句将product的值乘以11作为输出。为了修正这个问题，直接将for起始行末尾多余的分号移除即可。

相同的问题也可能会发生在while循环中。下面的while循环与之前陷入麻烦的for循环具有相同的问题，但是其结果更加糟糕：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09993.jpeg)

![](../Images/image09994.gif)

多余的分号结束了while循环，因此，while循环的循环体是空语句。因为循环体是空语句，所以在每次循环迭代时，不会发生任何事情。因此，number的值永远都不会改变，而条件

![](../Images/image09995.gif)

永远为真。因此，该循环是一个不执行任何操作并且会永远执行下去的无限循环。