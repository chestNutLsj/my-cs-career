   

# 附录F　C++和Java之间的区别

本附录针对的是具有丰富的C或C++编程经验的读者。其他读者可以忽略本附录。

Java和C++看起来很相似，但是它们的差异绝对比你将这两种语言粗略比较后发现的差异多得多。我们并不会在本附录中描述所有的差异，但是我们会审视它们的若干相似性与差异，以帮助你从C++（C）过渡到Java。

F.1　基本类型

Java具有大多数与C和C++相同的基本类型（int、short、long、float、double和char），但是Java还添加了byte和boolean类型。Java的boolean类型对应于C++的bool类型。Java没有名为long double的类型。除非使用C++11中引入的基本数据类型，否则，在Java中，对具体的基本类型的值以字节为单位的尺寸都做了完整地规定，并且独立于具体实现。请查阅第2章以了解其中的细节。

F.2　字符串

与C和C++的某些版本不同，在Java中，字符串不是特殊种类的字符数组。Java有一个作为预定义类型的String类。String有些类似于C++最近版本中的string类。（对String类的讨论是从第2章开始的。）

F.3　控制流

Java中的控制结构（if-else、switch、while、do-while和for）与C和C++相同。但是，Java中有些差异可能会影响到对控制结构的使用。特别是，Java没有逗号操作符；Java中的boolean类型不是数字类型，并且它的值也不能类型强制转换为数字类型；Java中的赋值操作符的行为比C和C++更好。我们将在下面简要地讨论这些差异。

Java没有逗号操作符。但是，Java中的for语句被定义为允许使用逗号，如下面代码所示：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11480.jpeg)

这个“逗号操作符”只能在for语句中使用。

在Java中，boolean类型有两个值——true和false，它们不能被解释为数字值，即使通过类型强制转换也不行。

C和C++中经典的错误是该使用==时使用的是=，如下面代码所示：

![](../Images/image11481.gif)

在C和C++中，表达式n=42返回的要么是值42，要么会转换成布尔值，这取决于你使用的C或C++的版本。在Java中，n=42也会返回值42，但是在Java中，42不是boolean类型的，也不能转换为boolean类型。因此，在Java中，这个错误会产生一条编译器错误消息。

F.4　测试相等性

在Java中，测试类类型的对象的相等性会有些麻烦。对于基本类型的值，如你所预期的，==操作符会测试相等性。但是，当使用==比较两个类类型的对象时，比较的是对象的地址而不是数据。Java类经常会定义一个名为equals的方法，用来测试我们直观概念中的相等性。在Java中，你不能重载==操作符（或任何其他的操作符）。

F.5　main方法（函数）和其他方法

在Java中，将函数称为方法。Java中的main方法的作用与C或C++中的main函数的作用相同。在Java中，main方法头总是像下面这样：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11482.jpeg)

在Java中，所有方法都是在类内部定义的，就像其他任何种类的代码一样。

F.6　文件和包含文件

Java没有#include指令，但是它有import语句，使得你可以导入在你的类中需要用到的一个类或整个包（库）。

Java程序的一般结构会包含许多类，每个类都在其自己的文件中。如果所有这些类都在同一个文件夹（目录）中，Java会在其需要某个类时自动地找到这个类（文件）。import语句还使得从不同文件夹中组合多个类（文件）成为可能。请查阅第6章的6.7节以了解更多的细节。

在Java中，类必须在与其名字相同的文件中，但是后缀为.java。例如，名为MyClass的类必须在名为MyClass.java的文件中。将这个类编译过的版本放到了名为MyClass.class的文件中。

F.7　类和方法（函数）定义

在Java中，所有方法都必须在某个类中定义。此外，类定义可以在一个文件中完整地定义。Java与C和C++不同，它没有任何头文件，即.h文件。特别是，所有的方法定义都是在它们的类定义中作为整体给出的。请查阅第5章以了解更多的细节。Java还提供了接口，它在形式上类似于C和C++中的头文件，但是它们作用不同。第8章介绍了Java接口。

F.8　Java中没有任何指针类型

在Java中，没有任何指针类型。但是，Java中有指针，实际上，所有对象都是通过指针来命名的。但是，这些指针称为引用，并且它们会被自动地处理。例如，String类型的变量包含一个对字符串的引用（指针），但是没有任何类型表示指向String的指针。请查阅第5章的5.3节以了解更多的细节。

F.9　方法（函数）参数

严格地讲，Java只有一种参数传递机制，即按值调用。但是，在实践中，Java的参数传递机制在行为上针对像int、double和char这样的基本类型时是一种方式，针对类类型时是另一种方式。

对于基本类型，按值调用参数机制的行为符合C和C++程序员的预期。即，参数包含了对应的引元的值。但是Java类类型的参数包含的是对要传递的类对象的引用。这使得方法（函数）可以修改对象中的数据，因此，有人认为这种机制是按引用调用机制。它并不满足最常见的按引用调用的定义，但是在执行大多数简单任务时，它的行为都非常像按引用调用。请查阅第5章以了解更多的细节。

F.10　数组

Java数组与C或C++数组非常像，但是仍旧有些差异，并且Java数组的行为更好。Java中的数组“知道”其范围。如果a是一个数组，那么实例变量a.length就包含了一个表示数组可以持有的元素数量的整数。Java会确保数组索引的值（下标）是有效的，如果你的代码试图使用超出范围的数组索引，就会抛出异常。请查看第7章以了解更多的细节。

F.11　垃圾回收

在Java中，内存管理和垃圾回收是自动执行的。Java使用了new操作符来创建类类型的新对象并为其分配内存。这是唯一显式分配内存的方式。此外，Java还提供了自动垃圾回收，将程序员从这项职责中解脱了出来。内存泄露在C和C++中可能会是个问题，但是在Java中完全不是事。

F.12　其他比较

·Java和C++中的注释本质上是相同的。

·Java中没有全局变量。

·Java没有typedef。

·Java没有结构体和联合体。

·你可以重载Java中的方法（函数）名，就像在C++中一样，但是你不能重载Java中的操作符。

·Java没有多重继承，但是接口提供了多重继承的许多功能。请查阅第8章以了解有关接口的更多细节。

·Java没有模板，但是它有可以替代的泛型。请查阅第12章对泛型的介绍。

·在Java中，类可以有这样一个构造器，它的参数具有与该类相同的类型，但是这个构造器与C++中的复制构造器不同，它没有任何特殊的状态。

·Java没有析构器。

·C++中的赋值操作符在用于将一个对象复制给另一个对象时，执行的是实例变量的浅复制。在Java中，只会复制对对象的引用。