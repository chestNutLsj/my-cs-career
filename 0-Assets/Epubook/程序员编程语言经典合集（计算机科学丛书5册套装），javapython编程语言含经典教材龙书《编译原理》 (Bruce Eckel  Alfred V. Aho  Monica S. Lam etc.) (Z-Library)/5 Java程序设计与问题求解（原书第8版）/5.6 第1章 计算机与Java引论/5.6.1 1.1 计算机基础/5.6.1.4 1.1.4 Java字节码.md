   

### 1.1.4　Java字节码

Java编译器并没有将程序转译为特定计算机上的机器语言，而是将Java程序转译成了被称为字节码的语言。字节码不是任何特定计算机上的机器语言，而是被称为虚拟机的假想计算机上的机器语言。虚拟机与任何特定的计算机都不完全相同，但是它与所有典型的计算机类似。将字节码程序转译为真实计算机上的机器语言非常容易，执行这种转译的程序是一种被称为Java虚拟机（JVM）的解释器。JVM会转译并执行Java字节码。

为了在你的计算机上运行Java程序，需要执行以下步骤：首先，使用编译器将Java程序转译为字节码；然后，使用你的计算机系统特定的JVM来将每条字节码指令转译为机器语言，并运行这些机器语言指令。整个过程如图1.3所示。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09439.jpeg)

图1.3　编译并运行Java程序

新的JVM实现使用了即时编译（Just-in-Time，JIT）编译器。JIT编译器会按块读取字节码，并将整块字节码根据需要编译为本地的机器语言。会保存编译后的机器语言指令以备后续使用，因此每块代码都只需要编译一次。这种模型通常在运行程序时比解释器模型快，因为它会不断地将下一条字节码指令编译成机器码。

听起来好像Java只是额外增加了一个处理步骤。为什么不编写直接将Java转译为特定计算机系统上的机器语言的编译器呢？这样做是可以，许多其他编程语言就是这么做的，而且这样做通常会产生运行得更快的机器语言程序。但是，Java字节码赋予了Java一个很重要的优势，那就是可移植性。在将Java程序编译成字节码之后，就可以在任意一台计算机上运行这些字节码了。如果要在另一台计算机上运行该程序，并不需要重新编译它。这意味着我们可以将字节码在互联网上发送给另一台计算机，并且可以很容易地在这台计算机上运行该程序，无须关心它安装的是什么操作系统。这就是Java长于互联网应用开发的原因之一。

可移植性还有其他的优势。当某个制造商生产了一种新型的计算机系统时，Java的创造者们无须为其设计一种新的Java编译器。只需一种Java编译器即可在所有计算机上工作。当然，每种类型的计算机都必须安装适用于自己的字节码解释器，即JVM，这些解释器会将字节码指令转译成特定类型计算机上的机器语言指令，但是这些解释器与编译器相比，算是很简单的程序了。因此，Java可以非常迅捷并且非常省事地添加到新的计算机系统中。

回顾：字节码

Java编译器会将Java程序转译成被称为字节码的语言。这种字节码不是任何特定计算机上的机器语言，但是与大多数通用计算机的机器语言都相似。字节码很容易转译为给定计算机上的机器语言。每种类型的计算机都有自己的翻译器，称为解释器，它会将字节码指令转译为该计算机上的机器语言指令。

尽管了解Java字节码很重要，但是在日常的编程中，我们却意识不到它的存在。通常我们需要给出两条命令，一条用来将Java程序编译为字节码，另一条用来运行程序。运行命令告诉字节码解释器去执行字节码，可以称为“run”或任何其他名字，但是不太可能称为“interpret”，因为你以后会习惯于将运行命令看作是运行编译器所产生的程序，但是不会将其看作是将字节码转译为机器语言。

常见问题：为什么称其为字节码？

低级语言的程序（例如字节码和机器语言码）是由指令构成的，每条指令都可以存储在若干个存储器字节中。典型情况下，在每条指令中，一个字节可以包含一个操作码，它指定了要执行的操作。单字节操作码这种概念就是字节码这个术语的由来。