   

### 2.1.10　类型强制转换

本小节的标题（type casting）与其在好莱坞电影中意指角色定型的演员不同。事实上，它们的意思几乎完全相反。在Java以及几乎所有的编程语言中，类型强制转换（type cast）都会将值的数据类型从其正常的类型转换为另一种类型。例如，将值2.0的类型从double转换为int就是一种类型强制转换。上一节中提到，我们可以将一种类型的变量赋值给另一种类型的变量，其中类型转换会自动发生。在所有其他情况中，如果想要将一种类型的值赋值给另一种类型的值，必须执行类型强制转换。我们来看看在Java中是如何做的。

假设有下面的语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09545.jpeg)

正如上面注释所表示的，后面这条语句在Java中是非法的。不能将double类型的值赋值给int类型的变量，即使double类型的值在小数点后面全部为0，从而在概念上表示整数，也是如此。

为了将double类型的值赋值给int类型的变量，必须将（int）置于这个值的前面，或者置于持有这个值的变量的前面。例如，可以用下面的语句来替换上面那条非法的语句，从而得到一条合法的赋值语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09546.jpeg)

表达式（int）distance称为类型强制转换。distance和存储在distance中的值都没有以任何方式改变。但是存储在points中的值是存储在distance中的值的“整数版本”。如果distance的值是25.36，那么（int）distance的值就是25。因此points包含25，但是distance的值仍旧是25.36。如果distance的值是9.0，那么赋给points的值就是9，而distance的值仍旧保持不变。

像（int）25.36或（int）distance这样的表达式是可以产生int值的表达式，类型强制转换不会改变源变量中的值。这种情况类似于计算你手上一把钱凑成的整美元的数目。例如，如果你有25.36美元，那么你就有25整美元。25.36美元本身并没有发生变化，它只是用来产生25整美元这个数量。

例如，考虑下面的代码：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09547.jpeg)

表达式（int）dinnerBill产生的值是25，因此这段代码的输出是：

![](../Images/image09548.gif)

但是dinnerBill变量包含的值仍旧是25.36。

千万要注意，在使用类型强制转换将double值或变量为int，或者从任何浮点类型强制转换为整数类型时，执行的不是四舍五入，小数点后的部分会直接被丢弃，这称为截尾。例如，下面的语句

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09549.jpeg)

会将numberOfDollars设置为26，而不是27，这不是四舍五入的结果。

正如之前提到的，在将整数值赋值给浮点类型的变量（例如double类型）时，整数会自动地强制转换为变量的类型。例如，下面的赋值语句

![](../Images/image09550.gif)

等价于

![](../Images/image09551.gif)

类型强制转换（double）在上面第一个版本的赋值语句中是隐式的，但是，第二个版本也是合法的。

回顾：类型强制转换

在许多情况中，我们无法将某种类型的值存储到另一种类型的变量中，除非使用类型强制转换将这个值转换为与目标类型等价的值。

语法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09552.jpeg)

示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09553.jpeg)

存储在answer中的值为7。注意，这个值是截尾的值，而不是四舍五入的值。还要注意，变量guess并未以任何方式发生改变，仍旧是7.8。最后一个赋值语句只会影响存储在answer中的值。

编程窍门：将字符类型强制转换为整数

Java有时会将char类型当作整数处理，但是将整数赋值给字符的操作与字符表示的意义并无任何关联。例如，下面的类型强制转换会产生对应于字符'7'的int值：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09554.jpeg)

你也许认为上面的语句会显示7，但是并非如此，它显示的是55。Java像所有其他编程语言一样，使用了一种随意的编号机制来对字符进行编码。这样，每个字符就对应于一个整数。在这种对应关系中，数字0到9是与字母或加号一样的字符，而让数字对应于它们直观表达的值是件毫不费力的事情。但是，这种编码机制的设计者基本上就是写下所有的字符，然后按照字符写下的顺序对它们编号。字符'7'碰巧就是55。这种编码机制被称为Unicode系统，我们将在本章稍后部分讨论它。如果你听说过ASCII编码系统，那么Unicode系统与ASCII系统对于英语中的字符而言是完全一样的。

自测问题

1.下面哪些可以用作Java中的变量名？

![](../Images/image09555.gif)

2.在一个Java程序中，是否可以有两个名为aVariable和avariable的变量？

3.给出名为count、类型为int的变量的声明。该变量应该在声明中初始化为0。

4.给出两个double类型变量的声明，这两个变量的名字为rate和time。这两个变量都应该在声明中初始化为0。

5.编写名为miles和flowRate的两个变量的声明。声明变量miles为int类型，并在声明中将其初始化为0。声明变量flowRate为double类型，并在声明中将其初始化为50.56。

6.具名常量的常见拼写惯例是什么？

7.给出表示一天中有多少小时的具名常量的定义。

8.编写一条Java赋值语句，将变量interest的值设置为变量balance的值乘以0.05。

9.编写一条Java赋值语句，将变量interest的值设置为变量balance的值乘以变量rate的值。这些变量的类型都是double。

10.编写一条Java赋值语句，将变量count的值递增3。该变量的类型为int。

11.下面的程序代码会产生什么样的输出？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image09556.jpeg)

12.在编程窍门“将字符类型强制转换为整数”中，你看到过下面的代码显示的不是整数7：

![](../Images/image09557.gif)

因此，（int）symbol不会产生对应于symbol中存储的数字位所对应的数字。你是否能够编写一个表达式，它可以产生与symbol中存储的数字位直观对应的整数？假设symbol包含0到9这10个数字位中的一个。（提示：这些数字位确实对应于连续的整数，因此如果（int）'7'是55，那么（int）'8'就是56。）