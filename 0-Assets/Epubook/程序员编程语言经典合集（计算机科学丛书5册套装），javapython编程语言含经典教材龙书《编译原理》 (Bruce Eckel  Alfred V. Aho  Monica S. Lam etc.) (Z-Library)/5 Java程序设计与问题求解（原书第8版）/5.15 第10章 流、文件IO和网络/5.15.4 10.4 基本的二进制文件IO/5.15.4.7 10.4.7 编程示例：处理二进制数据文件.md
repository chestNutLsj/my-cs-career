   

### 10.4.7　编程示例：处理二进制数据文件

程序清单10.8包含的程序对数据执行了一些简单的处理。它让用户输入两个文件名，从输入文件中读取数字，将它们翻倍，然后将所产生的数字写入输出文件。这个编程任务不是特别复杂，但是它使用了许多标准的处理文件I/O的编程技术。特别是要注意，连接到文件的流对象的变量是实例变量，并且该任务被分解为多个子任务，这些子任务被分配给了不同的方法去处理。

程序清单10.8　处理二进制数据文件

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11159.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11160.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11161.jpeg)

我们让try块变得很小，使得在抛出异常时，可以在附近的catch块中捕获它。如果我们的try块更少一些，当然也就更大一些，那么确定到底是哪部分代码抛出了异常就会变得更困难一些。

疑难杂症：异常、异常，还是异常

对于许多情况而言，在操作文本文件时在I/O过程中不会抛出异常，而在操作二进制文件时就会抛出异常。因此，与操作文本文件相比，在操作二进制文件时，需要执行更多的异常处理。例如，关闭与PrintWriter类型的流相连接的文本文件不会引发异常。但是，关闭我们之前讨论过的类型的二进制流时，就可能会引发IOException异常。在按照我们之前描述过的方式执行二进制文件I/O时，几乎所有操作都可以引发异常。并且，writeObject和readObject方法可能会抛出一长串的异常，如图10.5和图10.6所示。

自测问题

22.假设你想要创建一个输入流，并将其与名为mydata.dat的文件连接起来。下面的代码是否可以工作？如果不行，你应该如何编写类似的代码使其可以工作？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11162.jpeg)

23.FileInputStream类是否具有名为readInt的方法？是否具有名为readDouble的方法？是否具有名为readUTF的方法？

24.FileOutputStream类是否具有接受文件名作为引元的构造器？

25.ObjectOutputStream类是否具有接受文件名作为引元的构造器？

26.当以本章所讨论的方式打开二进制文件用于输出时，可能会抛出什么异常？抛出什么类型的异常？如果打开二进制文件用于输入而不是输出，这些问题的答案又是什么？

27.假设一个二进制文件中正好包含3个用ObjectOutputStream类的writeDouble方法写入的数据，再假设你编写了一个用对ObjectInputStream类的readDouble方法的三次调用来读取这3个数字的程序。如果你的程序第四次调用readDouble，会发生什么？

28.下面的代码出现在程序清单10.7的程序中：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11163.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11164.jpeg)

为什么这段代码实际上并不包含无限循环？

29.编写一个完整的Java程序，在屏幕上显示名为temperatures.dat的二进制文件中的所有数字，每行一个。假设整个文件都是用writeDouble方法写入的。