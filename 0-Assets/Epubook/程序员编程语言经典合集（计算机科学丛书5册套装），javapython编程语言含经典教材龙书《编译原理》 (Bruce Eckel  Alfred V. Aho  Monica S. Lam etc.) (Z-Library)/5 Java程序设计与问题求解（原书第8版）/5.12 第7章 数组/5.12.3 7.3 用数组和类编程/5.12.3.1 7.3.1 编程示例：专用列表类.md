   

### 7.3.1　编程示例：专用列表类

有一种将数组用于专用目的的方式是让数组成为类的实例变量。这种数组只能通过类的方法来访问，因此我们可以添加任何想要的检查和自动处理。这使得我们可以定义其对象就像是专用数组的类。在这个编程示例中，我们将呈现一个这样的类的示例。

我们将定义一个其对象可用来保存数据项列表的类，例如购物列表或待办事项列表。这个类有一个相当长的名字：OneWayNoRepeatsList[^1]。

OneWayNoRepeatsList类有一个向列表中添加项的方法。列表中的项是字符串，在应用程序中用来说明你想让这些项表示什么，例如“Buy milk”。这个类没有任何修改单个项或者从列表中删除项的方法。但是，它有一个方法使我们可以擦除整个列表，从空列表从头再开始操作。每个OneWayNoRepeatsList类的对象对于能够存储的项的数量都有一个最大上限。任何时刻，列表中都可以包含从0到该最大上限之间的某个数量的项。

OneWayNoRepeatsList类的对象有一个作为实例变量的字符串数组，这个数组持有列表中的项。但是，我们无法直接访问该数组，而是需要使用访问器和修改器方法。我们可以使用int变量来保存表示列表中位置的编号。这些int变量和索引是同一回事，但是所保存的位置是从1而不是0开始编号的。例如，名为getEntryAt的方法可以获取给定位置的项。如果toDoList是OneWayNoRepeatsList类的对象，那么下面的语句就会将字符串变量next设置为第二个位置上的项：

![](../Images/image10627.gif)

其他方法可以在列表末尾添加一项或者擦除整个列表。这些方法就是仅有的能够修改列表的途径。我们不能修改或删除列表中特定的项，也不能在除列表末尾之外的其他任何位置添加项。

在第5章，我们讨论过封装。OneWayNoRepeatsList类就是一个封装良好的类的例子，因为它向使用它的用户隐藏了其细节。但是很明显，程序员需要知道如何使用这个类。因此，在给出定义之前，告诉用户如何使用这个类就显得很有意义了。

程序清单7.8包含的程序演示了如何使用OneWayNoRepeatsList类的一些方法。注意，构造器接受的是整数引元。这个整数指定了可以在列表中放置的最大项数，这个数字在我们的演示中取值很小。

addItem方法会将一个字符串添加到列表的末尾。例如，下面的语句将变量next命名的字符串添加到了列表toDoList的末尾：

![](../Images/image10628.gif)

如果查看程序清单7.8中的样例输出，就会发现将Buy milk向列表中添加了两次，但是它在列表中只出现了一次。如果待添加的项已经位于列表中，那么addItem方法就不会产生任何效果。这种方式可以使得列表中不包含任何重复项。

程序清单7.8　使用OneWayNoRepeatsList类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10629.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10630.jpeg)

可以使用一个int变量来从头到尾地遍历列表，这种技术展示在程序清单7.8的末尾。可以从将int变量初始化到列表第一个位置入手，就像下面这样：

![](../Images/image10631.gif)

具名常量toDoList.START_POSITION就是1的另一个名字，但是使用它是因为我们将其看作列表的开头，而不是数字1。我们可以调用getEntryAt方法来获取列表中给定位置的项。例如，下面的语句将字符串变量next设置为等于由变量position所给定位置的字符串：

![](../Images/image10632.gif)

为了获取列表中的下一项，该程序直接递增了position的值。下面从程序清单7.8中抽取的代码演示了如何遍历列表：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10633.jpeg)

当position的值递增后超过列表中最后一个位置时，在position处就不会有任何项。因此，我们需要某种方式来便捷地表示已经到达列表的末尾。否则，就会访问到该数组未使用部分中的某些“垃圾”值。为了小心处理此问题，我们让getEntryAt在给定位置没有任何项时返回null值。注意，null有别于任何实际的字符串，所以它不可能出现在任何列表中。因此，程序可以通过检查null值来测试是否到达了列表末尾。回忆一下，测试与null相等或不等时，使用的是==和！=，而不是equals方法。

程序清单7.9给出了OneWayNoRepeatsList类的完整定义。列表中的项都存储在实例变量entry中，它是一个基类型为String的数组。因此，列表中可以存储的最大项数就是entry.length。但是，列表在正常情况下不会填满，因此它包含的项数会少于entry.length项。为了跟踪数组entry中当前用到的项数，该类还有一个名为countOfEntries

的实例变量。这些项本身存储在索引变量entry[0]、entry[1]、entry[2]直至entry[countOfEntries-1]中。索引为countOfEntries或更高值的元素的值就是垃圾值，它们并不表示列表中的值。因此，当遍历列表中的项时，应该在遍历到entry[countOf-Entries-1]项之后停止。

例如，isOnList方法定义中有一个遍历该数组的while循环，它会检查其引元是否等于列表中的某个项：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10634.jpeg)

这段代码只检查所有小于countOfEntries的数组元素，而不会检查数组中其余的元素，因为那些数组项并不在列表中。

完整的OneWayNoRepeatsList类包含的方法比我们在程序清单7.8的演示程序中用到的方法要多一些。这些额外的方法使得这个类对于更广泛的应用而言会显得更有用。

注意，尽管数组entry的索引从0开始，但是如果我们使用一个int变量作为位置标记，例如程序清单7.9中的变量position，那么编号就可以从1而不是0开始。该类的方法会自动调整索引，因此，当我们想要获取位于position处的项时，得到的就是entry[position-1]。当然，我们会通过在数组entry中额外分配一个元素并忽略entry[0]的方式来弥补数组索引和列表位置之间的差，就像7.1.4节的末尾所建议的那样。上一节末尾的练习14就是要让你这么做。

程序清单7.9　包装在类中表示列表的数组

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10635.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10636.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10637.jpeg)

注意，OneWayNoRepeatsList类假设你使用了int变量position来访问列表中的项，在此基础上，它提供了三种探测列表末尾的方式：

·如果position等于getNumberOfEntries（），那么position就是最后一项的位置。

·如果atLastEntry（position）返回true，那么position就是最后一项的位置。

·如果getEntryAt（position）返回null，那么position就是最后一项的位置。

在结束这个编程示例之前，我们再提醒一下，Java类库包含的ArrayList类可以用来创建比这里所使用的列表更通用且更灵活的列表。就像类一样，ArrayList也使用了数组来表示列表。第12章将向你介绍这个类，但是如果你愿意，可以直接跳到那里，现在就阅读它。

自测问题

15.将程序清单7.8中最后一个循环替换为使用列表中项数的for循环。

16.将程序清单7.8中最后一个循环替换为使用atLastEntry方法的循环。

[^1]:  长名字是Java的传统，但是我们选择长名字并非只是为了传统。所有的短名字（例如Collection或List）在Java中都已经具有含义了，将这些短名字用于它们通常含义之外的事物会产生混淆。