   

### 12.5.1　用场景构建器构建JavaFX应用程序

当直接编码布局面板时，构建复杂界面可能会显得单调乏味且难以可视化。为了辅助UI开发，Oracle发布了JavaFX场景构建器。如果你正在使用IDE，那么场景构建器可能已经安装到你的系统上了。Oracle不再发布场景构建器的二进制可执行版本了（你必须通过对源码编译而得到它），但是你可以从Gluon实验室的网站[http://gluonhq.com/labs/scene-builder](http://gluonhq.com/labs/scene-builder)上下载免费的二进制版本。查询你的IDE文档，看看需要怎么样的配置才能集成JavaFX场景构建器。在撰写本书时，Gluon场景构建器最新的版本是8.2。

场景构建器使得程序员或UI设计者可以以图形化的方式构建界面，并且可以快速地测试UI控件的布局。当使用场景构建器时，在典型情况下会将JavaFX应用分解为至少3个单独的文件，每个都用来处理程序中不同的方面：

1）FXML文件。这是一个由场景构建器创建的可扩展标记语言（XML）文件，描述了场景中各个节点的布局。下面给出了一个FXML样例文件，它包含了一个VBox，在该VBox内部，包含了文本域、按钮和标签。尽管我们可以人工创建这个文件，但是正常情况下，它是用场景构建器生成的。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11422.jpeg)

![](../Images/image11423.gif)

2）应用文件。这是一个包含了start方法的JavaFX的Java源文件。当与FXML一起使用时，start方法只是用FXMLLoader类加载了FXML文件。

3）控制器文件。这个文件包含一个实现了javafx.fxml.Initializable的类以及响应UI控件的事件处理器。

如果正在使用的IDE包含场景构建器，那么可以查询IDE的文档以了解如何创建新的JavaFX FXML应用项目。否则，可以在下载并安装场景构建器应用后直接启动它。图12.13展示了一个场景构建器，它是在将一个AnchorPane从“Containers”部分中拖曳到窗口中间，然后将一个TextField、一个Button和一个Label从“Controls”部分中拖曳到窗口中之后形成的。我们可以通过在表单上点击控件或者通过在左下部的“Document”部分中的“Hierarchy”下面选择控件的名字来选中控件。后者对于像没有文本的标签这样的“不可视”控件而言很有用。一旦选中了某个控件，就可以在右侧“Inspector”窗口“Properties”部分中编辑其诸如文本或字体大小之类的属性。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11424.jpeg)

图12.13　用场景构造器来做UI设计

AnchorPane使得我们可以将控件的边固定在面板的边缘。如果窗口会缩放，那么这项功能就很有用。例如，如果我们想要在窗口缩放时让按钮适应整个窗口的宽度，那么就可以将其左右两个边都设置为锚位。图12.14展示了这种情况，其中按钮已经被选中，在“Inspector”的“Layout”部分的下面，锚位已经被设置为左边和右边。我们可以用主菜单中的“Preview”命令来查看测试结果。

为了加载由场景构建器创建的已经保存起来的FXML文件，需要使用FXMLLoader类。程序清单12.14展示了如何加载名为FXMLDocument.FXML的FXML文件。因为布局的细节在FXML文件中，所以在应用类中只需要非常少的代码。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11425.jpeg)

图12.14　在使用场景构建器2.0时设置按钮的锚位

程序清单12.14　用于FXMLDocument.FXML的JavaFX应用类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11426.jpeg)

接下来，我们需要一个Controller类来响应事件。程序清单12.15所示的名为JavaFX-AppController.java的类实现了按钮处理器，它会读取文本域中输入的数字，将其递增1，然后在标签中输出结果。这个类实现了Initializable接口，并且必须具有一个initailize方法，该方法可以用来初始化这个处理器。

为了将JavaFXAppController类中定义的变量与场景构建器创造的UI控件链接起来，需要在变量定义的前面放置@FXML注解，这样会从FXML加载器中注入必需的值。

程序清单12.15　用于JavaFXApp.FXML的JavaFX控制器类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11427.jpeg)

最后，我们需要将控制器与FXML文件链接起来。回到场景构建器，在场景构建器左下侧的“Controller”部分中选择包含该控制器的Java文件。在我们的示例中，该控制器的名字是JavaFXController.java。

接下来，依次选择每一个在控制器中具有相对应变量的UI控件。为了将控件链接起来，可以在右边的“Inspector”的“Code”部分中选择变量名，还可以选择事件处理器的方法。例如，在程序清单12.15中，我们将标签变量命名为lblNumber，而在场景构建器中，我们应该在表单上表示标签的fx：id域中输入相同的名字。

图12.15描述了将程序清单12.15中的控制器与场景构建器构造的FXML文件链接起来的过程。一旦执行了链接，Java程序就可以编译了，并且主应用就可以运行，产生像图12.15的程序输出中所示的输出。

自测问题

31.FXML文件的作用是什么？

32.需要向控制器添加什么东西才能将实例变量与FXML文件中对应的控件链接起来？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11428.jpeg)

图12.15　在场景构建器中与控制器链接起来