   

### 12.3.3　实现链表的操作

程序清单12.5包含了一个链表类的定义，它使用了程序清单12.4中给出的节点类定义。注意，这个新的类只有一个实例变量，其名字为head。这个head实例变量包含一个对该链表第一个节点的引用，如果该链表为空，即该链表中不包含任何节点，那么head包含的就是null。其唯一的构造器将这个head实例变量设置成了null，表示这是一个空链表。

在我们继续讨论节点如何被添加进或被移除出链表之前，让我们假设有一个已经有了若干个节点的链表，并且我们想要将所有节点的内容显示到屏幕上。我们可以通过编写下面的语句来实现此目的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11366.jpeg)

程序清单12.5　链表类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11367.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11368.jpeg)

名为position的变量包含对某个节点的引用。初始状态下，position包含的是与head实例变量相同的引用。因此，它会从指向第一个节点出发，在我们显示了这个节点的数据之后，position中的引用会通过下面的赋值语句从一个节点改为下一个节点：

![](../Images/image11369.gif)

这个过程如图12.5所示。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11370.jpeg)

图12.5　顺着链表移动

为了理解这种赋值会将position变量“移动”到下一个节点，我们需要注意，position包含的引用是图12.5中position箭头指向的节点，所以，position是这个节点的名字，position.link是这个节点的链接部分的名字。因此，position.link引用的是下一个节点。link变量的值是通过调用访问器方法getLink产生的，因此，对链表中下一个节点的引用是position.getLink（）。我们通过将position的值赋值为position.getLink（）的值，对其进行了“移动”。

上面的循环会持续地沿着列表移动position，并且随着不断地移动，将每个节点的数据都显示出来。当position到达最后一个节点时，它会显示这个节点的数据，并在此执行：

![](../Images/image11371.gif)

如果研究一下图12.5，就会发现position的值在此刻被设置成了null。当出现这种情况时，我们希望停止循环，因此我们在position不为null时才迭代该循环。

showList方法包含了我们刚刚讨论过的循环。length方法使用了类似的循环，但是它并未显示每个节点中的数据，length只是在该循环在节点间不断移动时对节点计数。顺便说一下，在链表中的节点之间移动的过程称为遍历该列表。showList和length都遍历了我们的列表。

接下来，让我们考虑addANodeToStart方法是如何将节点添加到链表开头的，使得新节点变成列表中的第一个节点。这项操作是通过下面这条语句实现的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11372.jpeg)

换句话说，变量head被设置为对新节点的引用，使得新节点成为了链表中的第一个节点。要想将这个节点与链表中其他的节点链接在一起，我们只需将新节点的实例变量link设置为原来的第一个节点即可。但是我们已经这么做了：由newListNode（addData，head）产生的新节点引用的就是原来的第一个节点，因为head在被赋值为对新节点的引用之前，包含的就是对原来的第一个节点的引用。因此，诸事皆顺。图12.6展示了这个过程。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11373.jpeg)

图12.6　在链表的开头添加一个节点

到目前为止，我们只是在链表的开头添加了节点。随后，我们将讨论在链表中其他位置上添加节点，但是最容易添加节点的位置还是在链表的开头，它也是最容易删除节点的位置。

deleteHeadNode会将第一个节点从链表中移除，让head变量引用链表中原来的第二个节点，即现在的第一个节点。我们留给你一个任务，去验证下面的语句可以正确地完成这种删除动作：

![](../Images/image11374.gif)

程序清单12.6包含了一个简单的程序，演示了我们刚刚讨论过的一些方法的行为。

程序清单12.6　链表演示程序

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11375.jpeg)

常见问题：被删除的节点怎么样了？

当我们的代码从链表中删除一个节点时，会移除链表对该节点的引用。就链表而言，该节点将不再存在于该链表中。但是我们没有给出任何命令去销毁该节点，因此，它必然还位于计算机内存中的某个位置上，如果没有任何其他对该节点的引用，那么它占据的内存应该可以用作其他目的。在许多编程语言中，程序员必须跟踪被删除的节点，并给出明确的命令返回它们的内存，从而回收作他用。这个过程称为垃圾回收。在Java中，这项任务会自动完成，或者按照更一般的说法，Java具有自动垃圾回收机制。

疑难杂症：NullPointerException

在运行程序时，你肯定在某个时刻收到过有关NullPointerException的消息。（如果你没有收到过这样的消息，那么恭喜！你是个异常仔细的程序员。）NullPointer Exception消息表示你的代码试图使用一个引用某个对象的类类型的引用，但是该变量包含的是null。即，该变量不包含对任何对象的引用。这条消息现在对你来说更具意义。在我们的节点中，我们使用null来表示不包含任何引用的link实例变量。因此，null值表示没有任何对象引用，这也就是为什么该异常被称为NullPointerException的原因。

NullPointerException是一种不需要在catch块中捕获、也不需要在throws子句中声明的异常，它表示我们需要修正代码。

牢记：大多数节点没有名字

变量head包含的是对链表中第一个节点的引用。因此，head可以用作第一个节点的名字。但是，在链表的其他任何包含对任意节点引用的节点中，没有任何节点是具名变量，因此，链表中其余节点都是没有名字的。唯一可以对某个节点命名的方式是通过间接的引用，就像head.getLink（），或者通过使用ListNode的另一个变量来命名，就像（程序清单12.5）showList方法中的局部变量position。

自测问题

18.如何标记链表的末尾？

19.假设变量head包含对链表中第一个节点的引用，并且该链表是空的。那么head的值应该是什么？

20.为StringLinkedList编写isEmpty方法，在列表为空时，即不包含任何节点时，返回true。

21.下面的代码会产生什么样的输出？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11376.jpeg)