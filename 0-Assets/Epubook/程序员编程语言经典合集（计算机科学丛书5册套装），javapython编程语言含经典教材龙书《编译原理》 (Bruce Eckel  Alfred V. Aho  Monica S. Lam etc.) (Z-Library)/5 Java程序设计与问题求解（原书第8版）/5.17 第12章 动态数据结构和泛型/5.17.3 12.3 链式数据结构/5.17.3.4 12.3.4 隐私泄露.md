   

### 12.3.4　隐私泄露

本节的观点很重要，但是有点微妙。如果先复习一下第6章的6.5节，将会对理解本节有所帮助。我们曾经说过，只要一个方法会返回对类类型的私有实例变量的引用，就会产生隐私问题。实例变量上的private限制可以很容易地被击破，只要它命名的对象上有set方法。获取对这种对象的引用就意味着允许程序员修改该对象的私有实例变量。

考虑一下（程序清单12.4中的）ListNode类的getLink方法，它会返回一个ListNode类型的值。即，它返回的是一个对某个ListNode对象（即某个节点）的引用。而且，ListNode具有公有的set方法，进而可以破坏该节点的内容。因此，getLink可能会导致隐私泄露。

另一方面，ListNode类的getData方法不会导致任何隐私泄露，但这只是因为String类没有任何set方法。String类是一个特例。如果数据是另一种类类型，getData仍有可能会产生隐私泄露。

如果ListNode类只会在StringLinkedList类或类似的类的定义内部使用，那么就不会有任何隐私泄露。这是因为StringLinkedList类中没有任何公有方法会返回对该节点的引用。尽管find方法的返回类型是ListNode，但是它却是一个私有方法。如果find方法是公有的，那么就会产生隐私泄露。因此，要注意到，让find方法私有不仅仅只是一个简单的风格问题。

尽管在像StringLinkedList这样的类定义中使用ListNode的类定义时不会有任何问题，但是我们并不能保证ListNode类只会以这种方式使用。我们可以有许多方式来修订这种隐私泄露问题，其中最直接的方式是让ListNode类成为StringLinkedList类中的私有内部类，就像12.3.5节和12.3.6节将要讨论的那样。另一种类似的解决方案是将ListNode和StringLinkedList类都放到同一个包中，然后像附录C所讨论的那样将实例变量的访问限制从私有修改为包，并删除访问器方法getLink。