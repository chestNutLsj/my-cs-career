   

### 12.4.1　基础知识

类和方法可以使用类型参数来代替具体的数据类型。泛型使得我们可以在使用类或方法时参数化数据类型，程序员可以将任意的类类型插入类型参数，以产生针对这种特定实例的具体的类类型或方法。例如，程序清单12.11展示了一个使用类型参数T的简单的类定义，请注意在类头中包围T的尖括号标记法。我们可以使用任何非关键字标识符来表示类型参数，并非一定要用T。但是，按照惯例，类型参数会以大写字母开头，并且使用单个字母来表示这些参数就像是约定俗成的传统。以大写字母开头是有意义的，因为只有类类型可以插入类型参数，而使用单个字母的传统并没有很令人信服的理由。

程序清单12.11　使用类型参数的类定义

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11404.jpeg)

在编写使用类型参数的类或方法时，我们几乎可以在任何可以使用类类型的地方使用这种参数。例如，程序清单12.11中的Sample类就将T用作了实例变量data和方法参数newValue的数据类型，以及getData方法的返回类型。但是，我们不能用类型参数来创建新对象。因此，尽管在Sample类中data是T类型的，但是我们不能编写下面的语句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11405.jpeg)

而且，我们不能在为数组分配内存时使用类型参数。尽管我们可以通过编写像下面这样的语句来声明数组：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11406.jpeg)

但是，我们不能编写

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11407.jpeg)

疑难杂症：不能在所有可以使用类型名的地方都使用类型参数

在参数化类定义的内部，有些地方可以放置类型名但是不能放置类型参数。我们不能在使用new创建新对象或为数组分配内存的简单表达式中使用类型参数。例如，下面在类型参数为T的参数化类定义中的表达式就是不合法的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11408.jpeg)

使用类型参数的类定义存储在文件中，并且会像其他任何类一样编译。例如，程序清单12.11中所示的参数化类就存储在名为Sample.java的文件中。

一旦参数化类被编译，它就可以像任何其他类一样使用，只是在将其用于我们的代码中时，必须指定用于替换类型参数的类类型。例如，程序清单12.11中的Sample类可以像下面这样使用：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11409.jpeg)

注意用于替换类型参数的实际类类型的尖括号标记法。Species类可以是在第5章中定义的类，但是这个细节并不重要，它也可以是任何我们自己定义的类。

你现在应该意识到了，我们在本章开头讨论过的ArrayList类就是一个参数化类。回忆一下，我们是通过编写像下面这样的语句来创建ArrayList实例的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11410.jpeg)

其中，String替换了该类定义中的类型参数。

回顾：具有类型参数的类定义

我们可以定义使用参数而不是实际类类型的类，可以在这样的类的头部中紧跟类名后面书写一个由一对尖括号括起来的类型参数。我们可以用任何非关键词的标识符来表示类型参数，但是按照惯例，类型参数会以大写字母开头。

我们在类定义中使用类型参数的方式与使用实际类类型的方式相同，只是无法将其与new一起使用。

示例

请查看程序清单12.11。

回顾：使用定义中具有类型参数的类

创建参数化类的对象的方式与创建任何其他类的对象的方式相同，只是我们在类名后面的尖括号中指定的是实际的类类型，而不是类型参数。

示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11411.jpeg)

疑难杂症：不能将基本类型插入类型参数

当创建具有类型参数的类的对象时，不能插入像int、double或char这样的基本类型。例如，下面的语句会导致语法错误：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11412.jpeg)

向类型参数插入的类型必须是类类型。

编程窍门：用-Xlint选项编译

在使用类型参数时，我们会碰到很多陷阱。如果用-Xlint选项编译，就会得到有关代码中任何问题或潜在问题的更具描述性的诊断信息。例如，程序清单12.11中的Sample类应该按如下方式编译：

![](../Images/image11413.gif)

如果使用集成开发环境（IDE）来编译程序，那么可以查看文档以了解如何设置编译器的选项。

当使用-Xlint选项编译时，我们会得到比不用该选项时更多的警告。警告并非错误，如果编译器只给出了警告，但是没有给出任何错误，那么这个类就可以编译，并且可以使用。但是，在大多数情况下，我们要确定自己理解这些警告，并且确信它们表示的确实不是问题，否则就应该修改代码以消除这些警告。