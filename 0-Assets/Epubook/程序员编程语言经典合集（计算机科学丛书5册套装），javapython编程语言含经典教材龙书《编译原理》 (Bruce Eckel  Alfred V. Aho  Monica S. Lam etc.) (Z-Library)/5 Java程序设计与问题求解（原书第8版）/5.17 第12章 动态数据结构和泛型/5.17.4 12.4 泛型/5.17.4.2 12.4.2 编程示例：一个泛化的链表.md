   

### 12.4.2　编程示例：一个泛化的链表

让我们来修订在程序清单12.7中的出现的链表类，让它使用类型参数E而不是String类型作为存储在链表中的数据的类型。程序清单12.12展示了修订的结果。

程序清单12.12　一个泛化的链表

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11414.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11415.jpeg)

注意，构造器的头部看起来就像是它出现在非参数化类中一样。它的构造器后面并不包含<E>，即尖括号中的类型参数。这对很多人来说有些违反直觉。尽管构造器像这个类中其他任何方法一样，可以在其构造器体中使用类型参数，但是它的头部并不包含该类型参数。

类似地，内部类ListNode在其头部中的类名后面也没有<E>，但是ListNode在其定义中确实使用了类型参数E。但是，这些都是正确的，因为ListNode是内部类，可以访问其外部类的类型参数。

程序清单12.7中的链表类有一个名为toArray的方法，如程序清单12.8所示，它会返回一个数组，其中包含了与链表相同的数据。但是，我们泛化版本的链表没有实现这个方法。如果转译程序清单12.8中的toArray方法，使得我们可以将其纳入程序清单12.12的泛化链表中，那么它可以像下面这样开头：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11416.jpeg)

正如注释所表示的，表达式new E[length（）]是不允许的。我们在某些情况下是不能包含类型参数的，遗憾的是，这里的情况就属于这些情况之一。因此，我们不能直接在泛化的链表中包含toArray方法。程序清单12.12定义了一个toArrayList方法，它会返回一个ArrayList类的实例。注意，它的定义包含了一个类似toArray中的循环。

程序清单12.13　使用泛化的链表类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11417.jpeg)

疑难杂症：泛化类中的构造器名字没有任何类型参数

参数化类定义中的类名后面会跟着类型参数，例如，程序清单12.12中的LinkedList<E>。这可能会误导你，让你认为需要在其构造器定义的头部使用该类型参数，但是情况并非如此。例如，你使用的是：

![](../Images/image11418.gif)

而不是

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11419.jpeg)

但是，我们可以在构造器定义的代码体内部使用像E这样的类型参数。

常见问题：类定义可以有多个类型参数吗？

可以，我们可以定义具有多个类型参数的类。要想这么做，需要在尖括号对中逐个书写类型参数，中间用逗号分隔。例如，Pair类可以像下面这样开头：

![](../Images/image11420.gif)

我们可以在Pair的定义中就像使用实际的数据类型一样地使用S和T。这个类使得我们可以创建具有不用数据类型的对象对。

牢记：内部类具有访问其外部类的类型参数的权限

内部类可以访问其外部类的类型参数。例如，在程序清单12.12中，内部类ListNode的定义使用了类型参数E，它是其外部类LinkedList的类型参数，尽管ListNode在其头部的名字后面没有<E>。

编程窍门：在内部类中定义类型参数

内部类可以定义其自己的类型参数，但是它们必须与外部类定义的所有类型能够区分开。例如，我们可以按照下面的方式定义程序清单12.12的外部类和内部类：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11421.jpeg)

需要注意的是，内部类ListNode前后一致地将T用作其类型参数，而外部类LinkedList具有其自己的类型参数E。当ListNode在外部类中用作数据类型时，写作ListNode<E>，而不是ListNode<T>。另外，要注意我们在这个例子中为ListNode设计了其自己的类型参数，这只是因为我们想要向你展示如果你希望这么做时，相应的语法是怎样的，除此之外，没有任何其他的原因。

自测问题

29.修订程序清单12.4中ListNode类的定义，让它使用类型参数而不是String类型。注意，这个类仍旧应该是public的。将这个类重命名为ListNode2。

30.在使用上一个自测问题的ListNode2类的定义时，如何才能创建一个名为node的存储了一个Integer类型值的ListNode2的对象？