   

### 5.1.11　基本类型参数

请考虑程序清单5.3中定义的SpeciesFirstTry类的getPopulationIn10方法，它会返回预期的未来10年后某个物种的数量。但是如果我们想预测未来5年或50年后的数据，会怎么样呢？如果可以预测未来任意年后的种群数量，那么该方法就会变得有用得多。为了实现这个目标，我们需要以某种方式在方法中为不同的年数值留下一个空位。在方法中起到这种空位作用的东西称为形式参数（formal parameter），或者简称参数。它们比简单的空位要复杂一些，但是如果将它们看作在方法调用时需要用某些值填入的空位或占位符，那么你对它们的理解就八九不离十了。

让我们用这种新的想法来修改SpeciesFirstTry类。程序清单5.6中定义的Spec-iesSecondTry包含一个名为predictPopulation的方法，它包含一个名为years的形式参数。当调用这个方法时，可以传递给它想要用来替换years参数的值。例如，如果将speciesOfTheMonth声明为SpeciesSecondTry类型，那么我们就可以使用方法predictPopulation像下面这样来计算12年后的种群数量：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10170.jpeg)

程序清单5.7中的程序与程序清单5.4中的程序很像，但是它使用了SpeciesSecondTry类及其predictPopulation方法。有了这个版本的类，我们就可以预测未来任意年后的种群数量了。我们甚至可以使用变量来表示年数，就像下面这样：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10171.jpeg)

让我们更仔细地观察predictPopulation方法的定义。如下所示，它的方法头有些新东西：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10172.jpeg)

years是形式参数，它表示在方法调用时传入的值，而传入的项称为引元，之前几章中已经多次使用过引元了。在有些其他的书中，引元也称为实际参数（actual parameter）或实参。例如，在下面的调用中，10这个值就是一个引元：

![](../Images/image10173.gif)

引元10会替换程序清单5.6中的predictPopulation方法定义中出现的所有形式参数years。之后，该方法调用会像之前看到过的所有方法调用一样继续执行。

注意，在这个替换过程中，只是用到了引元的值。如果方法调用中的引元是一个变量，那么用来替换的只是该变量的值，而不是该变量的名字。例如，考虑下面这种在某个使用SpeciesSecondTry类的程序中可能出现的情况：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10174.jpeg)

在本例中，是12这个值，而不是变量yearCount替换了predictPopulation方法定义中的形式参数years。因为只使用了引元的值，所以这种替换形式参数的方式称为“按值调用”机制。在Java中，这是用于像int、double和char这样的基本类型参数的唯一机制。正如最终会看到的，类类型的参数使用的是一种有些不同的替换机制，但是在目前，我们只关心基本类型的参数和引元。

这种参数替换的精确细节比我们到目前为止描述过的替换都要复杂一些。通常，你不需要关心这些精确的细节，但是偶尔，也有可能会需要知道这种替换机制是如何工作的。因此，这些精确的技术细节描述如下：出现在方法定义中的形式参数是局部变量，它们会被初始化为方法调用中给出的引元的值。例如，程序清单5.6中predictPopulation方法的years参数就是该方法的局部变量，int years就是它的声明。给定下面的方法调用：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10175.jpeg)

会将局部变量years设置为等于引元yearCount的值，其效果与以下面代码开头的方法定义相同：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10176.jpeg)

程序清单5.6　具有参数的方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10177.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10178.jpeg)

回顾：参数名局限于方法内部

在Java中，你可以任意选择方法的形式参数名，无须担心这个名字是否会与其他某个方法中的标识符相同。形式参数实际上是局部变量，因此它们的意义仅局限于它们各自的方法定义内部。

方法头中的形式参数的数据类型写在参数的前面。在本例中，参数years的数据类型是int。每个形式参数都有数据类型，而方法调用中用于替换该参数的引元必须匹配该参数的类型。因此，对于方法predictPopulation，调用该方法时在圆括号中给出的引元必须是int类型。

这条规则在实践中并非像我们刚刚所描述的那般严格。在许多情况下，如果在方法调用中使用的引元与形式参数的类型无法精确匹配，Java会执行自动类型转换，即强制类型转换。例如，如果方法调用中的引元的类型是int，而参数的类型是double，那么Java就会将int类型的值转换为对应的double类型的值。下面的列表展示了可以自动执行的类型转换。方法调用中具有这些类型的引元在需要匹配形式参数的类型时，会自动被转型为其右边的任何恰当的类型[^1]：

![](../Images/image10179.gif)

注意，这个列表与第2章所讨论的针对变量的自动类型强制转换是完全一样的。因此，我们可以将针对引元和变量的自动强制类型转换表示成一条规则：可以将所列类型中任意一种类型的值用于任何Java需要列表中更右侧类型的值的地方。

回顾：基本类型参数

在方法调用中，形式参数在方法头中给出，位于紧跟方法名后面的圆括号中。基本类型的形式参数（例如int、double和char类型的参数）都是局部变量。

当调用方法时，每个参数都会初始化为方法调用中对应的引元。这种类型的替换称为按值调用机制。方法调用中的引元可以是字面常量，例如2或'A'，也可以是变量，或者任何能够产生恰当类型值的表达式。

注意，如果将基本类型的变量用作方法调用中的引元，那么该方法调用是无法改变这个引元变量的值的。

到目前为止，我们对参数的讨论针对的都是有返回值的方法，但是，我们对形式参数和引元的讨论同样也可以适用于void方法：void方法可以有形式参数，对它们的处理方式与我们刚刚讨论过的对有返回值的方法的处理方式完全相同。

很可能也很常见的情形是一个方法定义中有多个形式参数。在这种情况下，每个形式参数都会在方法头中列出，并且每个参数前面都会写明其数据类型。例如，下面的代码就是某个方法定义的方法头：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10180.jpeg)

即使多个参数具有相同的类型，仍旧需要在每个参数前面写明类型名。

在方法调用中给出的引元数量必须与方法定义的方法头中形式参数的数量完全一样。例如，下面的代码是对我们假设的方法doStuff的调用：

![](../Images/image10181.gif)

正如这个示例所展示的，顺序和类型都要一致。这个方法调用中的第一个引元会替换方法定义的方法头中的第一个参数，这个方法调用中的第二个引元会替换方法定义的方法头中的第二个参数，以此类推。每个引元都必须与其对应的参数在数据类型上匹配，除非可以执行我们之前讨论的自动类型转换。

旁白：使用术语参数和引元  

我们对术语参数和引元的使用与常见的用法是一致的。我们用参数来描述方法头中的数据类型和变量的定义，用引元来描述调用方法时传递给它的项。但是，人们经常互换地使用这些术语。有些人使用术语参数来统称我们所谓的形式参数和引元，而有些人使用引元来统称它们。当你在其他书中看到术语参数或引元时，必须根据上下文理解其确切含义。  

提醒一下：类类型的参数与基本类型的参数在行为上不同。我们将在本章稍后讨论类类型的参数。

回顾：形式参数与引元之间的一致性

在方法定义内部，形式参数是在方法名后面的圆括号中给出的。在方法调用中，引元是在方法名后面的圆括号中给出的。引元必须与方法头中的形式参数在数量、顺序和数据类型上匹配。

引元会替换对应的形式参数。方法调用中的第一个引元会替换方法定义中的第一个参数，方法调用中的第二个引元会替换方法定义中的第二个参数，以此类推。引元应该与对应的形式参数具有相同的类型，尽管在某些情况下，Java会在它们的类型并非精确匹配时执行自动类型转换。

回顾：类定义

语法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10182.jpeg)

尽管这是我们最常使用的形式，但是也可以将方法定义和实例变量的定义混杂在一起。

回顾：方法头

语法

到目前为止我们看到过的方法头都具有下面的形式：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10183.jpeg)

Parameter_List是形式参数名的列表，每个前面都有一个数据类型。如果该列表包含多个项，那么这些项要由逗号分隔开。方法也可以根本不包含任何参数，在这种情况下，圆括号中没有任何东西。

示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image10184.jpeg)

完整的方法定义的语法详见5.1节的回顾。

自测问题

9.不做限定的术语“参数”和术语“形式参数”之间的差异是什么？

10.定义一个可以添加到程序清单5.6中SpeciesSecondTry类的定义中的名为getDensity的方法。该方法有一个名为area的double类型的参数，它给出了物种占据的区域面积，以平方英里[^2]为单位。getDensity方法会返回一个double类型的值，它等于每平方英里面积上生活的该物种个体的数量。（提示：这个定义非常短。）

11.定义一个可以添加到程序清单5.6中SpeciesSecondTry类的定义中的名为change-Population的方法。该方法有一个名为area的double类型的参数，它给出了物种占据的区域面积，以平方英里为单位。changePopulation方法会修改实例变量population的值，使得每平方英里上有两个该物种的个体。

12.定义一个可以添加到程序清单5.6中SpeciesSecondTry类的定义中的名为change-Population的方法。该方法有两个参数，其中一个名为area，类型为double，给出了物种占据的区域面积，以平方英里为单位；另一个名为numberPerMile，类型为int，给出了期望的每平方英里上该物种个体的数量。changePopulation方法会修改实例变量population的值，使得每平方英里上该物种的个体数量（近似）等于numberPerMile。

[^1]:  如果形式参数为int类型，或者任何在上述类型列表中int右边的类型，那么类型为char的引元也可以转型为匹配的数字类型。但是，我们不提倡使用这项特性。

[^2]:  1平方英里=2 589 988.110 336平方米。——编辑注