   

### 9.3.1　声明异常（传递责任）

有时，延迟对异常的处理是有意义的。例如，我们可能有一个方法，它的代码抛出了一个异常，但是我们可能并不想在这个方法中捕获该异常。也许有些使用该方法的程序应该在抛出异常时直接终止，而有些使用该方法的程序却应该执行其他的操作。因此，我们无法知晓如果在该方法内部捕获这个异常应该对它做些什么。在这些情况下，在该方法定义中捕获异常是没有意义的，应该让使用该方法的代码把对该方法的调用放到try块中，并且在跟在这个try块后面的catch块中捕获异常。

如果一个方法没有捕获异常，那么它至少应该警告程序员任何对该方法的调用都可能会抛出一个异常。这种警告称为throws子句。例如，可能会抛出DivideByZeroException异常但是又没有捕获它的方法，那么应该具有像下面这样的方法头：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11002.jpeg)

其中，throws DivideByZeroException部分就是throws子句，它表示对sampleMethod的调用可能会抛出一个DivideByZeroException异常。

在调用方法时可能会抛出的大多数异常必须以下面两种方式之一来处理：

·在方法定义内部的某个catch块中捕获可能发生的异常。

·通过在方法头中编写throws子句来声明可能发生的异常，并且让使用该方法的代码去操心如何处理异常。

在任何方法中，我们都可以混合使用这两种可选的方式：捕获某些异常，以及在throws子句中声明其他的异常。

我们已经了解了如何在catch块中处理异常，而第二种方式也称为“传递责任”。例如，假设methodA像下面这样带有throws子句：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11003.jpeg)

在这种情况下，methodA就不再承担捕获在其执行过程中可能会抛出的DivideByZero-Exception类型异常的责任了。但是，如果methodB包含了对methodA的调用，那么methodB就必须处理该异常。当methodA添加了throws子句后，它会向methodB声明：“如果你调用我，你必须自己操心我可能会抛出的DivideByZeroException异常。”实际上，methodA把处理DivideByZeroException类型异常的责任从其自身传递给了调用它的方法（“传递责任”）。

当然，如果methodA通过在其方法头中包含throws子句将责任传递给了methodB，那么methodB也可以在其定义中包含同样的throws子句，将责任传递给调用它的其他方法。但是，在编写良好的程序中，每个被抛出的异常最终都应该被某个不会将责任继续传递下去的方法中的catch块捕获。

一条throws子句可以包含多个异常类型。在这种情况下，异常类型之间用逗号分隔，就像下面这样：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11004.jpeg)

如果派生类覆盖了基类中具有throws子句的方法，那么我们就不能在新的覆盖方法的throws子句中添加新的异常类型。

牢记：抛出异常会终止方法

如果一个方法抛出了异常，并且该异常没有在该方法内部捕获，那么该方法调用就会在抛出异常后立即终止。

因此，如果这个方法需要抛出在基类被覆盖的方法的throws子句中没有列出的异常，那么该覆盖方法就必须在try-catch块中处理这个异常。但是，我们可以在覆盖方法的throws子句中声明更少的异常。

程序清单9.7展示了程序清单9.6中的程序的修订版，使得正常情况在名为doNormal-Case的方法中。这个方法可以抛出DivideByZeroException异常，但是并没有捕获它。因此，我们需要在该方法定义头部的throws子句中声明这个可能会抛出的异常。如果我们以这种方式来设计程序，那么诸事顺利的情况就会完全被隔离出来，代码也会变得更易阅读。但是，当main方法调用doNormalCase方法时，必须在一个try块中调用。

程序清单9.7　使用throws子句传递责任

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11005.jpeg)

回顾：throws子句

如果我们定义的方法可能会抛出属于某种特定类的异常，那么正常情况下，要么我们必须在该方法定义的某个catch块中捕获它，要么需要在该方法头中通过编写throws子句来声明该异常类。

语法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11006.jpeg)

示例

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11007.jpeg)

牢记：throw与throws

关键词throw用来抛出异常，而throws用于在方法头中声明异常。因此，throw语句会抛出异常，而throws子句是在声明异常。