   

### 11.1.3　无限递归

考虑上一节中定义的displayAsWords方法。假设我们因疏忽大意将其定义成了下面的样子：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11235.jpeg)

实际上，在注意到被忽略的情况之前，我们几乎就是按照这种方式定义的。但是，假设我们没有注意到被忽略的情况，并且使用了这个更短的定义。我们快速跟踪递归调用display-AsWords（987）的计算过程。

方法调用displayAsWords（987）会产生下面的递归调用：

![](../Images/image11236.gif)

它等价于displayAsWords（98），而displayAsWords（98）这个调用会产生下面的递归调用：

![](../Images/image11237.gif)

它等价于displayAsWords（9）。因为这个不正确的displayAsWords版本没有任何处理一位数字的特殊情况，所以displayAsWords（9）这个调用会产生下面的递归调用：

![](../Images/image11238.gif)

它等价于displayAsWords（0），而displayAsWords（0）这个调用会产生下面的递归调用：

![](../Images/image11239.gif)

它等价于displayAsWords（0）。

现在，问题很明显了。displayAsWords（0）这个调用会产生另一个displayAsWords（0）调用，后者又会产生另一个displayAsWords（0）调用，以此类推，无穷无尽，或者直至计算机资源耗尽。这种情况称为无限递归。

注意，我们说前面的displayAsWords定义不正确只是表示它执行了错误的计算。它并非不合法。Java编译器可以接受这个displayAsWords的定义，以及任何类似的不包含能够停止一系列递归调用的基础情况的递归方法定义。但是，除非我们的递归定义可以确保能够到达某种基础情况，否则就会得到一个无限的递归调用链，从而导致程序要么永远运行下去，要么异常地终止。

对于递归方法定义而言，为了正确地工作并且不会产生无限的递归调用链，必须有一种或多种情况（即基础情况）对于某些引元值可以在不产生任何递归调用的情况下终止。程序清单11.2给出了displayAsWords的正确定义，它有一种基础情况，即下面突出显示的代码：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11240.jpeg)

疑难杂症：栈溢出

当某个方法调用导致无限递归时，程序很可能就会发出一条提示“栈溢出”的错误消息并终止。栈这个术语指的是一种用来跟踪递归调用以及其他东西的数据结构。

系统在计算机内存中为每个递归调用都维护了一条记录。可以将这些记录想象成一页页的纸，系统将这些纸一页页地“堆叠”在一起形成了栈。当这个栈变得太大以致难以放入可用的内存中时，就会产生栈溢出。

自测问题

1.下面的代码会产生什么样的输出？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11241.jpeg)

2.下面的代码会产生什么样的输出？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11242.jpeg)

3.编写下面方法的递归定义：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11243.jpeg)

如果在编写这个方法时碰到了问题，可以简化它，输出不必前进到下一行。对于这种更简单的情况，就无须担心print和println之间的差异了。在这种更简单的情况中，可以只用print。在实现了这种简单情况之后，再尝试按照要求来完成这个练习。