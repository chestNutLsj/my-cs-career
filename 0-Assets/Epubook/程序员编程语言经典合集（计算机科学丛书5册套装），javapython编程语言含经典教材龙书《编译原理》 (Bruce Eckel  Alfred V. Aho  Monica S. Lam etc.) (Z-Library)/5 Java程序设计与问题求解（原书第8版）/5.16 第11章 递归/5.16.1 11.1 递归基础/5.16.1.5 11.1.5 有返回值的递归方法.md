   

### 11.1.5　有返回值的递归方法

递归方法可以是void方法，就像你前面看到的那样，也可以是有返回值的方法。设计有返回值的递归方法的方式在本质上与设计void递归方法的方式是相同的，即遵循11.1.2节中“递归成功的关键”框中所列的规则。通过添加一点内容，我们就可以厘清第二条规则，使它兼顾具有返回值的情况。

有一个或多个分支应该包含能够导致产生返回值的对该方法的递归调用。这些递归调用在某种意义上必须使用“更小的”引元或解决该方法所执行的任务的“更小的”版本。

程序清单11.4中定义的递归方法getNumberOfZeros会返回一个值，它返回的是当作引元给出的整数中0的数量。例如，getNumberOfZeros（2030）会返回2，因为2030中有两个数字位是0。我们来看看这个方法是如何工作的。

程序清单11.4　有返回值的递归方法

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11245.jpeg)

这个方法的定义用到了下面几项简单的事实：  

·如果n只有一位，那么n为0时n中0的数量就是1，n不为0时n中0的数量就是0。

·如果n包含两位或更多的位，设d是其最后一位，m是从n中移除最后一位之后剩下的整数。如果d为0，那么n中0的数量就是m中0的数量加1。

例如，20030中0的数量就是2003中0的数量加1，因为最后一位是0。20035中0的数量是2003中0的数量不加上任何东西，因为最后一位不是0。记住这个定义，我们来审视一下使用getNumberOfZeros的简单计算。

首先，考虑下面这个简单的表达式：

![](../Images/image11246.gif)

它可能会出现在某条赋值语句的右侧。当调用该方法时，将参数n的值设置为0，并且执行方法定义体中的代码。因为n的值等于0，所以符合多重if-else语句的第一种情况，返回值为1。

接下来，考虑另一个简单表达式：

![](../Images/image11247.gif)

当调用该方法时，将参数n的值设置为5，并且执行方法定义体中的代码。因为n的值不等于0，所以不符合多重if-else语句的第一种情况。但是，n的值小于10，所以符合多重if-else语句的第二种情况，返回值为0。正如你所见，这两种简单情况都可以正确地工作。

现在，我们来看一个包含递归调用的示例。考虑下面的表达式：

![](../Images/image11248.gif)

当调用该方法时，将参数n的值设置为50，并且执行方法定义体中的代码。因为n的值不等于0且不小于10，所以不符合多重if-else语句的前两个分支的情况。50%10为0，所以符合第三个分支的情况。因此，返回值为：

![](../Images/image11249.gif)

在本例中它等价于：

![](../Images/image11250.gif)

而上面这个调用又等价于：

![](../Images/image11251.gif)

我们之前看到过getNumberOfZeros（5）会返回0，因此getNumberOfZeros（50）的返回值就是0+1，即1，它确实是正确的值。

更大的数字将产生更长的递归调用链。例如，考虑下面的表达式：

![](../Images/image11252.gif)

这个表达式的值是按照如下方式计算的：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11253.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11254.jpeg)

注意，当Java到达基础情况getNumberOfZeros（2）时，有三项计算被挂起了。在计算完基础情况的返回值后，最近被挂起的计算会恢复，产生getNumberOfZeros（20）的值。此后，依次恢复和完成其他被挂起的计算。每个计算出来的值都会在另一个被挂起的计算中用到，直至最初的调用getNumberOfZeros（2008）的计算完成。被挂起的计算是按照与它们挂起的顺序相反的顺序完成的。最终返回的值为2，这是正确的，因为2008中确实有两个0。

牢记：不要混淆递归和重载

不要混淆递归和重载。当重载方法名时，是给两个不同方法赋予相同的名字。如果这两个方法中有一个方法的定义包含对另一个方法的调用，这并不是递归。在递归方法定义中，方法的定义包含对完全相同的方法的调用，这些方法具有完全相同的定义，包括相同的参数数量和类型。

自测问题

4.下面的代码会产生什么样的输出？

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11255.jpeg)

5.完成下面方法的定义。你的定义应该是递归的。

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11256.jpeg)

6.完成下面方法的定义。你的定义应该是递归的。与自测问题5中的方法不同，这个方法不应该对其引元的符号和值进行限制。可以使用自测问题5中用到的相同技术，但是应该有一种新的递归情况，用于处理负指数。（提示：对于取值为负的n，10n就是1/10-n。还有，如果n是负数，那么-n就是正数。）

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11257.jpeg)