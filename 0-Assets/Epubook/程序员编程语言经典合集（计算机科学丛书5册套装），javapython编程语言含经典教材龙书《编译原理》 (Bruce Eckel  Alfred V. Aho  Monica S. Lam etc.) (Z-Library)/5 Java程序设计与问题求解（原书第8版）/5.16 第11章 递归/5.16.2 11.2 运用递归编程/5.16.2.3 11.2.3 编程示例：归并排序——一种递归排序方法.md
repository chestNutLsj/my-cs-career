   

### 11.2.3　编程示例：归并排序——一种递归排序方法

在最高效的排序算法中，有些最易于描述成递归算法。用于对数组排序的归并排序算法就是这样的算法之一。在这个示例中，我们会呈现一个实现了归并排序算法的方法，它可以将int值构成的数组从小到大进行排序。只需稍加修改，我们就可以获得一个能够对由任何可排序类型的项构成的数组进行排序的方法，其中有些修改将在自测问题中讨论。

归并排序是分而治之算法的一个例子。待排序的数组会先分成两半，然后用递归调用对这两半分别排序。这个过程会产生两个较小的排好序的数组，然后它们会合并，形成包含这两个较小数组中所有元素的单个排好序的数组。该算法的概要形式表示如下：

对数组a排序的归并排序算法

1.如果数组a只有一个元素，不需要做任何事（基础情况）。否则，执行下面的操作（递归调用）。

2.将数组a中前一半元素复制到更小的名为firstHalf的数组中。

3.将数组a中剩余元素复制到另一个更小的名为lastHalf的数组中。

4.用递归调用对数组firstHalf排序。

5.用递归调用对数组lastHalf排序。

6.将数组firstHalf和lastHalf中的元素合并到数组a中。

这个算法的大部分细节在用Java代码实现时都会显得很直观。但是，对于两个数组firstHalf和lastHalf合并成单个排好序的数组，还需要多做一些解释。

归并排序的基本思想如下：数组firstHalf和lastHalf都是按照从小到大排好序的。因此，数组firstHalf中最小的元素是firstHalf[0]，数组lastHalf中最小的元素是lastHalf[0]。于是，两个数组的所有元素中最小的元素就是firstHalf[0]和lastHalf[0]中较小的元素。将这个最小的元素移入a[0]。

例如，假设最小的元素是lastHalf[0]，我们将其移入a[0]。剩下要移入a的元素中最小的元素是firstHalf[0]和lastHalf[1]中较小的元素，将该元素移入a[1]中，继续执行这个过程。

归并过程的Java代码看起来像下面这样：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11272.jpeg)

![](../Images/image11273.gif)

现在，我们考虑一下while循环的条件是什么。注意，这个循环只有在firstHalf和lastHalf中都包含需要移入a的元素时才有意义。因此，与其循环直至数组a填满，不如循环直至数组firstHalf和lastHalf之一的全部元素都移入a。因此，while循环的条件可以是：

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11274.jpeg)

当这个while循环结束时，数组firstHalf和lastHalf之一的全部元素都移入了数组a，而另一个可能还包含一些需要移入a的元素。这些元素都是排好序的，并且都比已经移入a的元素大。因此，我们需要做的就是将数组firstHalf或lastHalf中剩余的元素移入数组a。

程序清单11.8给出了归并排序算法的Java实现，包括merge方法。程序清单11.9包含了一个使用程序清单11.8中的MergeSort类的演示程序。

程序清单11.8　MergeSort类

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11275.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11276.jpeg)

程序清单11.9　MergeSort类的演示

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11277.jpeg)

![](0-Assets/Epubook/程序员编程语言经典合集（计算机科学丛书5册套装），javapython编程语言含经典教材龙书《编译原理》%20(Bruce%20Eckel%20%20Alfred%20V.%20Aho%20%20Monica%20S.%20Lam%20etc.)%20(Z-Library)/images/image11278.jpeg)

归并排序算法比第7章阐述的选择排序算法要高效得多。实际上，没有任何排序算法在数量级上比归并排序算法更高效。“数量级”的含义超出了本书的范围，但是我们可以稍微解释一下。

在现实中，有许多算法比归并排序算法更高效。但是，对于非常大的数组而言，这些算法中的任何一个（包括归并排序算法）都比选择排序算法快很多，使得它们关于选择排序所产生的性能提升，远比这些更快的算法之间的性能差异要明显得多。

自测问题

11.使用MergeSort类时，哪条语句将会对下面的数组排序？

![](../Images/image11279.gif)

12.怎样修改MergeSort类，使得它可以对double类型而不是int类型的数组中的值排序？

13.怎样修改MergeSort类，使得它可以对int类型的数组中的值按照降序而不是升序排序？

14.如果基类型为int的数组中一个值出现了两次，例如，b[0]和b[5]都是7，并且你使用了MergeSort.sort方法对该数组进行排序，那么在该数组排序后，这个重复值会存在一个副本还是两个副本？