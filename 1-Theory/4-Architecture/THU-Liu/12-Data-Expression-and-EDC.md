## 数据表示

### 数据表示
需要在计算机中表示的对象：
- 程序、整数、浮点数、字符（串）、逻辑值

通过编码表示，表示方式
- 用数字电路的两个状态表示，存放在机器字中
- 由上一层的抽象计算机来识别不同的内容

编码原则
- 少量简单的基本符号
- 一定的规则
- 表示大量复杂的信息
- 计算性能与存储空间要均衡

编码表示：
- 基本元素：0、1 两个基本符号
- 字符表示


数值型数据表示
- 定点数
	- 无符号整数 0，1，…，2^(n-1)
	- 有符号整数
	- 定点小数
- 浮点数
- 逻辑值 0->false, 1->true 
	- 与运算
	- 或运算
	- 非运算
	- 异或运算
- 颜色（RGB）
- 位置/地址/指令：n 位只能代表 2^n 个不同的对象


### 字符表示
- 字符：26 字符-> $\lceil \log_{2}26\rceil=5$ 位
	- 大/小写+其它符号 -> 7bits -> ASCII 码
	- 世界上其它语言的文字 -> 16 bits（Unicode）
	- UTF-8：变长字符编码，字符长度由首字节确定
		- ![[12-Data-Expression-and-EDC-utf8.png]]
		- 首字节外，均以“10”开始，可自同步
		- 可扩展性强
		- 成为互联网上占统治地位的字符集
	- 点阵字体：点阵本质是单色位图，如果为 0，对应位置没有点，为 1 则显示点
		- 文字编码->查找字体文件->找到点阵->显示
	- 矢量字体：
		- ![[12-Data-Expression-and-EDC-truetype.png]]
		- 一个字可以用多条曲线来表示，每条曲线保存其关键点
		- 显示字的时候，取出这些关键点，采用平滑的曲线将这些关键点连接起来，并填充闭合空间以显示
		- 需要放大或者缩小的时候，按照比例改变关键点的相对位置即可
		- 不会失真

### 整数与浮点数

- 数值范围：指一种类型的数据所能表示的最大值和最小值
- 数据精度：指实数所能给出的有效数字位数；对浮点数来说，精度不够会造成误差，误差大量积累会出问题
- 机内处理：数值范围和数据精度概念不同。在计算机中，它们的值与用多少个二进制位表示某种类型的数据，以及怎么对这些位进行编码有关

#### 整数
- 原码，反码，补码
	- 正数的原码、反码、补码表示均相同，符号位为 0，数值位同数的真值。
	- 零的原码和反码均有 2 个编码，补码只 1 个码
	- 负数的原码、反码、补码表示均不同
		- 符号位为 1，数值位：原码为数的绝对值
		- 反码为除符号位外，每一位均取反
		- 补码为反码再在最低位+1
		- 只有一个负数的原码与补码是相同的：1100 0000 0000 0000 0000 0000 0000 0000
			- ![[12-Data-Expression-and-EDC-question.png]]
	- 由 `[X]补` 求 `[-X]补`：每一位取反后再在最低位+1
- 符号扩展
- 大端，小端
- 加法，减法，乘法，除法


#### 浮点数
图片来源：[^1]
$$
V=(-1)^{s}\times M\times 2^{E}
$$
- s: 符号位
- M: 尾数，二进制小数，范围为 1~2-ε 或 0~1-ε
- E: 解码，对浮点数进行加权，权重是 2^E

![[12-Data-Expression-and-EDC-ieee754.png]]
- 符号位单独编码；
- 阶码字段 $exp=e_{k-1}...e_{1}e_{0}$，k 位（在单精度中 8 位，双精度中 11 位）
- 小数字段 $frac=f_{n-1}...f_{1}f_{0}$，n 位（单精度 23 位，双精度 52 位）

![[12-Data-Expression-and-EDC-normalized-ieee754.png]]
- 规格化：阶码不全为 0 或 1
	- 阶码被解释为以偏置形式表示的有符号整数：E=e-Bias, 
	- e 是无符号数，其位表示为 $e_{k-1}...e_{1}e_{0}$
	- Bias 是 $2^{k-1}-1$，对单精度就是 $2^{8-1}-1=127$，对双精度是 $2^{11-1}-1=1023$ 
	- 综上，对规格化数，单精度的指数范围为 -126~+127, 双精度的指数范围 -1022~+1023
	- frac 字段为小数 $frac=0.f_{n-1}...f_{1}f_{0}$，而尾数 M=1+f，表达一个 $1.f_{n-1}f_{n-2}...f_{1}f_{0}$ 的二进制小数，即尾数总是处于 $0\le M<2$ 之间，那么小数点前的 1 可以忽略。
- 非规格化：阶码全 0
	- 此时阶码值为 E=1-Bias
	- 尾数为 M=frac，不包含开头的 1
	- 用途：表示数值 0（除符号位外全 0 表示 0），同样有+0.0 和-0.0 之分
	- 另外可以表示非常接近于 0.0 的数
- 特殊值：阶码全 1:
	- 尾数全 0 —— 无穷大
	- 尾数非 0 —— NaN

![[12-Data-Expression-and-EDC-6bit-ieee754.png]]
- 6bit 的位中，3 个阶码，2 个尾数：$S_{5}E_{4}E_{3}E_{2}M_{1}M_{0}$
- 则非规格化数的尾数部分为 0.11，0.10，0.01，0.00，用以表示 0 或极小值
- 阶码的取值范围为 `[0,1,2,3,4,5,6,7] - Bias = [0..7] - (2^(3-1) -1) = [-3,-2,-1,0,1,2,3,4]`，其中-3 的表示是 000——非规格化，4 的表示是 111——特殊值

![[12-Data-Expression-and-EDC-ieee-range.png]]

## 检错纠错

[^1]: [Fetching Title#8faa](https://waynerv.com/posts/csapp-ieee-floating-intro/)